<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="Core API 基础" href="api_basics.html" /><link rel="prev" title="连接池" href="pooling.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.08.06 -->
        <title>核心事件 - SQLAlchemy 2.1 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/changelog.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_paramlinks.css" />
    <link rel="stylesheet" type="text/css" href="../_static/docs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SQLAlchemy 2.1 Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">SQLAlchemy 2.1 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">概述</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/index.html">SQLAlchemy 统一教程</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of SQLAlchemy 统一教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/engine.html">建立连接 - Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/dbapi_transactions.html">使用事务和DBAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/metadata.html">使用数据库元数据</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/data.html">处理数据</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 处理数据</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/data_insert.html">使用 INSERT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/data_select.html">使用 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/data_update.html">使用 UPDATE 和 DELETE 语句</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/orm_data_manipulation.html">使用 ORM 进行数据操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/orm_related_objects.html">使用 ORM 相关对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/further_reading.html">进一步阅读</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../orm/index.html">SQLAlchemy ORM</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of SQLAlchemy ORM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../orm/quickstart.html">ORM 快速入门</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/mapper_config.html">ORM 映射类配置</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of ORM 映射类配置</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapping_styles.html">ORM 映射类概述</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../orm/declarative_mapping.html">使用声明式映射类</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of 使用声明式映射类</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_styles.html">声明式映射风格</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_tables.html">声明式的表配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_config.html">使用声明式映射器配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_mixins.html">使用 Mixins 组合映射层次结构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../orm/dataclasses.html">与dataclass和attrs的集成</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapped_sql_expr.html">SQL 表达式作为映射属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapped_attributes.html">更改Attribute的行为</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/composites.html">复合列类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/inheritance.html">映射类继承层次结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/nonstandard_mappings.html">非传统映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/versioning.html">配置版本计数器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapping_api.html">类映射 API</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../orm/scalar_mapping.html">映射 SQL 表达式</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 映射 SQL 表达式</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../orm/mapping_columns.html">映射表格列</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/relationships.html">关系配置</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of 关系配置</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/basic_relationships.html">基本关系模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/self_referential.html">邻接表关系</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/join_conditions.html">配置关系连接方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/large_collections.html">使用大型集合</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/collection_api.html">集合自定义和 API 详细信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/relationship_persistence.html">特殊关系的持久化模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/backref.html">使用旧版“backref”关系参数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/relationship_api.html">关系 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/queryguide/index.html">ORM 查询指南</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of ORM 查询指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/select.html">为 ORM 映射类编写 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/inheritance.html">为继承映射编写 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/dml.html">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/columns.html">列加载选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/relationships.html">关系加载技术</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/api.html">用于查询的 ORM API 功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/query.html">旧式查询 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/session.html">使用会话</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 使用会话</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_basics.html">会话基础知识</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_state_management.html">状态管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/cascades.html">级联</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_transaction.html">事务和连接管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/persistence_techniques.html">附加持久性技术</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/contextual.html">上下文/线程本地会话</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_events.html">使用事件跟踪查询、对象和会话更改</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_api.html">会话 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/extending.html">事件和内部</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 事件和内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/events.html">ORM 事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/internals.html">ORM 内部</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/exceptions.html">ORM 异常</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/extensions/index.html">ORM 扩展</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of ORM 扩展</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/asyncio.html">异步 I/O (asyncio)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/associationproxy.html">关联代理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/automap.html">自动映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/baked.html">烘焙查询</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/declarative/index.html">声明式扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/mutable.html">突变追踪</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/orderinglist.html">排序列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/horizontal_shard.html">水平分片</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/hybrid.html">混合属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/indexable.html">Indexable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/instrumentation.html">替代类检测</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../orm/examples.html">核心和 ORM 示例</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">SQLAlchemy Core</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of SQLAlchemy Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="expression_api.html">SQL 语句和表达式 API</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of SQL 语句和表达式 API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="sqlelement.html">列元素和表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="operators.html">操作符参考</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectable.html">SELECT 和相关构造</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html">插入,更新,删除</a></li>
<li class="toctree-l3"><a class="reference internal" href="functions.html">SQL 和 范型函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiler.html">自定义 SQL 构造和编译扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="serializer.html">表达式序列化器扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="foundation.html">SQL 表达式语言基础构造</a></li>
<li class="toctree-l3"><a class="reference internal" href="visitors.html">访问者和遍历实用程序</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="schema.html">Schema 定义语言</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Schema 定义语言</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="metadata.html">使用元数据描述数据库</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflection.html">反映数据库对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="defaults.html">列 INSERT/UPDATE 默认值</a></li>
<li class="toctree-l3"><a class="reference internal" href="constraints.html">定义约束和索引</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl.html">自定义 DDL</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="types.html">SQL 数据类型对象</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of SQL 数据类型对象</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="type_basics.html">类型层次结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom_types.html">自定义类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="type_api.html">基本类型 API</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="engines_connections.html">Engine和Connection的使用</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Engine和Connection的使用</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="engines.html">Engine 配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="connections.html">使用Engines和Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="pooling.html">连接池</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">核心事件</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api_basics.html">Core API 基础</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Core API 基础</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="event.html">事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="inspection.html">运行时审查 API</a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptions.html">Core 异常</a></li>
<li class="toctree-l3"><a class="reference internal" href="internals.html">Core 内部</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dialects/index.html">Dialects</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Dialects</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dialects/postgresql.html">PostgreSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/mysql.html">MySQL 和 MariaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/sqlite.html">SQLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/oracle.html">Oracle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/mssql.html">Microsoft SQL Server</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../faq/index.html">常见问题</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of 常见问题</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/installation.html">安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/connections.html">连接 / 引擎</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/metadata_schema.html">元数据 / Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/sqlexpressions.html">SQL 表达式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/ormconfiguration.html">ORM 配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/performance.html">性能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/sessions.html">会话 / 查询</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/thirdparty.html">第三方包集成问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../errors.html">错误消息</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../changelog/index.html">变更和迁移</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of 变更和迁移</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_21.html">SQLAlchemy 2.1 有什么新功能？</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_21.html">2.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_20.html">2.0 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_14.html">1.4 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_13.html">1.3 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_12.html">1.2 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_11.html">1.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_10.html">1.0 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_09.html">0.9 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_08.html">0.8 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_07.html">0.7 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_06.html">0.6 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_05.html">0.5 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_04.html">0.4 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_03.html">0.3 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_02.html">0.2 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_01.html">0.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_20.html">SQLAlchemy 2.0 - Major Migration Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/whatsnew_20.html">What’s New in SQLAlchemy 2.0?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_14.html">What’s New in SQLAlchemy 1.4?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_13.html">What’s New in SQLAlchemy 1.3?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_12.html">What’s New in SQLAlchemy 1.2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_11.html">What’s New in SQLAlchemy 1.1?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_10.html">What’s New in SQLAlchemy 1.0?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_09.html">What’s New in SQLAlchemy 0.9?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_08.html">What’s New in SQLAlchemy 0.8?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_07.html">What’s New in SQLAlchemy 0.7?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_06.html">What’s New in SQLAlchemy 0.6?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_05.html">What’s new in SQLAlchemy 0.5?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_04.html">What’s new in SQLAlchemy 0.4?</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="core-event-toplevel">
<span id="id1"></span><h1>核心事件<a class="headerlink" href="#core-event-toplevel" title="Link to this heading">¶</a></h1>
<p>Core Events</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>本节描述了SQLAlchemy Core中提供的事件接口。有关事件监听API的介绍，请参见 <a class="reference internal" href="event.html#event-toplevel"><span class="std std-ref">事件</span></a> 。ORM事件在 <a class="reference internal" href="../orm/events.html#orm-event-toplevel"><span class="std std-ref">ORM 事件</span></a> 中描述。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>This section describes the event interfaces provided in
SQLAlchemy Core.
For an introduction to the event listening API, see <a class="reference internal" href="event.html#event-toplevel"><span class="std std-ref">事件</span></a>.
ORM events are described in <a class="reference internal" href="../orm/events.html#orm-event-toplevel"><span class="std std-ref">ORM 事件</span></a>.</p>
</div>
</div>
<div class="table-wrapper longtable docutils container">
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.event.base.Events"><span class="sig-name descname">Events</span></a></p></td>
<td><p>Define event listening functions for a particular target type.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.event.base.Events">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.event.base.</span></span><span class="sig-name descname"><span class="pre">Events</span></span><a class="headerlink" href="#sqlalchemy.event.base.Events" title="Link to this definition">¶</a></dt>
<dd><p>Define event listening functions for a particular target type.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.event.base.Events.dispatch"><span class="sig-name descname">dispatch</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.Events</span></code> (<code class="docutils literal notranslate"><span class="pre">sqlalchemy.event._HasEventsDispatch</span></code>)</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.event.base.Events.dispatch">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.event.base.Events"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.event.base.Events.</span></code></a><span class="sig-name descname"><span class="pre">dispatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_Dispatch</span><span class="p"><span class="pre">[</span></span><span class="pre">_ET</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;sqlalchemy.event.base.EventsDispatch</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#sqlalchemy.event.base.Events.dispatch" title="Link to this definition">¶</a></dt>
<dd><p>reference back to the _Dispatch class.</p>
<p>Bidirectional against _Dispatch._events</p>
</dd></dl>

</dd></dl>

<section id="id2">
<h2>连接池事件<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>Connection Pool Events</p>
<div class="table-wrapper longtable docutils container">
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><span class="sig-name descname">PoolEvents</span></a></p></td>
<td><p>Available events for <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.events.PoolResetState"><span class="sig-name descname">PoolResetState</span></a></p></td>
<td><p>describes the state of a DBAPI connection as it is being passed to
the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> connection pool event.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.events.</span></span><span class="sig-name descname"><span class="pre">PoolEvents</span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents" title="Link to this definition">¶</a></dt>
<dd><p>Available events for <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>.</p>
<p>The methods here define the name of an event as well
as the names of members that are passed to listener
functions.</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="k">def</span><span class="w"> </span><span class="nf">my_on_checkout</span><span class="p">(</span><span class="n">dbapi_conn</span><span class="p">,</span> <span class="n">connection_rec</span><span class="p">,</span> <span class="n">connection_proxy</span><span class="p">):</span>
    <span class="s2">&quot;handle an on checkout event&quot;</span>


<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">Pool</span><span class="p">,</span> <span class="s2">&quot;checkout&quot;</span><span class="p">,</span> <span class="n">my_on_checkout</span><span class="p">)</span></pre></div>
</div>
<p>In addition to accepting the <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> class and
<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> instances, <a class="reference internal" href="#sqlalchemy.events.PoolEvents" title="sqlalchemy.events.PoolEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolEvents</span></code></a> also accepts
<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> objects and the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> class as
targets, which will be resolved to the <code class="docutils literal notranslate"><span class="pre">.pool</span></code> attribute of the
given engine or the <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://scott:tiger@localhost/test&quot;</span><span class="p">)</span>

<span class="c1"># will associate with engine.pool</span>
<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;checkout&quot;</span><span class="p">,</span> <span class="n">my_on_checkout</span><span class="p">)</span></pre></div>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkin"><span class="sig-name descname">checkin()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout"><span class="sig-name descname">checkout()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.close"><span class="sig-name descname">close()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.close_detached"><span class="sig-name descname">close_detached()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.connect"><span class="sig-name descname">connect()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.detach"><span class="sig-name descname">detach()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.dispatch"><span class="sig-name descname">dispatch</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.first_connect"><span class="sig-name descname">first_connect()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.invalidate"><span class="sig-name descname">invalidate()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset"><span class="sig-name descname">reset()</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.soft_invalidate"><span class="sig-name descname">soft_invalidate()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.events.PoolEvents" title="sqlalchemy.events.PoolEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents</span></code></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.Events</span></code>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.checkin">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">checkin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.checkin" title="Link to this definition">¶</a></dt>
<dd><p>Called when a connection returns to the pool.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;checkin&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_checkin</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;checkin&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>Note that the connection may be closed, and may be None if the
connection has been invalidated.  <code class="docutils literal notranslate"><span class="pre">checkin</span></code> will not be called
for detached connections.  (They do not return to the pool.)</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.checkin.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkin.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.checkin.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkin.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.checkout">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">checkout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_proxy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><span class="pre">PoolProxiedConnection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.checkout" title="Link to this definition">¶</a></dt>
<dd><p>Called when a connection is retrieved from the Pool.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;checkout&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_checkout</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">connection_proxy</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;checkout&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.checkout.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkout.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.checkout.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkout.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.checkout.params.connection_proxy"></span><strong>connection_proxy</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.checkout.params.connection_proxy">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> object
which will proxy the public interface of the DBAPI connection for the
lifespan of the checkout.</p></li>
</ul>
</dd>
</dl>
<p>If you raise a <a class="reference internal" href="exceptions.html#sqlalchemy.exc.DisconnectionError" title="sqlalchemy.exc.DisconnectionError"><code class="xref py py-class docutils literal notranslate"><span class="pre">DisconnectionError</span></code></a>, the current
connection will be disposed and a fresh connection retrieved.
Processing of all checkout listeners will abort and restart
using the new connection.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect()</span></code></a>
- a similar event
which occurs upon creation of a new <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.close">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.close" title="Link to this definition">¶</a></dt>
<dd><p>Called when a DBAPI connection is closed.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_close</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;close&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>The event is emitted before the close occurs.</p>
<p>The close of a connection can fail; typically this is because
the connection is already closed.  If the close operation fails,
the connection is discarded.</p>
<p>The <a class="reference internal" href="#sqlalchemy.events.PoolEvents.close" title="sqlalchemy.events.PoolEvents.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> event corresponds to a connection that’s still
associated with the pool. To intercept close events for detached
connections use <a class="reference internal" href="#sqlalchemy.events.PoolEvents.close_detached" title="sqlalchemy.events.PoolEvents.close_detached"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close_detached()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.close.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.close.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.close.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.close.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.close_detached">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">close_detached</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.close_detached" title="Link to this definition">¶</a></dt>
<dd><p>Called when a detached DBAPI connection is closed.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;close_detached&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_close_detached</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;close_detached&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>The event is emitted before the close occurs.</p>
<p>The close of a connection can fail; typically this is because
the connection is already closed.  If the close operation fails,
the connection is discarded.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.PoolEvents.close_detached.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.close_detached.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.connect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.connect" title="Link to this definition">¶</a></dt>
<dd><p>Called at the moment a particular DBAPI connection is first
created for a given <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;connect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_connect</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;connect&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event allows one to capture the point directly after which
the DBAPI module-level <code class="docutils literal notranslate"><span class="pre">.connect()</span></code> method has been used in order
to produce a new DBAPI connection.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.connect.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.connect.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.connect.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.connect.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.detach">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.detach" title="Link to this definition">¶</a></dt>
<dd><p>Called when a DBAPI connection is “detached” from a pool.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;detach&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_detach</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;detach&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is emitted after the detach occurs.  The connection
is no longer associated with the given connection record.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.detach.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.detach.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.detach.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.detach.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.dispatch">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">dispatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_Dispatch</span><span class="p"><span class="pre">[</span></span><span class="pre">_ET</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;sqlalchemy.event.base.PoolEventsDispatch</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#sqlalchemy.events.PoolEvents.dispatch" title="Link to this definition">¶</a></dt>
<dd><p>reference back to the _Dispatch class.</p>
<p>Bidirectional against _Dispatch._events</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.first_connect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">first_connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.first_connect" title="Link to this definition">¶</a></dt>
<dd><p>Called exactly once for the first time a DBAPI connection is
checked out from a particular <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;first_connect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_first_connect</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;first_connect&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>The rationale for <a class="reference internal" href="#sqlalchemy.events.PoolEvents.first_connect" title="sqlalchemy.events.PoolEvents.first_connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.first_connect()</span></code></a>
is to determine
information about a particular series of database connections based
on the settings used for all connections.  Since a particular
<a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>
refers to a single “creator” function (which in terms
of a <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
refers to the URL and connection options used),
it is typically valid to make observations about a single connection
that can be safely assumed to be valid about all subsequent
connections, such as the database version, the server and client
encoding settings, collation settings, and many others.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.first_connect.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.first_connect.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.first_connect.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.first_connect.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.invalidate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">invalidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.invalidate" title="Link to this definition">¶</a></dt>
<dd><p>Called when a DBAPI connection is to be “invalidated”.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;invalidate&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_invalidate</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;invalidate&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is called any time the
<a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.invalidate" title="sqlalchemy.pool.ConnectionPoolEntry.invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionPoolEntry.invalidate()</span></code></a> method is invoked, either from
API usage or via “auto-invalidation”, without the <code class="docutils literal notranslate"><span class="pre">soft</span></code> flag.</p>
<p>The event occurs before a final attempt to call <code class="docutils literal notranslate"><span class="pre">.close()</span></code> on the
connection occurs.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.invalidate.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.invalidate.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.invalidate.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.invalidate.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.invalidate.params.exception"></span><strong>exception</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.invalidate.params.exception">¶</a> – the exception object corresponding to the reason
for this invalidation, if any.  May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="pooling.html#pool-connection-invalidation"><span class="std std-ref">更多关于失效的信息</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.reset">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.PoolResetState" title="sqlalchemy.events.PoolResetState"><span class="pre">PoolResetState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.reset" title="Link to this definition">¶</a></dt>
<dd><p>Called before the “reset” action occurs for a pooled connection.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_reset</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">reset_state</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;reset&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># DEPRECATED calling style (pre-2.0, will be removed in a future release)</span>
<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;reset&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_reset</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;reset&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0 版本发生变更: </span>The <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event now accepts the 
arguments <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.dbapi_connection" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">PoolEvents.reset.dbapi_connection</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.connection_record" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">PoolEvents.reset.connection_record</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.reset_state" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">PoolEvents.reset.reset_state</span></code></a>.
Support for listener functions which accept the previous 
argument signature(s) listed above as “deprecated” will be 
removed in a future release.</p>
</div>
<p>This event represents
when the <code class="docutils literal notranslate"><span class="pre">rollback()</span></code> method is called on the DBAPI connection
before it is returned to the pool or discarded.
A custom “reset” strategy may be implemented using this event hook,
which may also be combined with disabling the default “reset”
behavior using the <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool.params.reset_on_return" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.reset_on_return</span></code></a> parameter.</p>
<p>The primary difference between the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> and
<a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkin" title="sqlalchemy.events.PoolEvents.checkin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkin()</span></code></a> events are that
<a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> is called not just for pooled
connections that are being returned to the pool, but also for
connections that were detached using the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.detach" title="sqlalchemy.engine.Connection.detach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.detach()</span></code></a> method as well as asyncio connections
that are being discarded due to garbage collection taking place on
connections before the connection was checked in.</p>
<p>Note that the event <strong>is not</strong> invoked for connections that were
invalidated using <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.invalidate" title="sqlalchemy.engine.Connection.invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.invalidate()</span></code></a>.    These
events may be intercepted using the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.soft_invalidate" title="sqlalchemy.events.PoolEvents.soft_invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.soft_invalidate()</span></code></a>
and <a class="reference internal" href="#sqlalchemy.events.PoolEvents.invalidate" title="sqlalchemy.events.PoolEvents.invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.invalidate()</span></code></a> event hooks, and all “connection
close” events may be intercepted using <a class="reference internal" href="#sqlalchemy.events.PoolEvents.close" title="sqlalchemy.events.PoolEvents.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.close()</span></code></a>.</p>
<p>The <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event is usually followed by the
<a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkin" title="sqlalchemy.events.PoolEvents.checkin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkin()</span></code></a> event, except in those
cases where the connection is discarded immediately after reset.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.reset.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.reset.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.reset.params.reset_state"></span><strong>reset_state</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.reset.params.reset_state">¶</a> – <p><a class="reference internal" href="#sqlalchemy.events.PoolResetState" title="sqlalchemy.events.PoolResetState"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolResetState</span></code></a> instance which provides
information about the circumstances under which the connection
is being reset.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入.</span></p>
</div>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="pooling.html#pool-reset-on-return"><span class="std std-ref">返回时重置</span></a></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback" title="sqlalchemy.events.ConnectionEvents.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.rollback()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.commit" title="sqlalchemy.events.ConnectionEvents.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.commit()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolEvents.soft_invalidate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolEvents.</span></code></a><span class="sig-name descname"><span class="pre">soft_invalidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbapi_connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_record</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.PoolEvents.soft_invalidate" title="Link to this definition">¶</a></dt>
<dd><p>Called when a DBAPI connection is to be “soft invalidated”.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngineOrPool</span><span class="p">,</span> <span class="s1">&#39;soft_invalidate&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_soft_invalidate</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;soft_invalidate&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is called any time the
<a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.invalidate" title="sqlalchemy.pool.ConnectionPoolEntry.invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionPoolEntry.invalidate()</span></code></a>
method is invoked with the <code class="docutils literal notranslate"><span class="pre">soft</span></code> flag.</p>
<p>Soft invalidation refers to when the connection record that tracks
this connection will force a reconnect after the current connection
is checked in.   It does not actively close the dbapi_connection
at the point at which it is called.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.soft_invalidate.params.dbapi_connection"></span><strong>dbapi_connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.soft_invalidate.params.dbapi_connection">¶</a> – a DBAPI connection.
The <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a> attribute.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.soft_invalidate.params.connection_record"></span><strong>connection_record</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.soft_invalidate.params.connection_record">¶</a> – the <a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> managing
the DBAPI connection.</p></li>
<li><p><span class="target" id="sqlalchemy.events.PoolEvents.soft_invalidate.params.exception"></span><strong>exception</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.PoolEvents.soft_invalidate.params.exception">¶</a> – the exception object corresponding to the reason
for this invalidation, if any.  May be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolResetState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.events.</span></span><span class="sig-name descname"><span class="pre">PoolResetState</span></span><a class="headerlink" href="#sqlalchemy.events.PoolResetState" title="Link to this definition">¶</a></dt>
<dd><p>describes the state of a DBAPI connection as it is being passed to
the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> connection pool event.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.events.PoolResetState.asyncio_safe"><span class="sig-name descname">asyncio_safe</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolResetState.terminate_only"><span class="sig-name descname">terminate_only</span></a>, <a class="reference internal" href="#sqlalchemy.events.PoolResetState.transaction_was_reset"><span class="sig-name descname">transaction_was_reset</span></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0.0b3 版本加入.</span></p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolResetState.asyncio_safe">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolResetState"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolResetState.</span></code></a><span class="sig-name descname"><span class="pre">asyncio_safe</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sqlalchemy.events.PoolResetState.asyncio_safe" title="Link to this definition">¶</a></dt>
<dd><p>Indicates if the reset operation is occurring within a scope where
an enclosing event loop is expected to be present for asyncio applications.</p>
<p>Will be False in the case that the connection is being garbage collected.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolResetState.terminate_only">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolResetState"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolResetState.</span></code></a><span class="sig-name descname"><span class="pre">terminate_only</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sqlalchemy.events.PoolResetState.terminate_only" title="Link to this definition">¶</a></dt>
<dd><p>indicates if the connection is to be immediately terminated and
not checked in to the pool.</p>
<p>This occurs for connections that were invalidated, as well as asyncio
connections that were not cleanly handled by the calling code that
are instead being garbage collected.   In the latter case,
operations can’t be safely run on asyncio connections within garbage
collection as there is not necessarily an event loop present.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.PoolResetState.transaction_was_reset">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.PoolResetState"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.PoolResetState.</span></code></a><span class="sig-name descname"><span class="pre">transaction_was_reset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#sqlalchemy.events.PoolResetState.transaction_was_reset" title="Link to this definition">¶</a></dt>
<dd><p>Indicates if the transaction on the DBAPI connection was already
essentially “reset” back by the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object.</p>
<p>This boolean is True if the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> had transactional
state present upon it, which was then not closed using the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.rollback" title="sqlalchemy.engine.Connection.rollback"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.rollback()</span></code></a> or <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.commit" title="sqlalchemy.engine.Connection.commit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.commit()</span></code></a> method;
instead, the transaction was closed inline within the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.close" title="sqlalchemy.engine.Connection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.close()</span></code></a> method so is guaranteed to remain non-present
when this event is reached.</p>
</dd></dl>

</dd></dl>

</section>
<section id="sql">
<span id="core-sql-events"></span><h2>SQL 执行和连接事件<a class="headerlink" href="#sql" title="Link to this heading">¶</a></h2>
<p>SQL Execution and Connection Events</p>
<div class="table-wrapper longtable docutils container">
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><span class="sig-name descname">ConnectionEvents</span></a></p></td>
<td><p>Available events for
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> and <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><span class="sig-name descname">DialectEvents</span></a></p></td>
<td><p>event interface for execution-replacement functions.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.events.</span></span><span class="sig-name descname"><span class="pre">ConnectionEvents</span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents" title="Link to this definition">¶</a></dt>
<dd><p>Available events for
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> and <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>.</p>
<p>The methods here define the name of an event as well as the names of
members that are passed to listener functions.</p>
<p>An event listener can be associated with any
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> or <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
class or instance, such as an <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span><span class="p">,</span> <span class="n">create_engine</span>


<span class="k">def</span><span class="w"> </span><span class="nf">before_cursor_execute</span><span class="p">(</span>
    <span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span>
<span class="p">):</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Received statement: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">statement</span><span class="p">)</span>


<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://scott:tiger@localhost/test&quot;</span><span class="p">)</span>
<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">,</span> <span class="n">before_cursor_execute</span><span class="p">)</span></pre></div>
</div>
<p>or with a specific <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">begin</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>

    <span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">before_cursor_execute</span><span class="p">(</span>
        <span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span>
    <span class="p">):</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Received statement: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">statement</span><span class="p">)</span></pre></div>
</div>
<p>When the methods are called with a <cite>statement</cite> parameter, such as in
<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">after_cursor_execute()</span></code></a> or <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_cursor_execute()</span></code></a>,
the statement is the exact SQL string that was prepared for transmission
to the DBAPI <code class="docutils literal notranslate"><span class="pre">cursor</span></code> in the connection’s <a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code></a>.</p>
<p>The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_execute()</span></code></a> and <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_cursor_execute()</span></code></a>
events can also be established with the <code class="docutils literal notranslate"><span class="pre">retval=True</span></code> flag, which
allows modification of the statement and parameters to be sent
to the database.  The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_cursor_execute()</span></code></a> event is
particularly useful here to add ad-hoc string transformations, such
as comments, to all executions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.engine</span><span class="w"> </span><span class="kn">import</span> <span class="n">Engine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">comment_sql_calls</span><span class="p">(</span>
    <span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span>
<span class="p">):</span>
    <span class="n">statement</span> <span class="o">=</span> <span class="n">statement</span> <span class="o">+</span> <span class="s2">&quot; -- some comment&quot;</span>
    <span class="k">return</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionEvents</span></code></a> can be established on any
combination of <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>, <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>,
as well
as instances of each of those classes.  Events across all
four scopes will fire off for a given instance of
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>.  However, for performance reasons, the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object determines at instantiation time
whether or not its parent <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> has event listeners
established.   Event listeners added to the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
class or to an instance of <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
<em>after</em> the instantiation
of a dependent <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> instance will usually
<em>not</em> be available on that <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> instance.
The newly
added listeners will instead take effect for
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>
instances created subsequent to those event listeners being
established on the parent <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> class or instance.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.ConnectionEvents.params.retval"></span><strong>retval=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.params.retval">¶</a> – Applies to the <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_execute()</span></code></a> and
<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_cursor_execute()</span></code></a> events only.  When True, the
user-defined event function must have a return value, which
is a tuple of parameters that replace the given statement
and parameters.  See those methods for a description of
specific return arguments.</p>
</dd>
</dl>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute"><span class="sig-name descname">after_cursor_execute()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute"><span class="sig-name descname">after_execute()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute"><span class="sig-name descname">before_cursor_execute()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute"><span class="sig-name descname">before_execute()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.begin"><span class="sig-name descname">begin()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.begin_twophase"><span class="sig-name descname">begin_twophase()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.commit"><span class="sig-name descname">commit()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase"><span class="sig-name descname">commit_twophase()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.dispatch"><span class="sig-name descname">dispatch</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect"><span class="sig-name descname">engine_connect()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_disposed"><span class="sig-name descname">engine_disposed()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase"><span class="sig-name descname">prepare_twophase()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint"><span class="sig-name descname">release_savepoint()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback"><span class="sig-name descname">rollback()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint"><span class="sig-name descname">rollback_savepoint()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase"><span class="sig-name descname">rollback_twophase()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.savepoint"><span class="sig-name descname">savepoint()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options"><span class="sig-name descname">set_connection_execution_options()</span></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options"><span class="sig-name descname">set_engine_execution_options()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents</span></code></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.Events</span></code>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">after_cursor_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPICursor" title="sqlalchemy.engine.interfaces.DBAPICursor"><span class="pre">DBAPICursor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_DBAPIAnyExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><span class="pre">ExecutionContext</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executemany</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="Link to this definition">¶</a></dt>
<dd><p>Intercept low-level cursor execute() events after execution.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;after_cursor_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_after_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;after_cursor_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.cursor"></span><strong>cursor</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.cursor">¶</a> – DBAPI cursor object.  Will have results pending
if the statement was a SELECT, but these should not be consumed
as they will be needed by the <a class="reference internal" href="connections.html#sqlalchemy.engine.CursorResult" title="sqlalchemy.engine.CursorResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CursorResult</span></code></a>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.statement"></span><strong>statement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.statement">¶</a> – string SQL statement, as passed to the DBAPI</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.parameters"></span><strong>parameters</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.parameters">¶</a> – Dictionary, tuple, or list of parameters being
passed to the <code class="docutils literal notranslate"><span class="pre">execute()</span></code> or <code class="docutils literal notranslate"><span class="pre">executemany()</span></code> method of the
DBAPI <code class="docutils literal notranslate"><span class="pre">cursor</span></code>.  In some cases may be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.context">¶</a> – <a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecutionContext</span></code></a> object in use.  May
be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.executemany"></span><strong>executemany</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute.params.executemany">¶</a> – boolean, if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is an <code class="docutils literal notranslate"><span class="pre">executemany()</span></code>
call, if <code class="docutils literal notranslate"><span class="pre">False</span></code>, this is an <code class="docutils literal notranslate"><span class="pre">execute()</span></code> call.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.after_execute">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">after_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauseelement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Executable" title="sqlalchemy.sql.expression.Executable"><span class="pre">Executable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_CoreMultiExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_CoreSingleExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execution_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ExecuteOptions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Result" title="sqlalchemy.engine.Result"><span class="pre">Result</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Unpack</span><span class="p"><span class="pre">[</span></span><span class="pre">TupleAny</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.after_execute" title="Link to this definition">¶</a></dt>
<dd><p>Intercept high level execute() events after execute.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;after_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_after_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">execution_options</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;after_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># DEPRECATED calling style (pre-1.4, will be removed in a future release)</span>
<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;after_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_after_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;after_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 1.4 版本发生变更: </span>The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute()</span></code></a> event now accepts the 
arguments <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.conn" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute.conn</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.clauseelement" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute.clauseelement</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.multiparams" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute.multiparams</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.params" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute.params</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.execution_options" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute.execution_options</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.result" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute.result</span></code></a>.
Support for listener functions which accept the previous 
argument signature(s) listed above as “deprecated” will be 
removed in a future release.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.clauseelement"></span><strong>clauseelement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.clauseelement">¶</a> – SQL expression construct, <a class="reference internal" href="internals.html#sqlalchemy.engine.Compiled" title="sqlalchemy.engine.Compiled"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compiled</span></code></a>
instance, or string statement passed to
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execute" title="sqlalchemy.engine.Connection.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execute()</span></code></a>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.multiparams"></span><strong>multiparams</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.multiparams">¶</a> – Multiple parameter sets, a list of dictionaries.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.params"></span><strong>params</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.params">¶</a> – Single parameter set, a single dictionary.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.execution_options"></span><strong>execution_options</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.execution_options">¶</a> – <p>dictionary of execution
options passed along with the statement, if any.  This is a merge
of all options that will be used, including those of the statement,
the connection, and those passed in to the method itself for
the 2.0 style of execution.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入.</span></p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.after_execute.params.result"></span><strong>result</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute.params.result">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.CursorResult" title="sqlalchemy.engine.CursorResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CursorResult</span></code></a> generated by the
execution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">before_cursor_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPICursor" title="sqlalchemy.engine.interfaces.DBAPICursor"><span class="pre">DBAPICursor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_DBAPIAnyExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><span class="pre">ExecutionContext</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executemany</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Tuple" title="sqlalchemy.sql.expression.Tuple"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_DBAPIAnyExecuteParams</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="Link to this definition">¶</a></dt>
<dd><p>Intercept low-level cursor execute() events before execution,
receiving the string SQL statement and DBAPI-specific parameter list to
be invoked against a cursor.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;before_cursor_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_before_cursor_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;before_cursor_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is a good choice for logging as well as late modifications
to the SQL string.  It’s less ideal for parameter modifications except
for those which are specific to a target backend.</p>
<p>This event can be optionally established with the <code class="docutils literal notranslate"><span class="pre">retval=True</span></code>
flag.  The <code class="docutils literal notranslate"><span class="pre">statement</span></code> and <code class="docutils literal notranslate"><span class="pre">parameters</span></code> arguments should be
returned as a two-tuple in this case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;before_cursor_execute&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">before_cursor_execute</span><span class="p">(</span>
    <span class="n">conn</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">executemany</span>
<span class="p">):</span>
    <span class="c1"># do something with statement, parameters</span>
    <span class="k">return</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span></pre></div>
</div>
<p>See the example at <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionEvents</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.cursor"></span><strong>cursor</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.cursor">¶</a> – DBAPI cursor object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.statement"></span><strong>statement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.statement">¶</a> – string SQL statement, as to be passed to the DBAPI</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.parameters"></span><strong>parameters</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.parameters">¶</a> – Dictionary, tuple, or list of parameters being
passed to the <code class="docutils literal notranslate"><span class="pre">execute()</span></code> or <code class="docutils literal notranslate"><span class="pre">executemany()</span></code> method of the
DBAPI <code class="docutils literal notranslate"><span class="pre">cursor</span></code>.  In some cases may be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.context">¶</a> – <a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecutionContext</span></code></a> object in use.  May
be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.executemany"></span><strong>executemany</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute.params.executemany">¶</a> – boolean, if <code class="docutils literal notranslate"><span class="pre">True</span></code>, this is an <code class="docutils literal notranslate"><span class="pre">executemany()</span></code>
call, if <code class="docutils literal notranslate"><span class="pre">False</span></code>, this is an <code class="docutils literal notranslate"><span class="pre">execute()</span></code> call.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_execute()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">after_cursor_execute()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.before_execute">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">before_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">clauseelement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Executable" title="sqlalchemy.sql.expression.Executable"><span class="pre">Executable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_CoreMultiExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_CoreSingleExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">execution_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ExecuteOptions</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Tuple" title="sqlalchemy.sql.expression.Tuple"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="selectable.html#sqlalchemy.sql.expression.Executable" title="sqlalchemy.sql.expression.Executable"><span class="pre">Executable</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_CoreMultiExecuteParams</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_CoreSingleExecuteParams</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="Link to this definition">¶</a></dt>
<dd><p>Intercept high level execute() events, receiving uncompiled
SQL constructs and other objects prior to rendering into SQL.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;before_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_before_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">execution_options</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;before_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># DEPRECATED calling style (pre-1.4, will be removed in a future release)</span>
<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;before_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_before_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;before_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 1.4 版本发生变更: </span>The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute()</span></code></a> event now accepts the 
arguments <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.conn" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute.conn</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.clauseelement" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute.clauseelement</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.multiparams" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute.multiparams</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.params" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute.params</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.execution_options" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute.execution_options</span></code></a>.
Support for listener functions which accept the previous 
argument signature(s) listed above as “deprecated” will be 
removed in a future release.</p>
</div>
<p>This event is good for debugging SQL compilation issues as well
as early manipulation of the parameters being sent to the database,
as the parameter lists will be in a consistent format here.</p>
<p>This event can be optionally established with the <code class="docutils literal notranslate"><span class="pre">retval=True</span></code>
flag.  The <code class="docutils literal notranslate"><span class="pre">clauseelement</span></code>, <code class="docutils literal notranslate"><span class="pre">multiparams</span></code>, and <code class="docutils literal notranslate"><span class="pre">params</span></code>
arguments should be returned as a three-tuple in this case:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;before_execute&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">before_execute</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
    <span class="c1"># do something with clauseelement, multiparams, params</span>
    <span class="k">return</span> <span class="n">clauseelement</span><span class="p">,</span> <span class="n">multiparams</span><span class="p">,</span> <span class="n">params</span></pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.clauseelement"></span><strong>clauseelement</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.clauseelement">¶</a> – SQL expression construct, <a class="reference internal" href="internals.html#sqlalchemy.engine.Compiled" title="sqlalchemy.engine.Compiled"><code class="xref py py-class docutils literal notranslate"><span class="pre">Compiled</span></code></a>
instance, or string statement passed to
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execute" title="sqlalchemy.engine.Connection.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execute()</span></code></a>.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.multiparams"></span><strong>multiparams</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.multiparams">¶</a> – Multiple parameter sets, a list of dictionaries.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.params"></span><strong>params</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.params">¶</a> – Single parameter set, a single dictionary.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.before_execute.params.execution_options"></span><strong>execution_options</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute.params.execution_options">¶</a> – <p>dictionary of execution
options passed along with the statement, if any.  This is a merge
of all options that will be used, including those of the statement,
the connection, and those passed in to the method itself for
the 2.0 style of execution.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入.</span></p>
</div>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">before_cursor_execute()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.begin">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.begin" title="Link to this definition">¶</a></dt>
<dd><p>Intercept begin() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;begin&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_begin</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;begin&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.ConnectionEvents.begin.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.begin.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.begin_twophase">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">begin_twophase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.begin_twophase" title="Link to this definition">¶</a></dt>
<dd><p>Intercept begin_twophase() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;begin_twophase&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_begin_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;begin_twophase&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.begin_twophase.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.begin_twophase.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.begin_twophase.params.xid"></span><strong>xid</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.begin_twophase.params.xid">¶</a> – two-phase XID identifier</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.commit">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">commit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.commit" title="Link to this definition">¶</a></dt>
<dd><p>Intercept commit() events, as initiated by a
<a class="reference internal" href="connections.html#sqlalchemy.engine.Transaction" title="sqlalchemy.engine.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;commit&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_commit</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;commit&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>Note that the <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> may also “auto-commit”
a DBAPI connection upon checkin, if the <code class="docutils literal notranslate"><span class="pre">reset_on_return</span></code>
flag is set to the value <code class="docutils literal notranslate"><span class="pre">'commit'</span></code>.  To intercept this
commit, use the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> hook.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.ConnectionEvents.commit.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.commit_twophase">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">commit_twophase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_prepared</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.commit_twophase" title="Link to this definition">¶</a></dt>
<dd><p>Intercept commit_twophase() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;commit_twophase&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_commit_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">,</span> <span class="n">is_prepared</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;commit_twophase&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.commit_twophase.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.commit_twophase.params.xid"></span><strong>xid</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase.params.xid">¶</a> – two-phase XID identifier</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.commit_twophase.params.is_prepared"></span><strong>is_prepared</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase.params.is_prepared">¶</a> – boolean, indicates if
<a class="reference internal" href="connections.html#sqlalchemy.engine.TwoPhaseTransaction.prepare" title="sqlalchemy.engine.TwoPhaseTransaction.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TwoPhaseTransaction.prepare()</span></code></a> was called.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.dispatch">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">dispatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_Dispatch</span><span class="p"><span class="pre">[</span></span><span class="pre">_ET</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;sqlalchemy.event.base.ConnectionEventsDispatch</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.dispatch" title="Link to this definition">¶</a></dt>
<dd><p>reference back to the _Dispatch class.</p>
<p>Bidirectional against _Dispatch._events</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.engine_connect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">engine_connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="Link to this definition">¶</a></dt>
<dd><p>Intercept the creation of a new <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;engine_connect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_engine_connect</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;engine_connect&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span>

<span class="c1"># DEPRECATED calling style (pre-2.0, will be removed in a future release)</span>
<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;engine_connect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_engine_connect</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">branch</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;engine_connect&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0 版本发生变更: </span>The <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect()</span></code></a> event now accepts the 
arguments <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect.params.conn" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect.conn</span></code></a>.
Support for listener functions which accept the previous 
argument signature(s) listed above as “deprecated” will be 
removed in a future release.</p>
</div>
<p>This event is called typically as the direct result of calling
the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.connect" title="sqlalchemy.engine.Engine.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.connect()</span></code></a> method.</p>
<p>It differs from the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.connect" title="sqlalchemy.events.PoolEvents.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.connect()</span></code></a> method, which
refers to the actual connection to a database at the DBAPI level;
a DBAPI connection may be pooled and reused for many operations.
In contrast, this event refers only to the production of a higher level
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> wrapper around such a DBAPI connection.</p>
<p>It also differs from the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a> event
in that it is specific to the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object,
not the
DBAPI connection that <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a> deals with,
although
this DBAPI connection is available here via the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.connection" title="sqlalchemy.engine.Connection.connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Connection.connection</span></code></a> attribute.
But note there can in fact
be multiple <a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a>
events within the lifespan
of a single <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object, if that
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>
is invalidated and re-established.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.ConnectionEvents.engine_connect.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a>
the lower-level pool checkout event
for an individual DBAPI connection</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.engine_disposed">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">engine_disposed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.base.Engine"><span class="pre">Engine</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.engine_disposed" title="Link to this definition">¶</a></dt>
<dd><p>Intercept when the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.dispose()</span></code></a> method is called.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;engine_disposed&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_engine_disposed</span><span class="p">(</span><span class="n">engine</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;engine_disposed&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>The <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.dispose()</span></code></a> method instructs the engine to
“dispose” of it’s connection pool (e.g. <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>), and
replaces it with a new one.  Disposing of the old pool has the
effect that existing checked-in connections are closed.  The new
pool does not establish any new connections until it is first used.</p>
<p>This event can be used to indicate that resources related to the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> should also be cleaned up,
keeping in mind that the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
can still be used for new requests in which case
it re-acquires connection resources.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.prepare_twophase">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">prepare_twophase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase" title="Link to this definition">¶</a></dt>
<dd><p>Intercept prepare_twophase() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;prepare_twophase&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_prepare_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;prepare_twophase&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.prepare_twophase.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.prepare_twophase.params.xid"></span><strong>xid</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase.params.xid">¶</a> – two-phase XID identifier</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.release_savepoint">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">release_savepoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.release_savepoint" title="Link to this definition">¶</a></dt>
<dd><p>Intercept release_savepoint() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;release_savepoint&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_release_savepoint</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;release_savepoint&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.release_savepoint.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.release_savepoint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint.params.name">¶</a> – specified name used for the savepoint.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.release_savepoint.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint.params.context">¶</a> – not used</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.rollback">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">rollback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.rollback" title="Link to this definition">¶</a></dt>
<dd><p>Intercept rollback() events, as initiated by a
<a class="reference internal" href="connections.html#sqlalchemy.engine.Transaction" title="sqlalchemy.engine.Transaction"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transaction</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;rollback&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_rollback</span><span class="p">(</span><span class="n">conn</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;rollback&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>Note that the <a class="reference internal" href="pooling.html#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> also “auto-rolls back”
a DBAPI connection upon checkin, if the <code class="docutils literal notranslate"><span class="pre">reset_on_return</span></code>
flag is set to its default value of <code class="docutils literal notranslate"><span class="pre">'rollback'</span></code>.
To intercept this
rollback, use the <a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> hook.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">rollback_savepoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint" title="Link to this definition">¶</a></dt>
<dd><p>Intercept rollback_savepoint() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;rollback_savepoint&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_rollback_savepoint</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;rollback_savepoint&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.name">¶</a> – specified name used for the savepoint.</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint.params.context">¶</a> – not used</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.rollback_twophase">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">rollback_twophase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">xid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_prepared</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase" title="Link to this definition">¶</a></dt>
<dd><p>Intercept rollback_twophase() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;rollback_twophase&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_rollback_twophase</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">xid</span><span class="p">,</span> <span class="n">is_prepared</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;rollback_twophase&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_twophase.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_twophase.params.xid"></span><strong>xid</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase.params.xid">¶</a> – two-phase XID identifier</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.rollback_twophase.params.is_prepared"></span><strong>is_prepared</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase.params.is_prepared">¶</a> – boolean, indicates if
<a class="reference internal" href="connections.html#sqlalchemy.engine.TwoPhaseTransaction.prepare" title="sqlalchemy.engine.TwoPhaseTransaction.prepare"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TwoPhaseTransaction.prepare()</span></code></a> was called.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.savepoint">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">savepoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.savepoint" title="Link to this definition">¶</a></dt>
<dd><p>Intercept savepoint() events.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;savepoint&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_savepoint</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;savepoint&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.savepoint.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.savepoint.params.conn">¶</a> – <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.savepoint.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.savepoint.params.name">¶</a> – specified name used for the savepoint.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.set_connection_execution_options">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">set_connection_execution_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.base.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options" title="Link to this definition">¶</a></dt>
<dd><p>Intercept when the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code></a>
method is called.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;set_connection_execution_options&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_set_connection_execution_options</span><span class="p">(</span><span class="n">conn</span><span class="p">,</span> <span class="n">opts</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;set_connection_execution_options&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This method is called after the new <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>
has been
produced, with the newly updated execution options collection, but
before the <a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code></a> has acted upon any of those new options.</p>
<p>Note that this method is not called when a new
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>
is produced which is inheriting execution options from its parent
<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>; to intercept this condition, use the
<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect()</span></code></a> event.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.conn">¶</a> – The newly copied <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options.params.opts">¶</a> – <p>dictionary of options that were passed to the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code></a> method.
This dictionary may be modified in place to affect the ultimate
options which take effect.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>the <code class="docutils literal notranslate"><span class="pre">opts</span></code> dictionary may be modified
in place.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options" title="sqlalchemy.events.ConnectionEvents.set_engine_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.set_engine_execution_options()</span></code></a>
- event
which is called when <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execution_options" title="sqlalchemy.engine.Engine.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.execution_options()</span></code></a>
is called.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.ConnectionEvents.set_engine_execution_options">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.ConnectionEvents.</span></code></a><span class="sig-name descname"><span class="pre">set_engine_execution_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.base.Engine"><span class="pre">Engine</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">opts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options" title="Link to this definition">¶</a></dt>
<dd><p>Intercept when the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execution_options" title="sqlalchemy.engine.Engine.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.execution_options()</span></code></a>
method is called.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;set_engine_execution_options&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_set_engine_execution_options</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="n">opts</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;set_engine_execution_options&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>The <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.execution_options" title="sqlalchemy.engine.Engine.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.execution_options()</span></code></a> method produces a shallow
copy of the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> which stores the new options.
That new
<a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> is passed here.
A particular application of this
method is to add a <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect()</span></code></a>
event
handler to the given <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
which will perform some per-
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> task specific to these execution options.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.conn"></span><strong>conn</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.conn">¶</a> – The newly copied <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> object</p></li>
<li><p><span class="target" id="sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options.params.opts">¶</a> – <p>dictionary of options that were passed to the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code></a> method.
This dictionary may be modified in place to affect the ultimate
options which take effect.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>the <code class="docutils literal notranslate"><span class="pre">opts</span></code> dictionary may be modified
in place.</p>
</div>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options" title="sqlalchemy.events.ConnectionEvents.set_connection_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.set_connection_execution_options()</span></code></a>
- event
which is called when <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code></a>
is
called.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.events.</span></span><span class="sig-name descname"><span class="pre">DialectEvents</span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents" title="Link to this definition">¶</a></dt>
<dd><p>event interface for execution-replacement functions.</p>
<p>These events allow direct instrumentation and replacement
of key dialect functions which interact with the DBAPI.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p><a class="reference internal" href="#sqlalchemy.events.DialectEvents" title="sqlalchemy.events.DialectEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">DialectEvents</span></code></a> hooks should be considered <strong>semi-public</strong>
and experimental.
These hooks are not for general use and are only for those situations
where intricate re-statement of DBAPI mechanics must be injected onto
an existing dialect.  For general-use statement-interception events,
please use the <a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionEvents</span></code></a> interface.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute" title="sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.before_cursor_execute()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute" title="sqlalchemy.events.ConnectionEvents.before_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute" title="sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.after_cursor_execute()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute" title="sqlalchemy.events.ConnectionEvents.after_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute()</span></code></a></p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.events.DialectEvents.dispatch"><span class="sig-name descname">dispatch</span></a>, <a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_connect"><span class="sig-name descname">do_connect()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_execute"><span class="sig-name descname">do_execute()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_execute_no_params"><span class="sig-name descname">do_execute_no_params()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_executemany"><span class="sig-name descname">do_executemany()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_setinputsizes"><span class="sig-name descname">do_setinputsizes()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error"><span class="sig-name descname">handle_error()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.events.DialectEvents" title="sqlalchemy.events.DialectEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents</span></code></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.Events</span></code>)</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.dispatch">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">dispatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_Dispatch</span><span class="p"><span class="pre">[</span></span><span class="pre">_ET</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;sqlalchemy.event.base.DialectEventsDispatch</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#sqlalchemy.events.DialectEvents.dispatch" title="Link to this definition">¶</a></dt>
<dd><p>reference back to the _Dispatch class.</p>
<p>Bidirectional against _Dispatch._events</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.do_connect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">do_connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dialect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><span class="pre">Dialect</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn_rec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="pooling.html#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><span class="pre">ConnectionPoolEntry</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Tuple" title="sqlalchemy.sql.expression.Tuple"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_connect" title="Link to this definition">¶</a></dt>
<dd><p>Receive connection arguments before a connection is made.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;do_connect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_connect</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">conn_rec</span><span class="p">,</span> <span class="n">cargs</span><span class="p">,</span> <span class="n">cparams</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;do_connect&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is useful in that it allows the handler to manipulate the
cargs and/or cparams collections that control how the DBAPI
<code class="docutils literal notranslate"><span class="pre">connect()</span></code> function will be called. <code class="docutils literal notranslate"><span class="pre">cargs</span></code> will always be a
Python list that can be mutated in-place, and <code class="docutils literal notranslate"><span class="pre">cparams</span></code> a Python
dictionary that may also be mutated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://user@host/dbname&quot;</span><span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;do_connect&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_connect</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">conn_rec</span><span class="p">,</span> <span class="n">cargs</span><span class="p">,</span> <span class="n">cparams</span><span class="p">):</span>
    <span class="n">cparams</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;some_password&quot;</span></pre></div>
</div>
<p>The event hook may also be used to override the call to <code class="docutils literal notranslate"><span class="pre">connect()</span></code>
entirely, by returning a non-<code class="docutils literal notranslate"><span class="pre">None</span></code> DBAPI connection object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql+psycopg2://user@host/dbname&quot;</span><span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;do_connect&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_connect</span><span class="p">(</span><span class="n">dialect</span><span class="p">,</span> <span class="n">conn_rec</span><span class="p">,</span> <span class="n">cargs</span><span class="p">,</span> <span class="n">cparams</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="o">*</span><span class="n">cargs</span><span class="p">,</span> <span class="o">**</span><span class="n">cparams</span><span class="p">)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="engines.html#custom-dbapi-args"><span class="std std-ref">自定义 DBAPI connect() 参数/连接例程</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.do_execute">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">do_execute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPICursor" title="sqlalchemy.engine.interfaces.DBAPICursor"><span class="pre">DBAPICursor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_DBAPISingleExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><span class="pre">ExecutionContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_execute" title="Link to this definition">¶</a></dt>
<dd><p>Receive a cursor to have execute() called.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;do_execute&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_execute</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;do_execute&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>Return the value True to halt further events from invoking,
and to indicate that the cursor execution has already taken
place within the event handler.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.do_execute_no_params">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">do_execute_no_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPICursor" title="sqlalchemy.engine.interfaces.DBAPICursor"><span class="pre">DBAPICursor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><span class="pre">ExecutionContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_execute_no_params" title="Link to this definition">¶</a></dt>
<dd><p>Receive a cursor to have execute() with no parameters called.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;do_execute_no_params&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_execute_no_params</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;do_execute_no_params&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>Return the value True to halt further events from invoking,
and to indicate that the cursor execution has already taken
place within the event handler.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.do_executemany">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">do_executemany</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPICursor" title="sqlalchemy.engine.interfaces.DBAPICursor"><span class="pre">DBAPICursor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_DBAPIMultiExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><span class="pre">ExecutionContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="k"><span class="pre">True</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_executemany" title="Link to this definition">¶</a></dt>
<dd><p>Receive a cursor to have executemany() called.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;do_executemany&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_executemany</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;do_executemany&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>Return the value True to halt further events from invoking,
and to indicate that the cursor execution has already taken
place within the event handler.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.do_setinputsizes">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">do_setinputsizes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputsizes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.BindParameter" title="sqlalchemy.sql.expression.BindParameter"><span class="pre">BindParameter</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cursor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPICursor" title="sqlalchemy.engine.interfaces.DBAPICursor"><span class="pre">DBAPICursor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_DBAPIAnyExecuteParams</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="internals.html#sqlalchemy.engine.ExecutionContext" title="sqlalchemy.engine.ExecutionContext"><span class="pre">ExecutionContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.do_setinputsizes" title="Link to this definition">¶</a></dt>
<dd><p>Receive the setinputsizes dictionary for possible modification.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;do_setinputsizes&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_do_setinputsizes</span><span class="p">(</span><span class="n">inputsizes</span><span class="p">,</span> <span class="n">cursor</span><span class="p">,</span> <span class="n">statement</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;do_setinputsizes&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is emitted in the case where the dialect makes use of the
DBAPI <code class="docutils literal notranslate"><span class="pre">cursor.setinputsizes()</span></code> method which passes information about
parameter binding for a particular statement.   The given
<code class="docutils literal notranslate"><span class="pre">inputsizes</span></code> dictionary will contain <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.BindParameter" title="sqlalchemy.sql.expression.BindParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">BindParameter</span></code></a> objects
as keys, linked to DBAPI-specific type objects as values; for
parameters that are not bound, they are added to the dictionary with
<code class="docutils literal notranslate"><span class="pre">None</span></code> as the value, which means the parameter will not be included
in the ultimate setinputsizes call.   The event may be used to inspect
and/or log the datatypes that are being bound, as well as to modify the
dictionary in place.  Parameters can be added, modified, or removed
from this dictionary.   Callers will typically want to inspect the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">BindParameter.type</span></code> attribute of the given bind objects in
order to make decisions about the DBAPI object.</p>
<p>After the event, the <code class="docutils literal notranslate"><span class="pre">inputsizes</span></code> dictionary is converted into
an appropriate datastructure to be passed to <code class="docutils literal notranslate"><span class="pre">cursor.setinputsizes</span></code>;
either a list for a positional bound parameter execution style,
or a dictionary of string parameter keys to DBAPI type objects for
a named bound parameter execution style.</p>
<p>The setinputsizes hook overall is only used for dialects which include
the flag <code class="docutils literal notranslate"><span class="pre">use_setinputsizes=True</span></code>.  Dialects which use this
include python-oracledb, cx_Oracle, pg8000, asyncpg, and pyodbc
dialects.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>For use with pyodbc, the <code class="docutils literal notranslate"><span class="pre">use_setinputsizes</span></code> flag
must be passed to the dialect, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mssql+pyodbc://...&quot;</span><span class="p">,</span> <span class="n">use_setinputsizes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../dialects/mssql.html#mssql-pyodbc-setinputsizes"><span class="std std-ref">Setinputsizes Support</span></a></p>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../dialects/oracle.html#cx-oracle-setinputsizes"><span class="std std-ref">Fine grained control over cx_Oracle data binding performance with setinputsizes</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DialectEvents.handle_error">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DialectEvents.</span></code></a><span class="sig-name descname"><span class="pre">handle_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exception_context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext" title="sqlalchemy.engine.ExceptionContext"><span class="pre">ExceptionContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">BaseException</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DialectEvents.handle_error" title="Link to this definition">¶</a></dt>
<dd><p>Intercept all exceptions processed by the
<a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code></a>, typically but not limited to those
emitted within the scope of a <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeEngine</span><span class="p">,</span> <span class="s1">&#39;handle_error&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_handle_error</span><span class="p">(</span><span class="n">exception_context</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;handle_error&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0 版本发生变更: </span>the <a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a> event
is moved to the <a class="reference internal" href="#sqlalchemy.events.DialectEvents" title="sqlalchemy.events.DialectEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">DialectEvents</span></code></a> class, moved from the
<a class="reference internal" href="#sqlalchemy.events.ConnectionEvents" title="sqlalchemy.events.ConnectionEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionEvents</span></code></a> class, so that it may also participate in
the “pre ping” operation configured with the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_pre_ping" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_pre_ping</span></code></a> parameter. The event
remains registered by using the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> as the event
target, however note that using the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> as
an event target for <a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a> is no longer
supported.</p>
</div>
<p>This includes all exceptions emitted by the DBAPI as well as
within SQLAlchemy’s statement invocation process, including
encoding errors and other statement validation errors.  Other areas
in which the event is invoked include transaction begin and end,
result row fetching, cursor creation.</p>
<p>Note that <a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">handle_error()</span></code></a> may support new kinds of exceptions
and new calling scenarios at <em>any time</em>.  Code which uses this
event must expect new calling patterns to be present in minor
releases.</p>
<p>To support the wide variety of members that correspond to an exception,
as well as to allow extensibility of the event without backwards
incompatibility, the sole argument received is an instance of
<a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext" title="sqlalchemy.engine.ExceptionContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionContext</span></code></a>.   This object contains data members
representing detail about the exception.</p>
<p>Use cases supported by this hook include:</p>
<ul class="simple">
<li><p>read-only, low-level exception handling for logging and
debugging purposes</p></li>
<li><p>Establishing whether a DBAPI connection error message indicates
that the database connection needs to be reconnected, including
for the “pre_ping” handler used by <strong>some</strong> dialects</p></li>
<li><p>Establishing or disabling whether a connection or the owning
connection pool is invalidated or expired in response to a
specific exception</p></li>
<li><p>exception re-writing</p></li>
</ul>
<p>The hook is called while the cursor from the failed operation
(if any) is still open and accessible.   Special cleanup operations
can be called on this cursor; SQLAlchemy will attempt to close
this cursor subsequent to this hook being invoked.</p>
<p>As of SQLAlchemy 2.0, the “pre_ping” handler enabled using the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_pre_ping" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_pre_ping</span></code></a> parameter will also
participate in the <a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">handle_error()</span></code></a> process, <strong>for those dialects
that rely upon disconnect codes to detect database liveness</strong>. Note
that some dialects such as psycopg, psycopg2, and most MySQL dialects
make use of a native <code class="docutils literal notranslate"><span class="pre">ping()</span></code> method supplied by the DBAPI which does
not make use of disconnect codes.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0.0 版本发生变更: </span>The <a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a>
event hook participates in connection pool “pre-ping” operations.
Within this usage, the <a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext.engine" title="sqlalchemy.engine.ExceptionContext.engine"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ExceptionContext.engine</span></code></a> attribute
will be <code class="docutils literal notranslate"><span class="pre">None</span></code>, however the <a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code></a> in use is always
available via the <a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext.dialect" title="sqlalchemy.engine.ExceptionContext.dialect"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ExceptionContext.dialect</span></code></a> attribute.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0.5 版本发生变更: </span>Added <a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext.is_pre_ping" title="sqlalchemy.engine.ExceptionContext.is_pre_ping"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ExceptionContext.is_pre_ping</span></code></a>
attribute which will be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> when the
<a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a> event hook is triggered within
a connection pool pre-ping operation.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0.5 版本发生变更: </span>An issue was repaired that allows for the
PostgreSQL <code class="docutils literal notranslate"><span class="pre">psycopg</span></code> and <code class="docutils literal notranslate"><span class="pre">psycopg2</span></code> drivers, as well as all
MySQL drivers, to properly participate in the
<a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a> event hook during
connection pool “pre-ping” operations; previously, the
implementation was non-working for these drivers.</p>
</div>
<p>A handler function has two options for replacing
the SQLAlchemy-constructed exception into one that is user
defined.   It can either raise this new exception directly, in
which case all further event listeners are bypassed and the
exception will be raised, after appropriate cleanup as taken
place:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;handle_error&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_exception</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">isinstance</span><span class="p">(</span>
        <span class="n">context</span><span class="o">.</span><span class="n">original_exception</span><span class="p">,</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">OperationalError</span>
    <span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;failed&quot;</span> <span class="ow">in</span> <span class="n">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">original_exception</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">MySpecialException</span><span class="p">(</span><span class="s2">&quot;failed operation&quot;</span><span class="p">)</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>Because the
<a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a>
event specifically provides for exceptions to be re-thrown as
the ultimate exception raised by the failed statement,
<strong>stack traces will be misleading</strong> if the user-defined event
handler itself fails and throws an unexpected exception;
the stack trace may not illustrate the actual code line that
failed!  It is advised to code carefully here and use
logging and/or inline debugging if unexpected exceptions are
occurring.</p>
</div>
<p>Alternatively, a “chained” style of event handling can be
used, by configuring the handler with the <code class="docutils literal notranslate"><span class="pre">retval=True</span></code>
modifier and returning the new exception instance from the
function.  In this case, event handling will continue onto the
next handler.   The “chained” exception is available using
<a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext.chained_exception" title="sqlalchemy.engine.ExceptionContext.chained_exception"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ExceptionContext.chained_exception</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">Engine</span><span class="p">,</span> <span class="s2">&quot;handle_error&quot;</span><span class="p">,</span> <span class="n">retval</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_exception</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">context</span><span class="o">.</span><span class="n">chained_exception</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="s2">&quot;special&quot;</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">chained_exception</span><span class="o">.</span><span class="n">message</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="n">MySpecialException</span><span class="p">(</span>
            <span class="s2">&quot;failed&quot;</span><span class="p">,</span> <span class="n">cause</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">chained_exception</span>
        <span class="p">)</span></pre></div>
</div>
<p>Handlers that return <code class="docutils literal notranslate"><span class="pre">None</span></code> may be used within the chain; when
a handler returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, the previous exception instance,
if any, is maintained as the current exception that is passed onto the
next handler.</p>
<p>When a custom exception is raised or returned, SQLAlchemy raises
this new exception as-is, it is not wrapped by any SQLAlchemy
object.  If the exception is not a subclass of
<a class="reference internal" href="exceptions.html#sqlalchemy.exc.StatementError" title="sqlalchemy.exc.StatementError"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.exc.StatementError</span></code></a>,
certain features may not be available; currently this includes
the ORM’s feature of adding a detail hint about “autoflush” to
exceptions raised within the autoflush process.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.events.DialectEvents.handle_error.params.context"></span><strong>context</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DialectEvents.handle_error.params.context">¶</a> – an <a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext" title="sqlalchemy.engine.ExceptionContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionContext</span></code></a> object.  See this
class for details on all available members.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="pooling.html#pool-new-disconnect-codes"><span class="std std-ref">支持断开连接场景的新数据库错误代码</span></a></p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="id3">
<h2>架构事件<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<p>Schema Events</p>
<div class="table-wrapper longtable docutils container">
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><span class="sig-name descname">DDLEvents</span></a></p></td>
<td><p>Define event listeners for schema objects,
that is, <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> and other <a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaEventTarget</span></code></a>
subclasses, including <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a>, <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>,
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a>, etc.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget"><span class="sig-name descname">SchemaEventTarget</span></a></p></td>
<td><p>Base class for elements that are the targets of <a class="reference internal" href="#sqlalchemy.events.DDLEvents" title="sqlalchemy.events.DDLEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">DDLEvents</span></code></a>
events.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.events.</span></span><span class="sig-name descname"><span class="pre">DDLEvents</span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents" title="Link to this definition">¶</a></dt>
<dd><p>Define event listeners for schema objects,
that is, <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> and other <a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaEventTarget</span></code></a>
subclasses, including <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a>, <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>,
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a>, etc.</p>
<p><strong>Create / Drop Events</strong></p>
<p>Events emitted when CREATE and DROP commands are emitted to the database.
The event hooks in this category include <a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_create" title="sqlalchemy.events.DDLEvents.before_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.before_create()</span></code></a>,
<a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_create" title="sqlalchemy.events.DDLEvents.after_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.after_create()</span></code></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_drop" title="sqlalchemy.events.DDLEvents.before_drop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.before_drop()</span></code></a>, and
<a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_drop" title="sqlalchemy.events.DDLEvents.after_drop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.after_drop()</span></code></a>.</p>
<p>These events are emitted when using schema-level methods such as
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.create_all" title="sqlalchemy.schema.MetaData.create_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MetaData.create_all()</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData.drop_all" title="sqlalchemy.schema.MetaData.drop_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">MetaData.drop_all()</span></code></a>. Per-object
create/drop methods such as <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.create" title="sqlalchemy.schema.Table.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.create()</span></code></a>, <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.drop" title="sqlalchemy.schema.Table.drop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.drop()</span></code></a>,
<a class="reference internal" href="constraints.html#sqlalchemy.schema.Index.create" title="sqlalchemy.schema.Index.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Index.create()</span></code></a> are also included, as well as dialect-specific
methods such as <a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ENUM.create" title="sqlalchemy.dialects.postgresql.ENUM.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ENUM.create()</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span><a class="reference internal" href="#sqlalchemy.events.DDLEvents" title="sqlalchemy.events.DDLEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">DDLEvents</span></code></a> event hooks now take place
for non-table objects including constraints, indexes, and
dialect-specific schema types.</p>
</div>
<p>Event hooks may be attached directly to a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> object or
to a <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> collection, as well as to any
<a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> class or object that can be individually created and
dropped using a distinct SQL command. Such classes include <a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>,
<a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>, and dialect-specific classes such as
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ENUM" title="sqlalchemy.dialects.postgresql.ENUM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ENUM</span></code></a>.</p>
<p>Example using the <a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_create" title="sqlalchemy.events.DDLEvents.after_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.after_create()</span></code></a> event, where a custom
event hook will emit an <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code> command on the current connection,
after <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> is emitted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Column</span><span class="p">,</span> <span class="n">Metadata</span><span class="p">,</span> <span class="n">Integer</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">some_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">some_table</span><span class="p">,</span> <span class="s2">&quot;after_create&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">after_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
        <span class="n">text</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE </span><span class="si">%s</span><span class="s2"> SET name=foo_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">target</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
    <span class="p">)</span>


<span class="n">some_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://scott:tiger@host/test&quot;</span><span class="p">)</span>

<span class="c1"># will emit &quot;CREATE TABLE some_table&quot; as well as the above</span>
<span class="c1"># &quot;ALTER TABLE&quot; statement afterwards</span>
<span class="n">m</span><span class="o">.</span><span class="n">create_all</span><span class="p">(</span><span class="n">some_engine</span><span class="p">)</span></pre></div>
</div>
<p>Constraint objects such as <a class="reference internal" href="constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKeyConstraint</span></code></a>,
<a class="reference internal" href="constraints.html#sqlalchemy.schema.UniqueConstraint" title="sqlalchemy.schema.UniqueConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueConstraint</span></code></a>, <a class="reference internal" href="constraints.html#sqlalchemy.schema.CheckConstraint" title="sqlalchemy.schema.CheckConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">CheckConstraint</span></code></a> may also be
subscribed to these events, however they will <strong>not</strong> normally produce
events as these objects are usually rendered inline within an
enclosing <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">TABLE</span></code> statement and implicitly dropped from a
<code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">TABLE</span></code> statement.</p>
<p>For the <a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a> construct, the event hook will be emitted
for <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">INDEX</span></code>, however SQLAlchemy does not normally emit
<code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">INDEX</span></code> when dropping tables as this is again implicit within the
<code class="docutils literal notranslate"><span class="pre">DROP</span> <span class="pre">TABLE</span></code> statement.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>Support for <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> objects
for create/drop events was expanded from its previous support for
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> and <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> to also include
<a class="reference internal" href="constraints.html#sqlalchemy.schema.Constraint" title="sqlalchemy.schema.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a> and all subclasses, <a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>,
<a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a> and some type-related constructs such as
<a class="reference internal" href="../dialects/postgresql.html#sqlalchemy.dialects.postgresql.ENUM" title="sqlalchemy.dialects.postgresql.ENUM"><code class="xref py py-class docutils literal notranslate"><span class="pre">ENUM</span></code></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>These event hooks are only emitted within the scope of
SQLAlchemy’s create/drop methods; they are not necessarily supported
by tools such as <a class="reference external" href="https://alembic.sqlalchemy.org">alembic</a>.</p>
</div>
<p><strong>Attachment Events</strong></p>
<p>Attachment events are provided to customize
behavior whenever a child schema element is associated
with a parent, such as when a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> is associated
with its <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, when a
<a class="reference internal" href="constraints.html#sqlalchemy.schema.ForeignKeyConstraint" title="sqlalchemy.schema.ForeignKeyConstraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">ForeignKeyConstraint</span></code></a>
is associated with a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, etc.  These events include
<a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach" title="sqlalchemy.events.DDLEvents.before_parent_attach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.before_parent_attach()</span></code></a> and
<a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach" title="sqlalchemy.events.DDLEvents.after_parent_attach"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.after_parent_attach()</span></code></a>.</p>
<p><strong>Reflection Events</strong></p>
<p>The <a class="reference internal" href="#sqlalchemy.events.DDLEvents.column_reflect" title="sqlalchemy.events.DDLEvents.column_reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.column_reflect()</span></code></a> event is used to intercept
and modify the in-Python definition of database columns when
<a class="reference internal" href="../glossary.html#term-reflection"><span class="xref std std-term">reflection</span></a> of database tables proceeds.</p>
<p><strong>Use with Generic DDL</strong></p>
<p>DDL events integrate closely with the
<a class="reference internal" href="ddl.html#sqlalchemy.schema.DDL" title="sqlalchemy.schema.DDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">DDL</span></code></a> class and the <a class="reference internal" href="ddl.html#sqlalchemy.schema.ExecutableDDLElement" title="sqlalchemy.schema.ExecutableDDLElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecutableDDLElement</span></code></a> hierarchy
of DDL clause constructs, which are themselves appropriate
as listener callables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">DDL</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
    <span class="n">some_table</span><span class="p">,</span>
    <span class="s2">&quot;after_create&quot;</span><span class="p">,</span>
    <span class="n">DDL</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE </span><span class="si">%(table)s</span><span class="s2"> SET name=foo_</span><span class="si">%(table)s</span><span class="s2">&quot;</span><span class="p">),</span>
<span class="p">)</span></pre></div>
</div>
<p><strong>Event Propagation to MetaData Copies</strong></p>
<p>For all <code class="xref py py-class docutils literal notranslate"><span class="pre">DDLEvent</span></code> events, the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code> keyword argument
will ensure that a given event handler is propagated to copies of the
object, which are made when using the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a>
method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">DDL</span>

<span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">some_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;some_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">Column</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">))</span>

<span class="n">event</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span>
    <span class="n">some_table</span><span class="p">,</span>
    <span class="s2">&quot;after_create&quot;</span><span class="p">,</span>
    <span class="n">DDL</span><span class="p">(</span><span class="s2">&quot;ALTER TABLE </span><span class="si">%(table)s</span><span class="s2"> SET name=foo_</span><span class="si">%(table)s</span><span class="s2">&quot;</span><span class="p">),</span>
    <span class="n">propagate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">new_metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>
<span class="n">new_table</span> <span class="o">=</span> <span class="n">some_table</span><span class="o">.</span><span class="n">to_metadata</span><span class="p">(</span><span class="n">new_metadata</span><span class="p">)</span></pre></div>
</div>
<p>The above <a class="reference internal" href="ddl.html#sqlalchemy.schema.DDL" title="sqlalchemy.schema.DDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">DDL</span></code></a> object will be associated with the
<a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_create" title="sqlalchemy.events.DDLEvents.after_create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.after_create()</span></code></a> event for both the <code class="docutils literal notranslate"><span class="pre">some_table</span></code> and
the <code class="docutils literal notranslate"><span class="pre">new_table</span></code> <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="event.html#event-toplevel"><span class="std std-ref">事件</span></a></p>
<p><a class="reference internal" href="ddl.html#sqlalchemy.schema.ExecutableDDLElement" title="sqlalchemy.schema.ExecutableDDLElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExecutableDDLElement</span></code></a></p>
<p><a class="reference internal" href="ddl.html#sqlalchemy.schema.DDL" title="sqlalchemy.schema.DDL"><code class="xref py py-class docutils literal notranslate"><span class="pre">DDL</span></code></a></p>
<p><a class="reference internal" href="ddl.html#schema-ddl-sequences"><span class="std std-ref">控制 DDL 序列</span></a></p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_create"><span class="sig-name descname">after_create()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_drop"><span class="sig-name descname">after_drop()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach"><span class="sig-name descname">after_parent_attach()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_create"><span class="sig-name descname">before_create()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_drop"><span class="sig-name descname">before_drop()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach"><span class="sig-name descname">before_parent_attach()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.column_reflect"><span class="sig-name descname">column_reflect()</span></a>, <a class="reference internal" href="#sqlalchemy.events.DDLEvents.dispatch"><span class="sig-name descname">dispatch</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.events.DDLEvents" title="sqlalchemy.events.DDLEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents</span></code></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.Events</span></code>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.after_create">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">after_create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><span class="pre">SchemaEventTarget</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.after_create" title="Link to this definition">¶</a></dt>
<dd><p>Called after CREATE statements are emitted.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;after_create&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_after_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;after_create&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_create.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_create.params.target">¶</a> – <p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaObject</span></code>, such as a
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
but also including all create/drop objects such as
<a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>, etc.,
object which is the target of the event.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>Support for all <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> objects
was added.</p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_create.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_create.params.connection">¶</a> – the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> where the
CREATE statement or statements have been emitted.</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_create.params.**kw"></span><strong>**kw</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_create.params.**kw">¶</a> – additional keyword arguments relevant
to the event.  The contents of this dictionary
may vary across releases, and include the
list of tables being generated for a metadata-level
event, the checkfirst flag, and other
elements used by internal events.</p></li>
</ul>
</dd>
</dl>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> also accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.after_drop">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">after_drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><span class="pre">SchemaEventTarget</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.after_drop" title="Link to this definition">¶</a></dt>
<dd><p>Called after DROP statements are emitted.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;after_drop&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_after_drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;after_drop&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_drop.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_drop.params.target">¶</a> – <p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaObject</span></code>, such as a
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
but also including all create/drop objects such as
<a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>, etc.,
object which is the target of the event.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>Support for all <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> objects
was added.</p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_drop.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_drop.params.connection">¶</a> – the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> where the
DROP statement or statements have been emitted.</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_drop.params.**kw"></span><strong>**kw</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_drop.params.**kw">¶</a> – additional keyword arguments relevant
to the event.  The contents of this dictionary
may vary across releases, and include the
list of tables being generated for a metadata-level
event, the checkfirst flag, and other
elements used by internal events.</p></li>
</ul>
</dd>
</dl>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> also accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.after_parent_attach">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">after_parent_attach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><span class="pre">SchemaEventTarget</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><span class="pre">SchemaItem</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.after_parent_attach" title="Link to this definition">¶</a></dt>
<dd><p>Called after a <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> is associated with
a parent <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;after_parent_attach&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_after_parent_attach</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;after_parent_attach&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_parent_attach.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach.params.target">¶</a> – the target object</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.after_parent_attach.params.parent"></span><strong>parent</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach.params.parent">¶</a> – the parent to which the target is being attached.</p></li>
</ul>
</dd>
</dl>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> also accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.before_create">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">before_create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><span class="pre">SchemaEventTarget</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.before_create" title="Link to this definition">¶</a></dt>
<dd><p>Called before CREATE statements are emitted.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;before_create&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_before_create</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;before_create&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_create.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_create.params.target">¶</a> – <p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaObject</span></code>, such as a
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
but also including all create/drop objects such as
<a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>, etc.,
object which is the target of the event.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>Support for all <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> objects
was added.</p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_create.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_create.params.connection">¶</a> – the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> where the
CREATE statement or statements will be emitted.</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_create.params.**kw"></span><strong>**kw</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_create.params.**kw">¶</a> – additional keyword arguments relevant
to the event.  The contents of this dictionary
may vary across releases, and include the
list of tables being generated for a metadata-level
event, the checkfirst flag, and other
elements used by internal events.</p></li>
</ul>
</dd>
</dl>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> accepts the <code class="docutils literal notranslate"><span class="pre">insert=True</span></code>
modifier for this event; when True, the listener function will
be prepended to the internal list of events upon discovery, and execute
before registered listener functions that do not pass this argument.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.before_drop">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">before_drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><span class="pre">SchemaEventTarget</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><span class="pre">Connection</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.before_drop" title="Link to this definition">¶</a></dt>
<dd><p>Called before DROP statements are emitted.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;before_drop&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_before_drop</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;before_drop&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_drop.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_drop.params.target">¶</a> – <p>the <code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaObject</span></code>, such as a
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> or <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
but also including all create/drop objects such as
<a class="reference internal" href="constraints.html#sqlalchemy.schema.Index" title="sqlalchemy.schema.Index"><code class="xref py py-class docutils literal notranslate"><span class="pre">Index</span></code></a>, <a class="reference internal" href="defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sequence</span></code></a>, etc.,
object which is the target of the event.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span>Support for all <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> objects
was added.</p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_drop.params.connection"></span><strong>connection</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_drop.params.connection">¶</a> – the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> where the
DROP statement or statements will be emitted.</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_drop.params.**kw"></span><strong>**kw</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_drop.params.**kw">¶</a> – additional keyword arguments relevant
to the event.  The contents of this dictionary
may vary across releases, and include the
list of tables being generated for a metadata-level
event, the checkfirst flag, and other
elements used by internal events.</p></li>
</ul>
</dd>
</dl>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> also accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.before_parent_attach">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">before_parent_attach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><span class="pre">SchemaEventTarget</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><span class="pre">SchemaItem</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.before_parent_attach" title="Link to this definition">¶</a></dt>
<dd><p>Called before a <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> is associated with
a parent <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a>.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;before_parent_attach&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_before_parent_attach</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;before_parent_attach&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_parent_attach.params.target"></span><strong>target</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach.params.target">¶</a> – the target object</p></li>
<li><p><span class="target" id="sqlalchemy.events.DDLEvents.before_parent_attach.params.parent"></span><strong>parent</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach.params.parent">¶</a> – the parent to which the target is being attached.</p></li>
</ul>
</dd>
</dl>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> also accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.column_reflect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">column_reflect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inspector</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="reflection.html#sqlalchemy.engine.reflection.Inspector" title="sqlalchemy.engine.reflection.Inspector"><span class="pre">Inspector</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><span class="pre">Table</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="reflection.html#sqlalchemy.engine.interfaces.ReflectedColumn" title="sqlalchemy.engine.interfaces.ReflectedColumn"><span class="pre">ReflectedColumn</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.events.DDLEvents.column_reflect" title="Link to this definition">¶</a></dt>
<dd><p>Called for each unit of ‘column info’ retrieved when
a <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> is being reflected.</p>
<div class="event-signatures docutils container">
<p>Example argument forms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">SomeSchemaClassOrObject</span><span class="p">,</span> <span class="s1">&#39;column_reflect&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_column_reflect</span><span class="p">(</span><span class="n">inspector</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column_info</span><span class="p">):</span>
    <span class="s2">&quot;listen for the &#39;column_reflect&#39; event&quot;</span>

    <span class="c1"># ... (event handling logic) ...</span></pre></div>
</div>
</div>
<p>This event is most easily used by applying it to a specific
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> instance, where it will take effect for
all <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects within that
<a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> that undergo reflection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span> <span class="o">=</span> <span class="n">MetaData</span><span class="p">()</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="s2">&quot;column_reflect&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_column_reflect</span><span class="p">(</span><span class="n">inspector</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column_info</span><span class="p">):</span>
    <span class="c1"># receives for all Table objects that are reflected</span>
    <span class="c1"># under this MetaData</span>
    <span class="o">...</span>


<span class="c1"># will use the above event hook</span>
<span class="n">my_table</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="s2">&quot;my_table&quot;</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="n">autoload_with</span><span class="o">=</span><span class="n">some_engine</span><span class="p">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4.0b2 版本加入: </span>The <a class="reference internal" href="#sqlalchemy.events.DDLEvents.column_reflect" title="sqlalchemy.events.DDLEvents.column_reflect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DDLEvents.column_reflect()</span></code></a>
hook may now be applied to a <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> object as
well as the <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a> class itself where it will
take place for all <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> objects associated with
the targeted <a class="reference internal" href="metadata.html#sqlalchemy.schema.MetaData" title="sqlalchemy.schema.MetaData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetaData</span></code></a>.</p>
</div>
<p>It may also be applied to the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> class across
the board:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">Table</span><span class="p">,</span> <span class="s2">&quot;column_reflect&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">receive_column_reflect</span><span class="p">(</span><span class="n">inspector</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">column_info</span><span class="p">):</span>
    <span class="c1"># receives for all Table objects that are reflected</span>
    <span class="o">...</span></pre></div>
</div>
<p>It can also be applied to a specific <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> at the
point that one is being reflected using the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.params.listeners" title="sqlalchemy.schema.Table"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Table.listeners</span></code></a> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">t1</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span>
    <span class="s2">&quot;my_table&quot;</span><span class="p">,</span>
    <span class="n">autoload_with</span><span class="o">=</span><span class="n">some_engine</span><span class="p">,</span>
    <span class="n">listeners</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;column_reflect&quot;</span><span class="p">,</span> <span class="n">receive_column_reflect</span><span class="p">)],</span>
<span class="p">)</span></pre></div>
</div>
<p>The dictionary of column information as returned by the
dialect is passed, and can be modified.  The dictionary
is that returned in each element of the list returned
by <a class="reference internal" href="reflection.html#sqlalchemy.engine.reflection.Inspector.get_columns" title="sqlalchemy.engine.reflection.Inspector.get_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Inspector.get_columns()</span></code></a>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - the column’s name, is applied to the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.name" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.name</span></code></a> parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> - the type of this column, which should be an instance
of <a class="reference internal" href="type_api.html#sqlalchemy.types.TypeEngine" title="sqlalchemy.types.TypeEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeEngine</span></code></a>, is applied to the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.type" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.type</span></code></a> parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nullable</span></code> - boolean flag if the column is NULL or NOT NULL,
is applied to the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.nullable" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.nullable</span></code></a> parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code> - the column’s server default value.  This is
normally specified as a plain string SQL expression, however the
event can pass a <a class="reference internal" href="defaults.html#sqlalchemy.schema.FetchedValue" title="sqlalchemy.schema.FetchedValue"><code class="xref py py-class docutils literal notranslate"><span class="pre">FetchedValue</span></code></a>, <a class="reference internal" href="defaults.html#sqlalchemy.schema.DefaultClause" title="sqlalchemy.schema.DefaultClause"><code class="xref py py-class docutils literal notranslate"><span class="pre">DefaultClause</span></code></a>,
or <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a> object as well.  Is applied to the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.server_default" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.server_default</span></code></a> parameter</p></li>
</ul>
</div></blockquote>
<p>The event is called before any action is taken against
this dictionary, and the contents can be modified; the following
additional keys may be added to the dictionary to further modify
how the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> is constructed:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - the string key that will be used to access this
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> in the <code class="docutils literal notranslate"><span class="pre">.c</span></code> collection; will be applied
to the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.key" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.key</span></code></a> parameter. Is also used
for ORM mapping.  See the section
<a class="reference internal" href="../orm/declarative_tables.html#mapper-automated-reflection-schemes"><span class="std std-ref">从反射表自动执行列命名方案</span></a> for an example.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quote</span></code> - force or un-force quoting on the column name;
is applied to the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.quote" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.quote</span></code></a> parameter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">info</span></code> - a dictionary of arbitrary data to follow along with
the <a class="reference internal" href="metadata.html#sqlalchemy.schema.Column" title="sqlalchemy.schema.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a>, is applied to the
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Column.params.info" title="sqlalchemy.schema.Column"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Column.info</span></code></a> parameter.</p></li>
</ul>
</div></blockquote>
<p><a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> also accepts the <code class="docutils literal notranslate"><span class="pre">propagate=True</span></code>
modifier for this event; when True, the listener function will
be established for any copies made of the target object,
i.e. those copies that are generated when
<a class="reference internal" href="metadata.html#sqlalchemy.schema.Table.to_metadata" title="sqlalchemy.schema.Table.to_metadata"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Table.to_metadata()</span></code></a> is used.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../orm/declarative_tables.html#mapper-automated-reflection-schemes"><span class="std std-ref">从反射表自动执行列命名方案</span></a> -
in the ORM mapping documentation</p>
<p><a class="reference internal" href="../orm/extensions/automap.html#automap-intercepting-columns"><span class="std std-ref">Intercepting Column Definitions</span></a> -
in the <a class="reference internal" href="../orm/extensions/automap.html#automap-toplevel"><span class="std std-ref">自动映射</span></a> documentation</p>
<p><a class="reference internal" href="reflection.html#metadata-reflection-dbagnostic-types"><span class="std std-ref">使用与数据库无关的类型进行反射</span></a> - in
the <a class="reference internal" href="reflection.html#metadata-reflection-toplevel"><span class="std std-ref">反映数据库对象</span></a> documentation</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.events.DDLEvents.dispatch">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.events.DDLEvents.</span></code></a><span class="sig-name descname"><span class="pre">dispatch</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">_Dispatch</span><span class="p"><span class="pre">[</span></span><span class="pre">_ET</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;sqlalchemy.event.base.DDLEventsDispatch</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#sqlalchemy.events.DDLEvents.dispatch" title="Link to this definition">¶</a></dt>
<dd><p>reference back to the _Dispatch class.</p>
<p>Bidirectional against _Dispatch._events</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.events.SchemaEventTarget">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.events.</span></span><span class="sig-name descname"><span class="pre">SchemaEventTarget</span></span><a class="headerlink" href="#sqlalchemy.events.SchemaEventTarget" title="Link to this definition">¶</a></dt>
<dd><p>Base class for elements that are the targets of <a class="reference internal" href="#sqlalchemy.events.DDLEvents" title="sqlalchemy.events.DDLEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">DDLEvents</span></code></a>
events.</p>
<p>This includes <a class="reference internal" href="metadata.html#sqlalchemy.schema.SchemaItem" title="sqlalchemy.schema.SchemaItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaItem</span></code></a> as well as <a class="reference internal" href="type_basics.html#sqlalchemy.types.SchemaType" title="sqlalchemy.types.SchemaType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchemaType</span></code></a>.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget" title="sqlalchemy.events.SchemaEventTarget"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.events.SchemaEventTarget</span></code></a> (<code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.registry.EventTarget</span></code>)</p>
</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api_basics.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Core API 基础</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="pooling.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">连接池</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2007-2025, the SQLAlchemy authors and contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 04/05/2025 04:00:26</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">核心事件</a><ul>
<li><a class="reference internal" href="#sqlalchemy.event.base.Events"><code class="docutils literal notranslate"><span class="pre">Events</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.event.base.Events.dispatch"><code class="docutils literal notranslate"><span class="pre">Events.dispatch</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">连接池事件</a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents"><code class="docutils literal notranslate"><span class="pre">PoolEvents</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkin"><code class="docutils literal notranslate"><span class="pre">PoolEvents.checkin()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.checkout"><code class="docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.close"><code class="docutils literal notranslate"><span class="pre">PoolEvents.close()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.close_detached"><code class="docutils literal notranslate"><span class="pre">PoolEvents.close_detached()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.connect"><code class="docutils literal notranslate"><span class="pre">PoolEvents.connect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.detach"><code class="docutils literal notranslate"><span class="pre">PoolEvents.detach()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.dispatch"><code class="docutils literal notranslate"><span class="pre">PoolEvents.dispatch</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.first_connect"><code class="docutils literal notranslate"><span class="pre">PoolEvents.first_connect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.invalidate"><code class="docutils literal notranslate"><span class="pre">PoolEvents.invalidate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.reset"><code class="docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolEvents.soft_invalidate"><code class="docutils literal notranslate"><span class="pre">PoolEvents.soft_invalidate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolResetState"><code class="docutils literal notranslate"><span class="pre">PoolResetState</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.PoolResetState.asyncio_safe"><code class="docutils literal notranslate"><span class="pre">PoolResetState.asyncio_safe</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolResetState.terminate_only"><code class="docutils literal notranslate"><span class="pre">PoolResetState.terminate_only</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.PoolResetState.transaction_was_reset"><code class="docutils literal notranslate"><span class="pre">PoolResetState.transaction_was_reset</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sql">SQL 执行和连接事件</a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_cursor_execute"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.after_cursor_execute()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.after_execute"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.after_execute()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_cursor_execute"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.before_cursor_execute()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.before_execute"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.before_execute()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.begin"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.begin()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.begin_twophase"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.begin_twophase()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.commit"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.commit()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.commit_twophase"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.commit_twophase()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.dispatch"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.dispatch</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_connect"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.engine_disposed"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.engine_disposed()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.prepare_twophase"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.prepare_twophase()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.release_savepoint"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.release_savepoint()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.rollback()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_savepoint"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.rollback_savepoint()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.rollback_twophase"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.rollback_twophase()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.savepoint"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.savepoint()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_connection_execution_options"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.set_connection_execution_options()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.ConnectionEvents.set_engine_execution_options"><code class="docutils literal notranslate"><span class="pre">ConnectionEvents.set_engine_execution_options()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents"><code class="docutils literal notranslate"><span class="pre">DialectEvents</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.dispatch"><code class="docutils literal notranslate"><span class="pre">DialectEvents.dispatch</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_connect"><code class="docutils literal notranslate"><span class="pre">DialectEvents.do_connect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_execute"><code class="docutils literal notranslate"><span class="pre">DialectEvents.do_execute()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_execute_no_params"><code class="docutils literal notranslate"><span class="pre">DialectEvents.do_execute_no_params()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_executemany"><code class="docutils literal notranslate"><span class="pre">DialectEvents.do_executemany()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.do_setinputsizes"><code class="docutils literal notranslate"><span class="pre">DialectEvents.do_setinputsizes()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DialectEvents.handle_error"><code class="docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id3">架构事件</a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents"><code class="docutils literal notranslate"><span class="pre">DDLEvents</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_create"><code class="docutils literal notranslate"><span class="pre">DDLEvents.after_create()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_drop"><code class="docutils literal notranslate"><span class="pre">DDLEvents.after_drop()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.after_parent_attach"><code class="docutils literal notranslate"><span class="pre">DDLEvents.after_parent_attach()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_create"><code class="docutils literal notranslate"><span class="pre">DDLEvents.before_create()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_drop"><code class="docutils literal notranslate"><span class="pre">DDLEvents.before_drop()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.before_parent_attach"><code class="docutils literal notranslate"><span class="pre">DDLEvents.before_parent_attach()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.column_reflect"><code class="docutils literal notranslate"><span class="pre">DDLEvents.column_reflect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.events.DDLEvents.dispatch"><code class="docutils literal notranslate"><span class="pre">DDLEvents.dispatch</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.events.SchemaEventTarget"><code class="docutils literal notranslate"><span class="pre">SchemaEventTarget</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=2d0eb83f"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=2f3e6152"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    </body>
</html>