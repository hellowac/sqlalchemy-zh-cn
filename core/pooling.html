<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../genindex.html" /><link rel="search" title="搜索" href="../search.html" /><link rel="copyright" title="版权所有" href="../copyright.html" /><link rel="next" title="核心事件" href="events.html" /><link rel="prev" title="使用Engines和Connection" href="connections.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.08.06 -->
        <title>连接池 - SQLAlchemy 2.1 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/changelog.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx_paramlinks.css" />
    <link rel="stylesheet" type="text/css" href="../_static/docs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SQLAlchemy 2.1 Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">SQLAlchemy 2.1 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">概述</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/index.html">SQLAlchemy 统一教程</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of SQLAlchemy 统一教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/engine.html">建立连接 - Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/dbapi_transactions.html">使用事务和DBAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/metadata.html">使用数据库元数据</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/data.html">处理数据</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 处理数据</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/data_insert.html">使用 INSERT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/data_select.html">使用 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/data_update.html">使用 UPDATE 和 DELETE 语句</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/orm_data_manipulation.html">使用 ORM 进行数据操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/orm_related_objects.html">使用 ORM 相关对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/further_reading.html">进一步阅读</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../orm/index.html">SQLAlchemy ORM</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of SQLAlchemy ORM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../orm/quickstart.html">ORM 快速入门</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/mapper_config.html">ORM 映射类配置</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of ORM 映射类配置</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapping_styles.html">ORM 映射类概述</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../orm/declarative_mapping.html">使用声明式映射类</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of 使用声明式映射类</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_styles.html">声明式映射风格</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_tables.html">声明式的表配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_config.html">使用声明式映射器配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../orm/declarative_mixins.html">使用 Mixins 组合映射层次结构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../orm/dataclasses.html">与dataclass和attrs的集成</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapped_sql_expr.html">SQL 表达式作为映射属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapped_attributes.html">更改Attribute的行为</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/composites.html">复合列类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/inheritance.html">映射类继承层次结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/nonstandard_mappings.html">非传统映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/versioning.html">配置版本计数器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/mapping_api.html">类映射 API</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../orm/scalar_mapping.html">映射 SQL 表达式</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 映射 SQL 表达式</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../orm/mapping_columns.html">映射表格列</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/relationships.html">关系配置</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of 关系配置</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/basic_relationships.html">基本关系模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/self_referential.html">邻接表关系</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/join_conditions.html">配置关系连接方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/large_collections.html">使用大型集合</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/collection_api.html">集合自定义和 API 详细信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/relationship_persistence.html">特殊关系的持久化模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/backref.html">使用旧版“backref”关系参数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/relationship_api.html">关系 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/queryguide/index.html">ORM 查询指南</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of ORM 查询指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/select.html">为 ORM 映射类编写 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/inheritance.html">为继承映射编写 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/dml.html">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/columns.html">列加载选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/relationships.html">关系加载技术</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/api.html">用于查询的 ORM API 功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/queryguide/query.html">旧式查询 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/session.html">使用会话</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 使用会话</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_basics.html">会话基础知识</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_state_management.html">状态管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/cascades.html">级联</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_transaction.html">事务和连接管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/persistence_techniques.html">附加持久性技术</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/contextual.html">上下文/线程本地会话</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_events.html">使用事件跟踪查询、对象和会话更改</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/session_api.html">会话 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/extending.html">事件和内部</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 事件和内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/events.html">ORM 事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/internals.html">ORM 内部</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/exceptions.html">ORM 异常</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../orm/extensions/index.html">ORM 扩展</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of ORM 扩展</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/asyncio.html">异步 I/O (asyncio)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/associationproxy.html">关联代理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/automap.html">自动映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/baked.html">烘焙查询</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/declarative/index.html">声明式扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/mutable.html">突变追踪</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/orderinglist.html">排序列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/horizontal_shard.html">水平分片</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/hybrid.html">混合属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/indexable.html">Indexable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../orm/extensions/instrumentation.html">替代类检测</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../orm/examples.html">核心和 ORM 示例</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">SQLAlchemy Core</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of SQLAlchemy Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="expression_api.html">SQL 语句和表达式 API</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of SQL 语句和表达式 API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="sqlelement.html">列元素和表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="operators.html">操作符参考</a></li>
<li class="toctree-l3"><a class="reference internal" href="selectable.html">SELECT 和相关构造</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html">插入,更新,删除</a></li>
<li class="toctree-l3"><a class="reference internal" href="functions.html">SQL 和 范型函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="compiler.html">自定义 SQL 构造和编译扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="serializer.html">表达式序列化器扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="foundation.html">SQL 表达式语言基础构造</a></li>
<li class="toctree-l3"><a class="reference internal" href="visitors.html">访问者和遍历实用程序</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="schema.html">Schema 定义语言</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Schema 定义语言</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="metadata.html">使用元数据描述数据库</a></li>
<li class="toctree-l3"><a class="reference internal" href="reflection.html">反映数据库对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="defaults.html">列 INSERT/UPDATE 默认值</a></li>
<li class="toctree-l3"><a class="reference internal" href="constraints.html">定义约束和索引</a></li>
<li class="toctree-l3"><a class="reference internal" href="ddl.html">自定义 DDL</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="types.html">SQL 数据类型对象</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of SQL 数据类型对象</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="type_basics.html">类型层次结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="custom_types.html">自定义类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="type_api.html">基本类型 API</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="engines_connections.html">Engine和Connection的使用</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Engine和Connection的使用</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="engines.html">Engine 配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="connections.html">使用Engines和Connection</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">连接池</a></li>
<li class="toctree-l3"><a class="reference internal" href="events.html">核心事件</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="api_basics.html">Core API 基础</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Core API 基础</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="event.html">事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="inspection.html">运行时审查 API</a></li>
<li class="toctree-l3"><a class="reference internal" href="exceptions.html">Core 异常</a></li>
<li class="toctree-l3"><a class="reference internal" href="internals.html">Core 内部</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dialects/index.html">Dialects</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Dialects</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dialects/postgresql.html">PostgreSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/mysql.html">MySQL 和 MariaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/sqlite.html">SQLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/oracle.html">Oracle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dialects/mssql.html">Microsoft SQL Server</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../faq/index.html">常见问题</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of 常见问题</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../faq/installation.html">安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/connections.html">连接 / 引擎</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/metadata_schema.html">元数据 / Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/sqlexpressions.html">SQL 表达式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/ormconfiguration.html">ORM 配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/performance.html">性能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/sessions.html">会话 / 查询</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq/thirdparty.html">第三方包集成问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../errors.html">错误消息</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../changelog/index.html">变更和迁移</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of 变更和迁移</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_21.html">SQLAlchemy 2.1 有什么新功能？</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_21.html">2.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_20.html">2.0 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_14.html">1.4 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_13.html">1.3 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_12.html">1.2 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_11.html">1.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_10.html">1.0 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_09.html">0.9 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_08.html">0.8 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_07.html">0.7 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_06.html">0.6 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_05.html">0.5 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_04.html">0.4 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_03.html">0.3 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_02.html">0.2 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/changelog_01.html">0.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_20.html">SQLAlchemy 2.0 - Major Migration Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/whatsnew_20.html">What’s New in SQLAlchemy 2.0?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_14.html">What’s New in SQLAlchemy 1.4?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_13.html">What’s New in SQLAlchemy 1.3?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_12.html">What’s New in SQLAlchemy 1.2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_11.html">What’s New in SQLAlchemy 1.1?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_10.html">What’s New in SQLAlchemy 1.0?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_09.html">What’s New in SQLAlchemy 0.9?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_08.html">What’s New in SQLAlchemy 0.8?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_07.html">What’s New in SQLAlchemy 0.7?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_06.html">What’s New in SQLAlchemy 0.6?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_05.html">What’s new in SQLAlchemy 0.5?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelog/migration_04.html">What’s new in SQLAlchemy 0.4?</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="pooling-toplevel">
<span id="id1"></span><h1>连接池<a class="headerlink" href="#pooling-toplevel" title="Link to this heading">¶</a></h1>
<p>Connection Pooling</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<p>连接池是一种标准技术，用于在内存中维护长时间运行的连接以实现高效重用，并管理应用程序可能同时使用的总连接数。</p>
<p>特别是对于服务器端Web应用程序，连接池是维护内存中活动数据库连接“池(pool)”的标准方法，这些连接在请求之间重用。</p>
<p>SQLAlchemy包括几种连接池实现，它们与 <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> 集成。它们也可以直接用于希望为普通DBAPI方法添加池化的应用程序。</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<p>A connection pool is a standard technique used to maintain
long running connections in memory for efficient re-use,
as well as to provide
management for the total number of connections an application
might use simultaneously.</p>
<p>Particularly for
server-side web applications, a connection pool is the standard way to
maintain a “pool” of active database connections in memory which are
reused across requests.</p>
<p>SQLAlchemy includes several connection pool implementations
which integrate with the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>.  They can also be used
directly for applications that want to add pooling to an otherwise
plain DBAPI approach.</p>
</div>
</div>
<section id="id2">
<h2>连接池配置<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<p>Connection Pool Configuration</p>
<p>The <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> returned by the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> function in most cases has a <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a>
integrated, pre-configured with reasonable pooling defaults.  If
you’re reading this section only to learn how to enable pooling - congratulations!
You’re already done.</p>
<p>The most common <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> tuning parameters can be passed
directly to <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> as keyword arguments:
<code class="docutils literal notranslate"><span class="pre">pool_size</span></code>, <code class="docutils literal notranslate"><span class="pre">max_overflow</span></code>, <code class="docutils literal notranslate"><span class="pre">pool_recycle</span></code> and
<code class="docutils literal notranslate"><span class="pre">pool_timeout</span></code>.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;postgresql+psycopg2://me@localhost/mydb&quot;</span><span class="p">,</span> <span class="n">pool_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">max_overflow</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span></pre></div>
</div>
<p>All SQLAlchemy pool implementations have in common
that none of them “pre create” connections - all implementations wait
until first use before creating a connection.   At that point, if
no additional concurrent checkout requests for more connections
are made, no additional connections are created.   This is why it’s perfectly
fine for <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> to default to using a <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a>
of size five without regard to whether or not the application really needs five connections
queued up - the pool would only grow to that size if the application
actually used five connections concurrently, in which case the usage of a
small pool is an entirely appropriate default behavior.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> class is <strong>not compatible with asyncio</strong>.
When using <a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">create_async_engine</span></code></a> to create an instance of
<a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.AsyncEngine" title="sqlalchemy.ext.asyncio.AsyncEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncEngine</span></code></a>, the <a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool" title="sqlalchemy.pool.AsyncAdaptedQueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncAdaptedQueuePool</span></code></a> class,
which makes use of an asyncio-compatible queue implementation, is used
instead.</p>
</div>
</section>
<section id="pool-switching">
<span id="id3"></span><h2>切换池实现<a class="headerlink" href="#pool-switching" title="Link to this heading">¶</a></h2>
<p>Switching Pool Implementations</p>
<p>The usual way to use a different kind of pool with <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>
is to use the <code class="docutils literal notranslate"><span class="pre">poolclass</span></code> argument.   This argument accepts a class
imported from the <code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool</span></code> module, and handles the details
of building the pool for you.   A common use case here is when
connection pooling is to be disabled, which can be achieved by using
the <a class="reference internal" href="#sqlalchemy.pool.NullPool" title="sqlalchemy.pool.NullPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">NullPool</span></code></a> implementation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.pool</span><span class="w"> </span><span class="kn">import</span> <span class="n">NullPool</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;postgresql+psycopg2://scott:tiger@localhost/test&quot;</span><span class="p">,</span> <span class="n">poolclass</span><span class="o">=</span><span class="n">NullPool</span>
<span class="p">)</span></pre></div>
</div>
</section>
<section id="id4">
<h2>使用自定义连接函数<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h2>
<p>Using a Custom Connection Function</p>
<p>See the section <a class="reference internal" href="engines.html#custom-dbapi-args"><span class="std std-ref">自定义 DBAPI connect() 参数/连接例程</span></a> for a rundown of the various
connection customization routines.</p>
</section>
<section id="id5">
<h2>构建池<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h2>
<p>Constructing a Pool</p>
<p>To use a <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> by itself, the <code class="docutils literal notranslate"><span class="pre">creator</span></code> function is
the only argument that’s required and is passed first, followed
by any additional options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sqlalchemy.pool</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pool</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psycopg2</span>


<span class="k">def</span><span class="w"> </span><span class="nf">getconn</span><span class="p">():</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="s2">&quot;ed&quot;</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">dbname</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>


<span class="n">mypool</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">QueuePool</span><span class="p">(</span><span class="n">getconn</span><span class="p">,</span> <span class="n">max_overflow</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pool_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></pre></div>
</div>
<p>DBAPI connections can then be procured from the pool using the
<a class="reference internal" href="#sqlalchemy.pool.Pool.connect" title="sqlalchemy.pool.Pool.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.connect()</span></code></a> function. The return value of this method is a DBAPI
connection that’s contained within a transparent proxy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># get a connection</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">mypool</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="c1"># use it</span>
<span class="n">cursor_obj</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cursor_obj</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;select foo&quot;</span><span class="p">)</span></pre></div>
</div>
<p>The purpose of the transparent proxy is to intercept the <code class="docutils literal notranslate"><span class="pre">close()</span></code> call,
such that instead of the DBAPI connection being closed, it is returned to the
pool:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;close&quot; the connection.  Returns</span>
<span class="c1"># it to the pool.</span>
<span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre></div>
</div>
<p>The proxy also returns its contained DBAPI connection to the pool when it is
garbage collected, though it’s not deterministic in Python that this occurs
immediately (though it is typical with cPython). This usage is not recommended
however and in particular is not supported with asyncio DBAPI drivers.</p>
</section>
<section id="pool-reset-on-return">
<span id="id6"></span><h2>返回时重置<a class="headerlink" href="#pool-reset-on-return" title="Link to this heading">¶</a></h2>
<p>Reset On Return</p>
<p>The pool includes “reset on return” behavior which will call the <code class="docutils literal notranslate"><span class="pre">rollback()</span></code>
method of the DBAPI connection when the connection is returned to the pool.
This is so that any existing transactional state is removed from the
connection, which includes not just uncommitted data but table and row locks as
well. For most DBAPIs, the call to <code class="docutils literal notranslate"><span class="pre">rollback()</span></code> is inexpensive, and if the
DBAPI has already completed a transaction, the method should be a no-op.</p>
<section id="id7">
<h3>禁用非事务性连接的返回时重置<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>Disabling Reset on Return for non-transactional connections</p>
<p>For very specific cases where this <code class="docutils literal notranslate"><span class="pre">rollback()</span></code> is not useful, such as when
using a connection that is configured for
<a class="reference internal" href="connections.html#dbapi-autocommit-understanding"><span class="std std-ref">autocommit</span></a> or when using a database
that has no ACID capabilities such as the MyISAM engine of MySQL, the
reset-on-return behavior can be disabled, which is typically done for
performance reasons. This can be affected by using the
<a class="reference internal" href="#sqlalchemy.pool.Pool.params.reset_on_return" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.reset_on_return</span></code></a> parameter of <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, which
is also available from <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> as
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_reset_on_return" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_reset_on_return</span></code></a>, passing a value of <code class="docutils literal notranslate"><span class="pre">None</span></code>.
This is illustrated in the example below, in conjunction with the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.isolation_level" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.isolation_level</span></code></a> parameter setting of
<code class="docutils literal notranslate"><span class="pre">AUTOCOMMIT</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">non_acid_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;mysql://scott:tiger@host/db&quot;</span><span class="p">,</span>
    <span class="n">pool_reset_on_return</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">isolation_level</span><span class="o">=</span><span class="s2">&quot;AUTOCOMMIT&quot;</span><span class="p">,</span>
<span class="p">)</span></pre></div>
</div>
<p>The above engine won’t actually perform ROLLBACK when connections are returned
to the pool; since AUTOCOMMIT is enabled, the driver will also not perform
any BEGIN operation.</p>
</section>
<section id="id8">
<h3>自定义返回时重置方案<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<p>Custom Reset-on-Return Schemes</p>
<p>“reset on return” consisting of a single <code class="docutils literal notranslate"><span class="pre">rollback()</span></code> may not be sufficient
for some use cases; in particular, applications which make use of temporary
tables may wish for these tables to be automatically removed on connection
checkin. Some (but notably not all) backends include features that can “reset”
such tables within the scope of a database connection, which may be a desirable
behavior for connection pool reset. Other server resources such as prepared
statement handles and server-side statement caches may persist beyond the
checkin process, which may or may not be desirable, depending on specifics.
Again, some (but again not all) backends may provide for a means of resetting
this state.  The two SQLAlchemy included dialects which are known to have
such reset schemes include Microsoft SQL Server, where an undocumented but
widely known stored procedure called <code class="docutils literal notranslate"><span class="pre">sp_reset_connection</span></code> is often used,
and PostgreSQL, which has a well-documented series of commands including
<code class="docutils literal notranslate"><span class="pre">DISCARD</span></code> <code class="docutils literal notranslate"><span class="pre">RESET</span></code>, <code class="docutils literal notranslate"><span class="pre">DEALLOCATE</span></code>, and <code class="docutils literal notranslate"><span class="pre">UNLISTEN</span></code>.</p>
<p>The following example illustrates how to replace reset on return with the
Microsoft SQL Server <code class="docutils literal notranslate"><span class="pre">sp_reset_connection</span></code> stored procedure, using the
<a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event hook. The
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_reset_on_return" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_reset_on_return</span></code></a> parameter is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>
so that the custom scheme can replace the default behavior completely. The
custom hook implementation calls <code class="docutils literal notranslate"><span class="pre">.rollback()</span></code> in any case, as it’s usually
important that the DBAPI’s own tracking of commit/rollback will remain
consistent with the state of the transaction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>

<span class="n">mssql_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;mssql+pyodbc://scott:tiger^5HHH@mssql2017:1433/test?driver=ODBC+Driver+17+for+SQL+Server&quot;</span><span class="p">,</span>
    <span class="c1"># disable default reset-on-return scheme</span>
    <span class="n">pool_reset_on_return</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">mssql_engine</span><span class="p">,</span> <span class="s2">&quot;reset&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">_reset_mssql</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">reset_state</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">reset_state</span><span class="o">.</span><span class="n">terminate_only</span><span class="p">:</span>
        <span class="n">dbapi_connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;{call sys.sp_reset_connection}&quot;</span><span class="p">)</span>

    <span class="c1"># so that the DBAPI itself knows that the connection has been</span>
    <span class="c1"># reset</span>
    <span class="n">dbapi_connection</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span></pre></div>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 2.0.0b3 版本发生变更: </span>Added additional state arguments to
the <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event and additionally ensured the event
is invoked for all “reset” occurrences, so that it’s appropriate
as a place for custom “reset” handlers.   Previous schemes which
use the <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.checkin" title="sqlalchemy.events.PoolEvents.checkin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkin()</span></code></a> handler remain usable as well.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<ul class="simple">
<li><p><a class="reference internal" href="../dialects/mssql.html#mssql-reset-on-return"><span class="std std-ref">Temporary Table / Resource Reset for Connection Pooling</span></a> - in the <a class="reference internal" href="../dialects/mssql.html#mssql-toplevel"><span class="std std-ref">Microsoft SQL Server</span></a> documentation</p></li>
<li><p><a class="reference internal" href="../dialects/postgresql.html#postgresql-reset-on-return"><span class="std std-ref">Temporary Table / Resource Reset for Connection Pooling</span></a> in the <a class="reference internal" href="../dialects/postgresql.html#postgresql-toplevel"><span class="std std-ref">PostgreSQL</span></a> documentation</p></li>
</ul>
</div>
</section>
<section id="id9">
<h3>记录返回时重置事件<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<p>Logging reset-on-return events</p>
<p>Logging for pool events including reset on return can be set
<code class="docutils literal notranslate"><span class="pre">logging.DEBUG</span></code>
log level along with the <code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool</span></code> logger, or by setting
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.echo_pool" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.echo_pool</span></code></a> to <code class="docutils literal notranslate"><span class="pre">&quot;debug&quot;</span></code> when using
<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://scott:tiger@localhost/test&quot;</span><span class="p">,</span> <span class="n">echo_pool</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span><span class="p">)</span></pre></div>
</div>
<p>The above pool will show verbose logging including reset on return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="go">DEBUG sqlalchemy.pool.impl.QueuePool Created new connection &lt;connection object ...&gt;</span>
<span class="go">DEBUG sqlalchemy.pool.impl.QueuePool Connection &lt;connection object ...&gt; checked out from pool</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="go">DEBUG sqlalchemy.pool.impl.QueuePool Connection &lt;connection object ...&gt; being returned to pool</span>
<span class="go">DEBUG sqlalchemy.pool.impl.QueuePool Connection &lt;connection object ...&gt; rollback-on-return</span></pre></div>
</div>
</section>
</section>
<section id="id10">
<h2>池事件<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<p>Pool Events</p>
<p>Connection pools support an event interface that allows hooks to execute
upon first connect, upon each new connection, and upon checkout and
checkin of connections.   See <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents" title="sqlalchemy.events.PoolEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolEvents</span></code></a> for details.</p>
</section>
<section id="pool-disconnects">
<span id="id11"></span><h2>处理断开连接<a class="headerlink" href="#pool-disconnects" title="Link to this heading">¶</a></h2>
<p>Dealing with Disconnects</p>
<p>The connection pool has the ability to refresh individual connections as well as
its entire set of connections, setting the previously pooled connections as
“invalid”.   A common use case is allow the connection pool to gracefully recover
when the database server has been restarted, and all previously established connections
are no longer functional.   There are two approaches to this.</p>
<section id="pool-disconnects-pessimistic">
<span id="id12"></span><h3>断开连接处理 - 悲观<a class="headerlink" href="#pool-disconnects-pessimistic" title="Link to this heading">¶</a></h3>
<p>Disconnect Handling - Pessimistic</p>
<p>The pessimistic approach refers to emitting a test statement on the SQL
connection at the start of each connection pool checkout, to test
that the database connection is still viable.   The implementation is
dialect-specific, and makes use of either a DBAPI-specific ping method,
or by using a simple SQL statement like “SELECT 1”, in order to test the
connection for liveness.</p>
<p>The approach adds a small bit of overhead to the connection checkout process,
however is otherwise the most simple and reliable approach to completely
eliminating database errors due to stale pooled connections.   The calling
application does not need to be concerned about organizing operations
to be able to recover from stale connections checked out from the pool.</p>
<p>Pessimistic testing of connections upon checkout is achievable by
using the <a class="reference internal" href="#sqlalchemy.pool.Pool.params.pre_ping" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.pre_ping</span></code></a> argument, available from <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>
via the <a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_pre_ping" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_pre_ping</span></code></a> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mysql+pymysql://user:pw@host/db&quot;</span><span class="p">,</span> <span class="n">pool_pre_ping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>The “pre ping” feature operates on a per-dialect basis either by invoking a
DBAPI-specific “ping” method, or if not available will emit SQL equivalent to
“SELECT 1”, catching any errors and detecting the error as a “disconnect”
situation. If the ping / error check determines that the connection is not
usable, the connection will be immediately recycled, and all other pooled
connections older than the current time are invalidated, so that the next time
they are checked out, they will also be recycled before use.</p>
<p>If the database is still not available when “pre ping” runs, then the initial
connect will fail and the error for failure to connect will be propagated
normally.  In the uncommon situation that the database is available for
connections, but is not able to respond to a “ping”, the “pre_ping” will try up
to three times before giving up, propagating the database error last received.</p>
<p>It is critical to note that the pre-ping approach <strong>does not accommodate for
connections dropped in the middle of transactions or other SQL operations</strong>. If
the database becomes unavailable while a transaction is in progress, the
transaction will be lost and the database error will be raised.   While the
<a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> object will detect a “disconnect” situation and
recycle the connection as well as invalidate the rest of the connection pool
when this condition occurs, the individual operation where the exception was
raised will be lost, and it’s up to the application to either abandon the
operation, or retry the whole transaction again.  If the engine is
configured using DBAPI-level autocommit connections, as described at
<a class="reference internal" href="connections.html#dbapi-autocommit"><span class="std std-ref">设置事务隔离级别（包括 DBAPI 自动提交）</span></a>, a connection <strong>may</strong> be reconnected transparently
mid-operation using events.  See the section <a class="reference internal" href="../faq/connections.html#faq-execute-retry"><span class="std std-ref">如何自动“重试”语句执行？</span></a> for
an example.</p>
<p>For dialects that make use of “SELECT 1” and catch errors in order to detect
disconnects, the disconnection test may be augmented for new backend-specific
error messages using the <a class="reference internal" href="events.html#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a> hook.</p>
<section id="ping">
<span id="pool-disconnects-pessimistic-custom"></span><h4>自定义/旧式悲观 Ping<a class="headerlink" href="#ping" title="Link to this heading">¶</a></h4>
<p>Custom / Legacy Pessimistic Ping</p>
<p>Before <a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_pre_ping" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_pre_ping</span></code></a> was added, the “pre-ping”
approach historically has been performed manually using
the <a class="reference internal" href="events.html#sqlalchemy.events.ConnectionEvents.engine_connect" title="sqlalchemy.events.ConnectionEvents.engine_connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ConnectionEvents.engine_connect()</span></code></a> engine event.
The most common recipe for this is below, for reference
purposes in case an application is already using such a recipe, or special
behaviors are needed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">exc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">select</span>

<span class="n">some_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">some_engine</span><span class="p">,</span> <span class="s2">&quot;engine_connect&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">ping_connection</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">branch</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">branch</span><span class="p">:</span>
        <span class="c1"># this parameter is always False as of SQLAlchemy 2.0,</span>
        <span class="c1"># but is still accepted by the event hook.  In 1.x versions</span>
        <span class="c1"># of SQLAlchemy, &quot;branched&quot; connections should be skipped.</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># run a SELECT 1.   use a core select() so that</span>
        <span class="c1"># the SELECT of a scalar value without a table is</span>
        <span class="c1"># appropriately formatted for the backend</span>
        <span class="n">connection</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">except</span> <span class="n">exc</span><span class="o">.</span><span class="n">DBAPIError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="c1"># catch SQLAlchemy&#39;s DBAPIError, which is a wrapper</span>
        <span class="c1"># for the DBAPI&#39;s exception.  It includes a .connection_invalidated</span>
        <span class="c1"># attribute which specifies if this connection is a &quot;disconnect&quot;</span>
        <span class="c1"># condition, which is based on inspection of the original exception</span>
        <span class="c1"># by the dialect in use.</span>
        <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">connection_invalidated</span><span class="p">:</span>
            <span class="c1"># run the same SELECT again - the connection will re-validate</span>
            <span class="c1"># itself and establish a new connection.  The disconnect detection</span>
            <span class="c1"># here also causes the whole connection pool to be invalidated</span>
            <span class="c1"># so that all stale connections are discarded.</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">select</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span></pre></div>
</div>
<p>The above recipe has the advantage that we are making use of SQLAlchemy’s
facilities for detecting those DBAPI exceptions that are known to indicate
a “disconnect” situation, as well as the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> object’s ability
to correctly invalidate the current connection pool when this condition
occurs and allowing the current <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> to re-validate onto
a new DBAPI connection.</p>
</section>
</section>
<section id="id13">
<h3>断开连接处理 - 乐观<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<p>Disconnect Handling - Optimistic</p>
<p>When pessimistic handling is not employed, as well as when the database is
shutdown and/or restarted in the middle of a connection’s period of use within
a transaction, the other approach to dealing with stale / closed connections is
to let SQLAlchemy handle disconnects as  they occur, at which point all
connections in the pool are invalidated, meaning they are assumed to be
stale and will be refreshed upon next checkout.  This behavior assumes the
<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> is used in conjunction with a <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>.
The <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> has logic which can detect
disconnection events and refresh the pool automatically.</p>
<p>When the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> attempts to use a DBAPI connection, and an
exception is raised that corresponds to a “disconnect” event, the connection
is invalidated. The <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> then calls the <a class="reference internal" href="#sqlalchemy.pool.Pool.recreate" title="sqlalchemy.pool.Pool.recreate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a>
method, effectively invalidating all connections not currently checked out so
that they are replaced with new ones upon next checkout.  This flow is
illustrated by the code example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span><span class="p">,</span> <span class="n">exc</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="c1"># suppose the database has been restarted.</span>
    <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM table&quot;</span><span class="p">))</span>
    <span class="n">c</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span> <span class="n">exc</span><span class="o">.</span><span class="n">DBAPIError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="c1"># an exception is raised, Connection is invalidated.</span>
    <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">connection_invalidated</span><span class="p">:</span>
        <span class="n">print</span><span class="p">(</span><span class="s2">&quot;Connection was invalidated!&quot;</span><span class="p">)</span>

<span class="c1"># after the invalidate event, a new connection</span>
<span class="c1"># starts with a new Pool</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM table&quot;</span><span class="p">))</span></pre></div>
</div>
<p>The above example illustrates that no special intervention is needed to
refresh the pool, which continues normally after a disconnection event is
detected.   However, one database exception is raised, per each connection
that is in use while the database unavailability event occurred.
In a typical web application using an ORM Session, the above condition would
correspond to a single request failing with a 500 error, then the web application
continuing normally beyond that.   Hence the approach is “optimistic” in that frequent
database restarts are not anticipated.</p>
<section id="pool-setting-recycle">
<span id="id14"></span><h4>设置池回收<a class="headerlink" href="#pool-setting-recycle" title="Link to this heading">¶</a></h4>
<p>Setting Pool Recycle</p>
<p>An additional setting that can augment the “optimistic” approach is to set the
pool recycle parameter.   This parameter prevents the pool from using a particular
connection that has passed a certain age, and is appropriate for database backends
such as MySQL that automatically close connections that have been stale after a particular
period of time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mysql+mysqldb://scott:tiger@localhost/test&quot;</span><span class="p">,</span> <span class="n">pool_recycle</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span></pre></div>
</div>
<p>Above, any DBAPI connection that has been open for more than one hour will be invalidated and replaced,
upon next checkout.   Note that the invalidation <strong>only</strong> occurs during checkout - not on
any connections that are held in a checked out state.     <code class="docutils literal notranslate"><span class="pre">pool_recycle</span></code> is a function
of the <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> itself, independent of whether or not an <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> is in use.</p>
</section>
</section>
<section id="pool-connection-invalidation">
<span id="id15"></span><h3>更多关于失效的信息<a class="headerlink" href="#pool-connection-invalidation" title="Link to this heading">¶</a></h3>
<p>More on Invalidation</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> provides “connection invalidation” services which allow
both explicit invalidation of a connection as well as automatic invalidation
in response to conditions that are determined to render a connection unusable.</p>
<p>“Invalidation” means that a particular DBAPI connection is removed from the
pool and discarded.  The <code class="docutils literal notranslate"><span class="pre">.close()</span></code> method is called on this connection
if it is not clear that the connection itself might not be closed, however
if this method fails, the exception is logged but the operation still proceeds.</p>
<p>When using a <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>, the <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection.invalidate" title="sqlalchemy.engine.Connection.invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.invalidate()</span></code></a> method is
the usual entrypoint to explicit invalidation.   Other conditions by which
a DBAPI connection might be invalidated include:</p>
<ul class="simple">
<li><p>a DBAPI exception such as <a class="reference internal" href="exceptions.html#sqlalchemy.exc.OperationalError" title="sqlalchemy.exc.OperationalError"><code class="xref py py-class docutils literal notranslate"><span class="pre">OperationalError</span></code></a>, raised when a
method like <code class="docutils literal notranslate"><span class="pre">connection.execute()</span></code> is called, is detected as indicating
a so-called “disconnect” condition.   As the Python DBAPI provides no
standard system for determining the nature of an exception, all SQLAlchemy
dialects include a system called <code class="docutils literal notranslate"><span class="pre">is_disconnect()</span></code> which will examine
the contents of an exception object, including the string message and
any potential error codes included with it, in order to determine if this
exception indicates that the connection is no longer usable.  If this is the
case, the <code class="xref py py-meth docutils literal notranslate"><span class="pre">_ConnectionFairy.invalidate()</span></code> method is called and the
DBAPI connection is then discarded.</p></li>
<li><p>When the connection is returned to the pool, and
calling the <code class="docutils literal notranslate"><span class="pre">connection.rollback()</span></code> or <code class="docutils literal notranslate"><span class="pre">connection.commit()</span></code> methods,
as dictated by the pool’s “reset on return” behavior, throws an exception.
A final attempt at calling <code class="docutils literal notranslate"><span class="pre">.close()</span></code> on the connection will be made,
and it is then discarded.</p></li>
<li><p>When a listener implementing <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a> raises the
<a class="reference internal" href="exceptions.html#sqlalchemy.exc.DisconnectionError" title="sqlalchemy.exc.DisconnectionError"><code class="xref py py-class docutils literal notranslate"><span class="pre">DisconnectionError</span></code></a> exception, indicating that the connection
won’t be usable and a new connection attempt needs to be made.</p></li>
</ul>
<p>All invalidations which occur will invoke the <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.invalidate" title="sqlalchemy.events.PoolEvents.invalidate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.invalidate()</span></code></a>
event.</p>
</section>
<section id="pool-new-disconnect-codes">
<span id="id16"></span><h3>支持断开连接场景的新数据库错误代码<a class="headerlink" href="#pool-new-disconnect-codes" title="Link to this heading">¶</a></h3>
<p>Supporting new database error codes for disconnect scenarios</p>
<p>SQLAlchemy dialects each include a routine called <code class="docutils literal notranslate"><span class="pre">is_disconnect()</span></code> that is
invoked whenever a DBAPI exception is encountered. The DBAPI exception object
is passed to this method, where dialect-specific heuristics will then determine
if the error code received indicates that the database connection has been
“disconnected”, or is in an otherwise unusable state which indicates it should
be recycled. The heuristics applied here may be customized using the
<a class="reference internal" href="events.html#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a> event hook, which is typically
established via the owning <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> object. Using this hook, all
errors which occur are delivered passing along a contextual object known as
<a class="reference internal" href="connections.html#sqlalchemy.engine.ExceptionContext" title="sqlalchemy.engine.ExceptionContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">ExceptionContext</span></code></a>. Custom event hooks may control whether or not a
particular error should be considered a “disconnect” situation or not, as well
as if this disconnect should cause the entire connection pool to be invalidated
or not.</p>
<p>For example, to add support to consider the Oracle Database driver error codes
<code class="docutils literal notranslate"><span class="pre">DPY-1001</span></code> and <code class="docutils literal notranslate"><span class="pre">DPY-4011</span></code> to be handled as disconnect codes, apply an event
handler to the engine after creation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_engine</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span>
    <span class="s2">&quot;oracle+oracledb://scott:tiger@localhost:1521?service_name=freepdb1&quot;</span>
<span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;handle_error&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">handle_exception</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">ExceptionContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">context</span><span class="o">.</span><span class="n">is_disconnect</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
        <span class="sa">r</span><span class="s2">&quot;^(?:DPY-1001|DPY-4011)&quot;</span><span class="p">,</span> <span class="n">str</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">original_exception</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">context</span><span class="o">.</span><span class="n">is_disconnect</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="kc">None</span></pre></div>
</div>
<p>The above error processing function will be invoked for all Oracle Database
errors raised, including those caught when using the <a class="reference internal" href="#pool-disconnects-pessimistic"><span class="std std-ref">pool pre ping</span></a> feature for those backends that rely upon
disconnect error handling (new in 2.0).</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="events.html#sqlalchemy.events.DialectEvents.handle_error" title="sqlalchemy.events.DialectEvents.handle_error"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DialectEvents.handle_error()</span></code></a></p>
</div>
</section>
</section>
<section id="fifo-lifo">
<span id="pool-use-lifo"></span><h2>使用 FIFO 与 LIFO<a class="headerlink" href="#fifo-lifo" title="Link to this heading">¶</a></h2>
<p>Using FIFO vs. LIFO</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> class features a flag called
<a class="reference internal" href="#sqlalchemy.pool.QueuePool.params.use_lifo" title="sqlalchemy.pool.QueuePool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">QueuePool.use_lifo</span></code></a>, which can also be accessed from
<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> via the flag <a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_use_lifo" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_use_lifo</span></code></a>.
Setting this flag to <code class="docutils literal notranslate"><span class="pre">True</span></code> causes the pool’s “queue” behavior to instead be
that of a “stack”, e.g. the last connection to be returned to the pool is the
first one to be used on the next request. In contrast to the pool’s long-
standing behavior of first-in-first-out, which produces a round-robin effect of
using each connection in the pool in series, lifo mode allows excess
connections to remain idle in the pool, allowing server-side timeout schemes to
close these connections out.   The difference between FIFO and LIFO is
basically whether or not its desirable for the pool to keep a full set of
connections ready to go even during idle periods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;postgresql://&quot;</span><span class="p">,</span> <span class="n">pool_use_lifo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pool_pre_ping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
</div>
<p>Above, we also make use of the <a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_pre_ping" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_pre_ping</span></code></a> flag
so that connections which are closed from the server side are gracefully
handled by the connection pool and replaced with a new connection.</p>
<p>Note that the flag only applies to <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> use.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#pool-disconnects"><span class="std std-ref">处理断开连接</span></a></p>
</div>
</section>
<section id="os-fork">
<span id="pooling-multiprocessing"></span><h2>使用具有多处理或 os.fork() 的连接池<a class="headerlink" href="#os-fork" title="Link to this heading">¶</a></h2>
<p>Using Connection Pools with Multiprocessing or os.fork()</p>
<p>It’s critical that when using a connection pool, and by extension when
using an <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> created via <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a>, that
the pooled connections <strong>are not shared to a forked process</strong>.  TCP connections
are represented as file descriptors, which usually work across process
boundaries, meaning this will cause concurrent access to the file descriptor
on behalf of two or more entirely independent Python interpreter states.</p>
<p>Depending on specifics of the driver and OS, the issues that arise here range
from non-working connections to socket connections that are used by multiple
processes concurrently, leading to broken messaging (the latter case is
typically the most common).</p>
<p>The SQLAlchemy <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> object refers to a connection pool of existing
database connections.  So when this object is replicated to a child process,
the goal is to ensure that no database connections are carried over.  There
are four general approaches to this:</p>
<ol class="arabic">
<li><p>Disable pooling using <a class="reference internal" href="#sqlalchemy.pool.NullPool" title="sqlalchemy.pool.NullPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">NullPool</span></code></a>.  This is the most simplistic,
one shot system that prevents the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> from using any connection
more than once:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy.pool</span><span class="w"> </span><span class="kn">import</span> <span class="n">NullPool</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mysql+mysqldb://user:pass@host/dbname&quot;</span><span class="p">,</span> <span class="n">poolclass</span><span class="o">=</span><span class="n">NullPool</span><span class="p">)</span></pre></div>
</div>
</li>
<li><p>Call <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.dispose()</span></code></a> on any given <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>,
passing the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose.params.close" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Engine.dispose.close</span></code></a> parameter with a value of
<code class="docutils literal notranslate"><span class="pre">False</span></code>, within the initialize phase of the child process.  This is
so that the new process will not touch any of the parent process’ connections
and will instead start with new connections.
<strong>This is the recommended approach</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pool</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mysql+mysqldb://user:pass@host/dbname&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_in_process</span><span class="p">(</span><span class="n">some_data_record</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">initializer</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ensure the parent proc&#39;s database connections are not touched</span>
<span class="sd">    in the new connection pool&quot;&quot;&quot;</span>
    <span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">(</span><span class="n">close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">initializer</span><span class="o">=</span><span class="n">initializer</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
    <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">run_in_process</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4.33 版本加入: </span>Added the <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose.params.close" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Engine.dispose.close</span></code></a>
parameter to allow the replacement of a connection pool in a child
process without interfering with the connections used by the parent
process.</p>
</div>
</li>
<li><p>Call <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine.dispose" title="sqlalchemy.engine.Engine.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Engine.dispose()</span></code></a> <strong>directly before</strong> the child process is
created.  This will also cause the child process to start with a new
connection pool, while ensuring the parent connections are not transferred
to the child process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;mysql://user:pass@host/dbname&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">run_in_process</span><span class="p">():</span>
    <span class="k">with</span> <span class="n">engine</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="k">as</span> <span class="n">conn</span><span class="p">:</span>
        <span class="n">conn</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">text</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">))</span>


<span class="c1"># before process starts, ensure engine.dispose() is called</span>
<span class="n">engine</span><span class="o">.</span><span class="n">dispose</span><span class="p">()</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run_in_process</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span></pre></div>
</div>
</li>
<li><p>An event handler can be applied to the connection pool that tests for
connections being shared across process boundaries, and invalidates them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">event</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">exc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="n">engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="s2">&quot;...&quot;</span><span class="p">)</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;connect&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">):</span>
    <span class="n">connection_record</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;pid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span>


<span class="nd">@event</span><span class="o">.</span><span class="n">listens_for</span><span class="p">(</span><span class="n">engine</span><span class="p">,</span> <span class="s2">&quot;checkout&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">checkout</span><span class="p">(</span><span class="n">dbapi_connection</span><span class="p">,</span> <span class="n">connection_record</span><span class="p">,</span> <span class="n">connection_proxy</span><span class="p">):</span>
    <span class="n">pid</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getpid</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">connection_record</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;pid&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">pid</span><span class="p">:</span>
        <span class="n">connection_record</span><span class="o">.</span><span class="n">dbapi_connection</span> <span class="o">=</span> <span class="n">connection_proxy</span><span class="o">.</span><span class="n">dbapi_connection</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">raise</span> <span class="n">exc</span><span class="o">.</span><span class="n">DisconnectionError</span><span class="p">(</span>
            <span class="s2">&quot;Connection record belongs to pid </span><span class="si">%s</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;attempting to check out in pid </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">connection_record</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s2">&quot;pid&quot;</span><span class="p">],</span> <span class="n">pid</span><span class="p">)</span>
        <span class="p">)</span></pre></div>
</div>
<p>Above, we use an approach similar to that described in
<a class="reference internal" href="#pool-disconnects-pessimistic"><span class="std std-ref">断开连接处理 - 悲观</span></a> to treat a DBAPI connection that
originated in a different parent process as an “invalid” connection,
coercing the pool to recycle the connection record to make a new connection.</p>
</li>
</ol>
<p>The above strategies will accommodate the case of an <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a>
being shared among processes. The above steps alone are not sufficient for the
case of sharing a specific <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> over a process boundary;
prefer to keep the scope of a particular <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a> local to a
single process (and thread). It’s additionally not supported to share any kind
of ongoing transactional state directly across a process boundary, such as an
ORM <a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> object that’s begun a transaction and references
active <code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code> instances; again prefer to create new
<a class="reference internal" href="../orm/session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> objects in new processes.</p>
</section>
<section id="id17">
<h2>直接使用池实例<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h2>
<p>Using a pool instance directly</p>
<p>A pool implementation can be used directly without an engine. This could be used
in applications that just wish to use the pool behavior without all other
SQLAlchemy features.
In the example below the default pool for the <code class="docutils literal notranslate"><span class="pre">MySQLdb</span></code> dialect is obtained using
<a class="reference internal" href="engines.html#sqlalchemy.create_pool_from_url" title="sqlalchemy.create_pool_from_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_pool_from_url()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pool_from_url</span>

<span class="n">my_pool</span> <span class="o">=</span> <span class="n">create_pool_from_url</span><span class="p">(</span>
    <span class="s2">&quot;mysql+mysqldb://&quot;</span><span class="p">,</span> <span class="n">max_overflow</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pool_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pre_ping</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">con</span> <span class="o">=</span> <span class="n">my_pool</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="c1"># use the connection</span>
<span class="o">...</span>
<span class="c1"># then close it</span>
<span class="n">con</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></pre></div>
</div>
<p>If the type of pool to create is not specified, the default one for the dialect
will be used. To specify it directly the <code class="docutils literal notranslate"><span class="pre">poolclass</span></code> argument can be used,
like in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_pool_from_url</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sqlalchemy</span><span class="w"> </span><span class="kn">import</span> <span class="n">NullPool</span>

<span class="n">my_pool</span> <span class="o">=</span> <span class="n">create_pool_from_url</span><span class="p">(</span><span class="s2">&quot;mysql+mysqldb://&quot;</span><span class="p">,</span> <span class="n">poolclass</span><span class="o">=</span><span class="n">NullPool</span><span class="p">)</span></pre></div>
</div>
</section>
<section id="api">
<span id="pool-api"></span><h2>API 文档 - 可用的池实现<a class="headerlink" href="#api" title="Link to this heading">¶</a></h2>
<p>API Documentation - Available Pool Implementations</p>
<div class="table-wrapper longtable docutils container">
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool._ConnectionFairy"><span class="sig-name descname">_ConnectionFairy</span></a></p></td>
<td><p>Proxies a DBAPI connection and provides return-on-dereference
support.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool._ConnectionRecord"><span class="sig-name descname">_ConnectionRecord</span></a></p></td>
<td><p>Maintains a position in a connection pool which references a pooled
connection.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.AssertionPool"><span class="sig-name descname">AssertionPool</span></a></p></td>
<td><p>A <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> that allows at most one checked out connection at
any given time.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool"><span class="sig-name descname">AsyncAdaptedQueuePool</span></a></p></td>
<td><p>An asyncio-compatible version of <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><span class="sig-name descname">ConnectionPoolEntry</span></a></p></td>
<td><p>Interface for the object that maintains an individual database
connection on behalf of a <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> instance.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><span class="sig-name descname">ManagesConnection</span></a></p></td>
<td><p>Common base for the two connection-management interfaces
<a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> and <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.NullPool"><span class="sig-name descname">NullPool</span></a></p></td>
<td><p>A Pool which does not pool connections.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.Pool"><span class="sig-name descname">Pool</span></a></p></td>
<td><p>Abstract base class for connection pools.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><span class="sig-name descname">PoolProxiedConnection</span></a></p></td>
<td><p>A connection-like adapter for a <span class="target" id="index-4"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> DBAPI connection, which
includes additional methods specific to the <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> implementation.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.QueuePool"><span class="sig-name descname">QueuePool</span></a></p></td>
<td><p>A <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>
that imposes a limit on the number of open connections.</p></td>
</tr>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool"><span class="sig-name descname">SingletonThreadPool</span></a></p></td>
<td><p>A Pool that maintains one connection per thread.</p></td>
</tr>
<tr class="row-odd"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.pool.StaticPool"><span class="sig-name descname">StaticPool</span></a></p></td>
<td><p>A Pool of exactly one connection, used for all requests.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.Pool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">Pool</span></span><a class="headerlink" href="#sqlalchemy.pool.Pool" title="Link to this definition">¶</a></dt>
<dd><p>Abstract base class for connection pools.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.__init__"><span class="sig-name descname">__init__()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.Pool.connect"><span class="sig-name descname">connect()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.Pool.dispose"><span class="sig-name descname">dispose()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.Pool.recreate"><span class="sig-name descname">recreate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.Pool.status"><span class="sig-name descname">status()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.Pool</span></code></a> (<a class="reference internal" href="internals.html#sqlalchemy.log.Identified" title="sqlalchemy.log.Identified"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.log.Identified</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.registry.EventTarget</span></code>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.Pool.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.Pool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.Pool.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">creator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_CreatorFnType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_CreatorWRecFnType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recycle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">echo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">log._EchoFlagType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_on_return</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ResetStyleArgType</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">events</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Tuple" title="sqlalchemy.sql.expression.Tuple"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ListenerFnType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dialect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ConnDialect</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><span class="pre">Dialect</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pre_ping</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_dispatch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_DispatchCommon</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><span class="pre">Pool</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.pool.Pool.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a Pool.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.creator"></span><strong>creator</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.creator">¶</a> – a callable function that returns a DB-API
connection object.  The function will be called with
parameters.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.recycle"></span><strong>recycle</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.recycle">¶</a> – If set to a value other than -1, number of
seconds between connection recycling, which means upon
checkout, if this timeout is surpassed the connection will be
closed and replaced with a newly opened connection. Defaults to -1.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.logging_name"></span><strong>logging_name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.logging_name">¶</a> – String identifier which will be used within
the “name” field of logging records generated within the
“sqlalchemy.pool” logger. Defaults to a hexstring of the object’s
id.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.echo"></span><strong>echo</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.echo">¶</a> – <p>if True, the connection pool will log
informational output such as when connections are invalidated
as well as when connections are recycled to the default log handler,
which defaults to <code class="docutils literal notranslate"><span class="pre">sys.stdout</span></code> for output..   If set to the string
<code class="docutils literal notranslate"><span class="pre">&quot;debug&quot;</span></code>, the logging will include pool checkouts and checkins.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.Pool.params.echo" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.echo</span></code></a> parameter can also be set from the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> call by using the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.echo_pool" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.echo_pool</span></code></a> parameter.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="engines.html#dbengine-logging"><span class="std std-ref">配置日志记录</span></a> - further detail on how to configure
logging.</p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.reset_on_return"></span><strong>reset_on_return</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.reset_on_return">¶</a> – <p>Determine steps to take on
connections as they are returned to the pool, which were
not otherwise handled by a <a class="reference internal" href="connections.html#sqlalchemy.engine.Connection" title="sqlalchemy.engine.Connection"><code class="xref py py-class docutils literal notranslate"><span class="pre">Connection</span></code></a>.
Available from <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> via the
<a class="reference internal" href="engines.html#sqlalchemy.create_engine.params.pool_reset_on_return" title="sqlalchemy.create_engine"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">create_engine.pool_reset_on_return</span></code></a> parameter.</p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.params.reset_on_return" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.reset_on_return</span></code></a> can have any of these values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;rollback&quot;</span></code> - call rollback() on the connection,
to release locks and transaction resources.
This is the default value.  The vast majority
of use cases should leave this value set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;commit&quot;</span></code> - call commit() on the connection,
to release locks and transaction resources.
A commit here may be desirable for databases that
cache query plans if a commit is emitted,
such as Microsoft SQL Server.  However, this
value is more dangerous than ‘rollback’ because
any data changes present on the transaction
are committed unconditionally.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - don’t do anything on the connection.
This setting may be appropriate if the database / DBAPI
works in pure “autocommit” mode at all times, or if
a custom reset handler is established using the
<a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event handler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">True</span></code> - same as ‘rollback’, this is here for
backwards compatibility.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">False</span></code> - same as None, this is here for
backwards compatibility.</p></li>
</ul>
<p>For further customization of reset on return, the
<a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a> event hook may be used which can perform
any connection activity desired on reset.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#pool-reset-on-return"><span class="std std-ref">返回时重置</span></a></p>
<p><a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.reset" title="sqlalchemy.events.PoolEvents.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.reset()</span></code></a></p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.events"></span><strong>events</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.events">¶</a> – a list of 2-tuples, each of the form
<code class="docutils literal notranslate"><span class="pre">(callable,</span> <span class="pre">target)</span></code> which will be passed to <a class="reference internal" href="event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a>
upon construction.   Provided here so that event listeners
can be assigned via <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> before dialect-level
listeners are applied.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.dialect"></span><strong>dialect</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.dialect">¶</a> – a <a class="reference internal" href="internals.html#sqlalchemy.engine.Dialect" title="sqlalchemy.engine.Dialect"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dialect</span></code></a> that will handle the job
of calling rollback(), close(), or commit() on DBAPI connections.
If omitted, a built-in “stub” dialect is used.   Applications that
make use of <a class="reference internal" href="engines.html#sqlalchemy.create_engine" title="sqlalchemy.create_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_engine()</span></code></a> should not use this parameter
as it is handled by the engine creation strategy.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.Pool.params.pre_ping"></span><strong>pre_ping</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.Pool.params.pre_ping">¶</a> – if True, the pool will emit a “ping” (typically
“SELECT 1”, but is dialect-specific) on the connection
upon checkout, to test if the connection is alive or not.   If not,
the connection is transparently re-connected and upon success, all
other pooled connections established prior to that timestamp are
invalidated.     Requires that a dialect is passed as well to
interpret the disconnection error.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.Pool.connect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.Pool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.Pool.</span></code></a><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.base.PoolProxiedConnection"><span class="pre">PoolProxiedConnection</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.Pool.connect" title="Link to this definition">¶</a></dt>
<dd><p>Return a DBAPI connection from the pool.</p>
<p>The connection is instrumented such that when its
<code class="docutils literal notranslate"><span class="pre">close()</span></code> method is called, the connection will be returned to
the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.Pool.dispose">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.Pool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.Pool.</span></code></a><span class="sig-name descname"><span class="pre">dispose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.Pool.dispose" title="Link to this definition">¶</a></dt>
<dd><p>Dispose of this pool.</p>
<p>This method leaves the possibility of checked-out connections
remaining open, as it only affects connections that are
idle in the pool.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.recreate" title="sqlalchemy.pool.Pool.recreate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.Pool.recreate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.Pool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.Pool.</span></code></a><span class="sig-name descname"><span class="pre">recreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.base.Pool"><span class="pre">Pool</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.Pool.recreate" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, of the same class as this one
and configured with identical creation arguments.</p>
<p>This method is used in conjunction with <a class="reference internal" href="#sqlalchemy.pool.Pool.dispose" title="sqlalchemy.pool.Pool.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dispose()</span></code></a>
to close out an entire <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> and create a new one in
its place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.Pool.status">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.Pool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.Pool.</span></code></a><span class="sig-name descname"><span class="pre">status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sqlalchemy.pool.Pool.status" title="Link to this definition">¶</a></dt>
<dd><p>Returns a brief description of the state of this pool.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.QueuePool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">QueuePool</span></span><a class="headerlink" href="#sqlalchemy.pool.QueuePool" title="Link to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>
that imposes a limit on the number of open connections.</p>
<p><a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> is the default pooling implementation used for
all <a class="reference internal" href="connections.html#sqlalchemy.engine.Engine" title="sqlalchemy.engine.Engine"><code class="xref py py-class docutils literal notranslate"><span class="pre">Engine</span></code></a> objects other than SQLite with a <code class="docutils literal notranslate"><span class="pre">:memory:</span></code>
database.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a> class <strong>is not compatible</strong> with asyncio and
<a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>.  The
<a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool" title="sqlalchemy.pool.AsyncAdaptedQueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncAdaptedQueuePool</span></code></a> class is used automatically when
using <a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>, if no other kind of pool
is specified.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool" title="sqlalchemy.pool.AsyncAdaptedQueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncAdaptedQueuePool</span></code></a></p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.QueuePool.__init__"><span class="sig-name descname">__init__()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.QueuePool.dispose"><span class="sig-name descname">dispose()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.QueuePool.recreate"><span class="sig-name descname">recreate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.QueuePool.status"><span class="sig-name descname">status()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.QueuePool</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.base.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.Pool</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.QueuePool.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.QueuePool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.QueuePool.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">creator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_CreatorFnType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_CreatorWRecFnType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pool_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_overflow</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lifo</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.pool.QueuePool.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a QueuePool.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.pool.QueuePool.params.creator"></span><strong>creator</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.QueuePool.params.creator">¶</a> – a callable function that returns a DB-API
connection object, same as that of <a class="reference internal" href="#sqlalchemy.pool.Pool.params.creator" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.creator</span></code></a>.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.QueuePool.params.pool_size"></span><strong>pool_size</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.QueuePool.params.pool_size">¶</a> – The size of the pool to be maintained,
defaults to 5. This is the largest number of connections that
will be kept persistently in the pool. Note that the pool
begins with no connections; once this number of connections
is requested, that number of connections will remain.
<code class="docutils literal notranslate"><span class="pre">pool_size</span></code> can be set to 0 to indicate no size limit; to
disable pooling, use a <a class="reference internal" href="#sqlalchemy.pool.NullPool" title="sqlalchemy.pool.NullPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">NullPool</span></code></a>
instead.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.QueuePool.params.max_overflow"></span><strong>max_overflow</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.QueuePool.params.max_overflow">¶</a> – The maximum overflow size of the
pool. When the number of checked-out connections reaches the
size set in pool_size, additional connections will be
returned up to this limit. When those additional connections
are returned to the pool, they are disconnected and
discarded. It follows then that the total number of
simultaneous connections the pool will allow is pool_size +
<cite>max_overflow</cite>, and the total number of “sleeping”
connections the pool will allow is pool_size. <cite>max_overflow</cite>
can be set to -1 to indicate no overflow limit; no limit
will be placed on the total number of concurrent
connections. Defaults to 10.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.QueuePool.params.timeout"></span><strong>timeout</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.QueuePool.params.timeout">¶</a> – The number of seconds to wait before giving up
on returning a connection. Defaults to 30.0. This can be a float
but is subject to the limitations of Python time functions which
may not be reliable in the tens of milliseconds.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.QueuePool.params.use_lifo"></span><strong>use_lifo</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.QueuePool.params.use_lifo">¶</a> – <p>use LIFO (last-in-first-out) when retrieving
connections instead of FIFO (first-in-first-out). Using LIFO, a
server-side timeout scheme can reduce the number of connections used
during non-peak periods of use.   When planning for server-side
timeouts, ensure that a recycle or pre-ping strategy is in use to
gracefully handle stale connections.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#pool-use-lifo"><span class="std std-ref">使用 FIFO 与 LIFO</span></a></p>
<p><a class="reference internal" href="#pool-disconnects"><span class="std std-ref">处理断开连接</span></a></p>
</div>
</p></li>
<li><p><span class="target" id="sqlalchemy.pool.QueuePool.params.**kw"></span><strong>**kw</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.QueuePool.params.**kw">¶</a> – Other keyword arguments including
<a class="reference internal" href="#sqlalchemy.pool.Pool.params.recycle" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.recycle</span></code></a>, <a class="reference internal" href="#sqlalchemy.pool.Pool.params.echo" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.echo</span></code></a>,
<a class="reference internal" href="#sqlalchemy.pool.Pool.params.reset_on_return" title="sqlalchemy.pool.Pool"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Pool.reset_on_return</span></code></a> and others are passed to the
<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> constructor.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.QueuePool.dispose">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.QueuePool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.QueuePool.</span></code></a><span class="sig-name descname"><span class="pre">dispose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.QueuePool.dispose" title="Link to this definition">¶</a></dt>
<dd><p>Dispose of this pool.</p>
<p>This method leaves the possibility of checked-out connections
remaining open, as it only affects connections that are
idle in the pool.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.recreate" title="sqlalchemy.pool.Pool.recreate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.QueuePool.recreate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.QueuePool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.QueuePool.</span></code></a><span class="sig-name descname"><span class="pre">recreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.impl.QueuePool"><span class="pre">QueuePool</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.QueuePool.recreate" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, of the same class as this one
and configured with identical creation arguments.</p>
<p>This method is used in conjunction with <a class="reference internal" href="#sqlalchemy.pool.QueuePool.dispose" title="sqlalchemy.pool.QueuePool.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dispose()</span></code></a>
to close out an entire <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> and create a new one in
its place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.QueuePool.status">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.QueuePool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.QueuePool.</span></code></a><span class="sig-name descname"><span class="pre">status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sqlalchemy.pool.QueuePool.status" title="Link to this definition">¶</a></dt>
<dd><p>Returns a brief description of the state of this pool.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.AsyncAdaptedQueuePool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">AsyncAdaptedQueuePool</span></span><a class="headerlink" href="#sqlalchemy.pool.AsyncAdaptedQueuePool" title="Link to this definition">¶</a></dt>
<dd><p>An asyncio-compatible version of <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a>.</p>
<p>This pool is used by default when using <a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.AsyncEngine" title="sqlalchemy.ext.asyncio.AsyncEngine"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncEngine</span></code></a> engines that
were generated from <a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>.   It uses an
asyncio-compatible queue implementation that does not use
<code class="docutils literal notranslate"><span class="pre">threading.Lock</span></code>.</p>
<p>The arguments and operation of <a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool" title="sqlalchemy.pool.AsyncAdaptedQueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsyncAdaptedQueuePool</span></code></a> are
otherwise identical to that of <a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueuePool</span></code></a>.</p>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool" title="sqlalchemy.pool.AsyncAdaptedQueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.AsyncAdaptedQueuePool</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.QueuePool" title="sqlalchemy.pool.impl.QueuePool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.impl.QueuePool</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.SingletonThreadPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">SingletonThreadPool</span></span><a class="headerlink" href="#sqlalchemy.pool.SingletonThreadPool" title="Link to this definition">¶</a></dt>
<dd><p>A Pool that maintains one connection per thread.</p>
<p>Maintains one connection per each thread, never moving a connection to a
thread other than the one which it was created in.</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>the <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a> will call <code class="docutils literal notranslate"><span class="pre">.close()</span></code>
on arbitrary connections that exist beyond the size setting of
<code class="docutils literal notranslate"><span class="pre">pool_size</span></code>, e.g. if more unique <strong>thread identities</strong>
than what <code class="docutils literal notranslate"><span class="pre">pool_size</span></code> states are used.   This cleanup is
non-deterministic and not sensitive to whether or not the connections
linked to those thread identities are currently in use.</p>
<p><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a> may be improved in a future release,
however in its current status it is generally used only for test
scenarios using a SQLite <code class="docutils literal notranslate"><span class="pre">:memory:</span></code> database and is not recommended
for production use.</p>
</div>
<p>The <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a> class <strong>is not compatible</strong> with asyncio
and <a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>.</p>
<p>Options are the same as those of <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, as well as:</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.pool.SingletonThreadPool.params.pool_size"></span><strong>pool_size</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.SingletonThreadPool.params.pool_size">¶</a> – The number of threads in which to maintain connections
at once.  Defaults to five.</p>
</dd>
</dl>
<p><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a> is used by the SQLite dialect
automatically when a memory-based database is used.
See <a class="reference internal" href="../dialects/sqlite.html#sqlite-toplevel"><span class="std std-ref">SQLite</span></a>.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.connect"><span class="sig-name descname">connect()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.dispose"><span class="sig-name descname">dispose()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.recreate"><span class="sig-name descname">recreate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.status"><span class="sig-name descname">status()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.SingletonThreadPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.SingletonThreadPool</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.base.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.Pool</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.SingletonThreadPool.connect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.SingletonThreadPool.</span></code></a><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.base.PoolProxiedConnection"><span class="pre">PoolProxiedConnection</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.SingletonThreadPool.connect" title="Link to this definition">¶</a></dt>
<dd><p>Return a DBAPI connection from the pool.</p>
<p>The connection is instrumented such that when its
<code class="docutils literal notranslate"><span class="pre">close()</span></code> method is called, the connection will be returned to
the pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.SingletonThreadPool.dispose">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.SingletonThreadPool.</span></code></a><span class="sig-name descname"><span class="pre">dispose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.SingletonThreadPool.dispose" title="Link to this definition">¶</a></dt>
<dd><p>Dispose of this pool.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.SingletonThreadPool.recreate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.SingletonThreadPool.</span></code></a><span class="sig-name descname"><span class="pre">recreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool" title="sqlalchemy.pool.impl.SingletonThreadPool"><span class="pre">SingletonThreadPool</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.SingletonThreadPool.recreate" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, of the same class as this one
and configured with identical creation arguments.</p>
<p>This method is used in conjunction with <a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.dispose" title="sqlalchemy.pool.SingletonThreadPool.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dispose()</span></code></a>
to close out an entire <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> and create a new one in
its place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.SingletonThreadPool.status">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.SingletonThreadPool.</span></code></a><span class="sig-name descname"><span class="pre">status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sqlalchemy.pool.SingletonThreadPool.status" title="Link to this definition">¶</a></dt>
<dd><p>Returns a brief description of the state of this pool.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.AssertionPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">AssertionPool</span></span><a class="headerlink" href="#sqlalchemy.pool.AssertionPool" title="Link to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> that allows at most one checked out connection at
any given time.</p>
<p>This will raise an exception if more than one connection is checked out
at a time.  Useful for debugging code that is using more connections
than desired.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.AssertionPool" title="sqlalchemy.pool.AssertionPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">AssertionPool</span></code></a> class <strong>is compatible</strong> with asyncio and
<a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.AssertionPool.dispose"><span class="sig-name descname">dispose()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.AssertionPool.recreate"><span class="sig-name descname">recreate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.AssertionPool.status"><span class="sig-name descname">status()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.AssertionPool" title="sqlalchemy.pool.AssertionPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.AssertionPool</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.base.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.Pool</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.AssertionPool.dispose">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.AssertionPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.AssertionPool.</span></code></a><span class="sig-name descname"><span class="pre">dispose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.AssertionPool.dispose" title="Link to this definition">¶</a></dt>
<dd><p>Dispose of this pool.</p>
<p>This method leaves the possibility of checked-out connections
remaining open, as it only affects connections that are
idle in the pool.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.recreate" title="sqlalchemy.pool.Pool.recreate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.AssertionPool.recreate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.AssertionPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.AssertionPool.</span></code></a><span class="sig-name descname"><span class="pre">recreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.AssertionPool" title="sqlalchemy.pool.impl.AssertionPool"><span class="pre">AssertionPool</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.AssertionPool.recreate" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, of the same class as this one
and configured with identical creation arguments.</p>
<p>This method is used in conjunction with <a class="reference internal" href="#sqlalchemy.pool.AssertionPool.dispose" title="sqlalchemy.pool.AssertionPool.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dispose()</span></code></a>
to close out an entire <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> and create a new one in
its place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.AssertionPool.status">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.AssertionPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.AssertionPool.</span></code></a><span class="sig-name descname"><span class="pre">status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sqlalchemy.pool.AssertionPool.status" title="Link to this definition">¶</a></dt>
<dd><p>Returns a brief description of the state of this pool.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.NullPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">NullPool</span></span><a class="headerlink" href="#sqlalchemy.pool.NullPool" title="Link to this definition">¶</a></dt>
<dd><p>A Pool which does not pool connections.</p>
<p>Instead it literally opens and closes the underlying DB-API connection
per each connection open/close.</p>
<p>Reconnect-related functions such as <code class="docutils literal notranslate"><span class="pre">recycle</span></code> and connection
invalidation are not supported by this Pool implementation, since
no connections are held persistently.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.NullPool" title="sqlalchemy.pool.NullPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">NullPool</span></code></a> class <strong>is compatible</strong> with asyncio and
<a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.NullPool.dispose"><span class="sig-name descname">dispose()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.NullPool.recreate"><span class="sig-name descname">recreate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.NullPool.status"><span class="sig-name descname">status()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.NullPool" title="sqlalchemy.pool.NullPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.NullPool</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.base.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.Pool</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.NullPool.dispose">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.NullPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.NullPool.</span></code></a><span class="sig-name descname"><span class="pre">dispose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.NullPool.dispose" title="Link to this definition">¶</a></dt>
<dd><p>Dispose of this pool.</p>
<p>This method leaves the possibility of checked-out connections
remaining open, as it only affects connections that are
idle in the pool.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.recreate" title="sqlalchemy.pool.Pool.recreate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.NullPool.recreate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.NullPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.NullPool.</span></code></a><span class="sig-name descname"><span class="pre">recreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.NullPool" title="sqlalchemy.pool.impl.NullPool"><span class="pre">NullPool</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.NullPool.recreate" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, of the same class as this one
and configured with identical creation arguments.</p>
<p>This method is used in conjunction with <a class="reference internal" href="#sqlalchemy.pool.NullPool.dispose" title="sqlalchemy.pool.NullPool.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dispose()</span></code></a>
to close out an entire <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> and create a new one in
its place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.NullPool.status">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.NullPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.NullPool.</span></code></a><span class="sig-name descname"><span class="pre">status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sqlalchemy.pool.NullPool.status" title="Link to this definition">¶</a></dt>
<dd><p>Returns a brief description of the state of this pool.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.StaticPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">StaticPool</span></span><a class="headerlink" href="#sqlalchemy.pool.StaticPool" title="Link to this definition">¶</a></dt>
<dd><p>A Pool of exactly one connection, used for all requests.</p>
<p>Reconnect-related functions such as <code class="docutils literal notranslate"><span class="pre">recycle</span></code> and connection
invalidation (which is also used to support auto-reconnect) are only
partially supported right now and may not yield good results.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.StaticPool" title="sqlalchemy.pool.StaticPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">StaticPool</span></code></a> class <strong>is compatible</strong> with asyncio and
<a class="reference internal" href="../orm/extensions/asyncio.html#sqlalchemy.ext.asyncio.create_async_engine" title="sqlalchemy.ext.asyncio.create_async_engine"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_async_engine()</span></code></a>.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.StaticPool.dispose"><span class="sig-name descname">dispose()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.StaticPool.recreate"><span class="sig-name descname">recreate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.StaticPool.status"><span class="sig-name descname">status()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.StaticPool" title="sqlalchemy.pool.StaticPool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.StaticPool</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.base.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.Pool</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.StaticPool.dispose">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.StaticPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.StaticPool.</span></code></a><span class="sig-name descname"><span class="pre">dispose</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.StaticPool.dispose" title="Link to this definition">¶</a></dt>
<dd><p>Dispose of this pool.</p>
<p>This method leaves the possibility of checked-out connections
remaining open, as it only affects connections that are
idle in the pool.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.Pool.recreate" title="sqlalchemy.pool.Pool.recreate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.StaticPool.recreate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.StaticPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.StaticPool.</span></code></a><span class="sig-name descname"><span class="pre">recreate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.pool.StaticPool" title="sqlalchemy.pool.impl.StaticPool"><span class="pre">StaticPool</span></a></span></span><a class="headerlink" href="#sqlalchemy.pool.StaticPool.recreate" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>, of the same class as this one
and configured with identical creation arguments.</p>
<p>This method is used in conjunction with <a class="reference internal" href="#sqlalchemy.pool.StaticPool.dispose" title="sqlalchemy.pool.StaticPool.dispose"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dispose()</span></code></a>
to close out an entire <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> and create a new one in
its place.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.StaticPool.status">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.StaticPool"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.StaticPool.</span></code></a><span class="sig-name descname"><span class="pre">status</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sqlalchemy.pool.StaticPool.status" title="Link to this definition">¶</a></dt>
<dd><p>Returns a brief description of the state of this pool.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.ManagesConnection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">ManagesConnection</span></span><a class="headerlink" href="#sqlalchemy.pool.ManagesConnection" title="Link to this definition">¶</a></dt>
<dd><p>Common base for the two connection-management interfaces
<a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> and <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>.</p>
<p>These two objects are typically exposed in the public facing API
via the connection pool event hooks, documented at <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents" title="sqlalchemy.events.PoolEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolEvents</span></code></a>.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection"><span class="sig-name descname">dbapi_connection</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection"><span class="sig-name descname">driver_connection</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info"><span class="sig-name descname">info</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.invalidate"><span class="sig-name descname">invalidate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.record_info"><span class="sig-name descname">record_info</span></a></p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入.</span></p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ManagesConnection.dbapi_connection">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ManagesConnection.</span></code></a><span class="sig-name descname"><span class="pre">dbapi_connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="Link to this definition">¶</a></dt>
<dd><p>A reference to the actual DBAPI connection being tracked.</p>
<p>This is a <span class="target" id="index-0"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a>-compliant object that for traditional sync-style
dialects is provided by the third-party
DBAPI implementation in use.  For asyncio dialects, the implementation
is typically an adapter object provided by the SQLAlchemy dialect
itself; the underlying asyncio object is available via the
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="sqlalchemy.pool.ManagesConnection.driver_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a> attribute.</p>
<p>SQLAlchemy’s interface for the DBAPI connection is based on the
<a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">DBAPIConnection</span></code></a> protocol object</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="sqlalchemy.pool.ManagesConnection.driver_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a></p>
<p><a class="reference internal" href="../faq/connections.html#faq-dbapi-connection"><span class="std std-ref">使用引擎时如何获取原始 DBAPI 连接？</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ManagesConnection.driver_connection">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ManagesConnection.</span></code></a><span class="sig-name descname"><span class="pre">driver_connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="Link to this definition">¶</a></dt>
<dd><p>The “driver level” connection object as used by the Python
DBAPI or database driver.</p>
<p>For traditional <span class="target" id="index-1"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> DBAPI implementations, this object will
be the same object as that of
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a>.   For an asyncio database
driver, this will be the ultimate “connection” object used by that
driver, such as the <code class="docutils literal notranslate"><span class="pre">asyncpg.Connection</span></code> object which will not have
standard pep-249 methods.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4.24 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a></p>
<p><a class="reference internal" href="../faq/connections.html#faq-dbapi-connection"><span class="std std-ref">使用引擎时如何获取原始 DBAPI 连接？</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ManagesConnection.info">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ManagesConnection.</span></code></a><span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#sqlalchemy.pool.ManagesConnection.info" title="Link to this definition">¶</a></dt>
<dd><p>Info dictionary associated with the underlying DBAPI connection
referred to by this <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a> instance, allowing
user-defined data to be associated with the connection.</p>
<p>The data in this dictionary is persistent for the lifespan
of the DBAPI connection itself, including across pool checkins
and checkouts.  When the connection is invalidated
and replaced with a new one, this dictionary is cleared.</p>
<p>For a <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> instance that’s not associated
with a <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>, such as if it were detached, the
attribute returns a dictionary that is local to that
<a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>. Therefore the
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a> attribute will always provide a Python
dictionary.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.record_info" title="sqlalchemy.pool.ManagesConnection.record_info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.record_info</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.ManagesConnection.invalidate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ManagesConnection.</span></code></a><span class="sig-name descname"><span class="pre">invalidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.ManagesConnection.invalidate" title="Link to this definition">¶</a></dt>
<dd><p>Mark the managed connection as invalidated.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.pool.ManagesConnection.invalidate.params.e"></span><strong>e</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.ManagesConnection.invalidate.params.e">¶</a> – an exception object indicating a reason for the invalidation.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.ManagesConnection.invalidate.params.soft"></span><strong>soft</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.ManagesConnection.invalidate.params.soft">¶</a> – if True, the connection isn’t closed; instead, this
connection will be recycled on next checkout.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#pool-connection-invalidation"><span class="std std-ref">更多关于失效的信息</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ManagesConnection.record_info">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ManagesConnection.</span></code></a><span class="sig-name descname"><span class="pre">record_info</span></span><a class="headerlink" href="#sqlalchemy.pool.ManagesConnection.record_info" title="Link to this definition">¶</a></dt>
<dd><p>Persistent info dictionary associated with this
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a>.</p>
<p>Unlike the <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a> dictionary, the lifespan
of this dictionary is that of the <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>
which owns it; therefore this dictionary will persist across
reconnects and connection invalidation for a particular entry
in the connection pool.</p>
<p>For a <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> instance that’s not associated
with a <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>, such as if it were detached, the
attribute returns None. Contrast to the <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a>
dictionary which is never None.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">ConnectionPoolEntry</span></span><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry" title="Link to this definition">¶</a></dt>
<dd><p>Interface for the object that maintains an individual database
connection on behalf of a <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> instance.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> object represents the long term
maintainance of a particular connection for a pool, including expiring or
invalidating that connection to have it replaced with a new one, which will
continue to be maintained by that same <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>
instance. Compared to <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a>, which is the
short-term, per-checkout connection manager, this object lasts for the
lifespan of a particular “slot” within a connection pool.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> object is mostly visible to public-facing
API code when it is delivered to connection pool event hooks, such as
<a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.connect" title="sqlalchemy.events.PoolEvents.connect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.connect()</span></code></a> and <a class="reference internal" href="events.html#sqlalchemy.events.PoolEvents.checkout" title="sqlalchemy.events.PoolEvents.checkout"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolEvents.checkout()</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> provides the public
facing interface for the <a class="reference internal" href="#sqlalchemy.pool._ConnectionRecord" title="sqlalchemy.pool._ConnectionRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">_ConnectionRecord</span></code></a> internal class.</p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.close"><span class="sig-name descname">close()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><span class="sig-name descname">dbapi_connection</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.driver_connection"><span class="sig-name descname">driver_connection</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.in_use"><span class="sig-name descname">in_use</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.info"><span class="sig-name descname">info</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.invalidate"><span class="sig-name descname">invalidate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.record_info"><span class="sig-name descname">record_info</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.ManagesConnection</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.close">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.close" title="Link to this definition">¶</a></dt>
<dd><p>Close the DBAPI connection managed by this connection pool entry.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">dbapi_connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection" title="Link to this definition">¶</a></dt>
<dd><p>A reference to the actual DBAPI connection being tracked.</p>
<p>This is a <span class="target" id="index-2"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a>-compliant object that for traditional sync-style
dialects is provided by the third-party
DBAPI implementation in use.  For asyncio dialects, the implementation
is typically an adapter object provided by the SQLAlchemy dialect
itself; the underlying asyncio object is available via the
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="sqlalchemy.pool.ManagesConnection.driver_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a> attribute.</p>
<p>SQLAlchemy’s interface for the DBAPI connection is based on the
<a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">DBAPIConnection</span></code></a> protocol object</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="sqlalchemy.pool.ManagesConnection.driver_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a></p>
<p><a class="reference internal" href="../faq/connections.html#faq-dbapi-connection"><span class="std std-ref">使用引擎时如何获取原始 DBAPI 连接？</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.driver_connection">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">driver_connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.driver_connection" title="Link to this definition">¶</a></dt>
<dd><p>The “driver level” connection object as used by the Python
DBAPI or database driver.</p>
<p>For traditional <span class="target" id="index-3"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> DBAPI implementations, this object will
be the same object as that of
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a>.   For an asyncio database
driver, this will be the ultimate “connection” object used by that
driver, such as the <code class="docutils literal notranslate"><span class="pre">asyncpg.Connection</span></code> object which will not have
standard pep-249 methods.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4.24 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a></p>
<p><a class="reference internal" href="../faq/connections.html#faq-dbapi-connection"><span class="std std-ref">使用引擎时如何获取原始 DBAPI 连接？</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.in_use">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">in_use</span></span><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.in_use" title="Link to this definition">¶</a></dt>
<dd><p>Return True the connection is currently checked out</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.info">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.info" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code> <em>attribute of</em> <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a></p>
</div>
<p>Info dictionary associated with the underlying DBAPI connection
referred to by this <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a> instance, allowing
user-defined data to be associated with the connection.</p>
<p>The data in this dictionary is persistent for the lifespan
of the DBAPI connection itself, including across pool checkins
and checkouts.  When the connection is invalidated
and replaced with a new one, this dictionary is cleared.</p>
<p>For a <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> instance that’s not associated
with a <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>, such as if it were detached, the
attribute returns a dictionary that is local to that
<a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>. Therefore the
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a> attribute will always provide a Python
dictionary.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.record_info" title="sqlalchemy.pool.ManagesConnection.record_info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.record_info</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.invalidate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">invalidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.invalidate" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">ManagesConnection.invalidate()</span></code> <em>method of</em> <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a></p>
</div>
<p>Mark the managed connection as invalidated.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.pool.ConnectionPoolEntry.invalidate.params.e"></span><strong>e</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.invalidate.params.e">¶</a> – an exception object indicating a reason for the invalidation.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.ConnectionPoolEntry.invalidate.params.soft"></span><strong>soft</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.invalidate.params.soft">¶</a> – if True, the connection isn’t closed; instead, this
connection will be recycled on next checkout.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#pool-connection-invalidation"><span class="std std-ref">更多关于失效的信息</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.ConnectionPoolEntry.record_info">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.ConnectionPoolEntry.</span></code></a><span class="sig-name descname"><span class="pre">record_info</span></span><a class="headerlink" href="#sqlalchemy.pool.ConnectionPoolEntry.record_info" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.record_info</span></code> <em>attribute of</em> <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a></p>
</div>
<p>Persistent info dictionary associated with this
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a>.</p>
<p>Unlike the <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a> dictionary, the lifespan
of this dictionary is that of the <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>
which owns it; therefore this dictionary will persist across
reconnects and connection invalidation for a particular entry
in the connection pool.</p>
<p>For a <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> instance that’s not associated
with a <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>, such as if it were detached, the
attribute returns None. Contrast to the <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a>
dictionary which is never None.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">PoolProxiedConnection</span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection" title="Link to this definition">¶</a></dt>
<dd><p>A connection-like adapter for a <span class="target" id="index-4"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> DBAPI connection, which
includes additional methods specific to the <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> implementation.</p>
<p><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> is the public-facing interface for the
internal <a class="reference internal" href="#sqlalchemy.pool._ConnectionFairy" title="sqlalchemy.pool._ConnectionFairy"><code class="xref py py-class docutils literal notranslate"><span class="pre">_ConnectionFairy</span></code></a> implementation object; users familiar
with <a class="reference internal" href="#sqlalchemy.pool._ConnectionFairy" title="sqlalchemy.pool._ConnectionFairy"><code class="xref py py-class docutils literal notranslate"><span class="pre">_ConnectionFairy</span></code></a> can consider this object to be equivalent.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入: </span><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> provides the public-
facing interface for the <a class="reference internal" href="#sqlalchemy.pool._ConnectionFairy" title="sqlalchemy.pool._ConnectionFairy"><code class="xref py py-class docutils literal notranslate"><span class="pre">_ConnectionFairy</span></code></a> internal class.</p>
</div>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.close"><span class="sig-name descname">close()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.dbapi_connection"><span class="sig-name descname">dbapi_connection</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.detach"><span class="sig-name descname">detach()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.driver_connection"><span class="sig-name descname">driver_connection</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.info"><span class="sig-name descname">info</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.invalidate"><span class="sig-name descname">invalidate()</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.is_detached"><span class="sig-name descname">is_detached</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.is_valid"><span class="sig-name descname">is_valid</span></a>, <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.record_info"><span class="sig-name descname">record_info</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection</span></code></a> (<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.ManagesConnection</span></code></a>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.close">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.close" title="Link to this definition">¶</a></dt>
<dd><p>Release this connection back to the pool.</p>
<p>The <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.close" title="sqlalchemy.pool.PoolProxiedConnection.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PoolProxiedConnection.close()</span></code></a> method shadows the
<span class="target" id="index-5"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> <code class="docutils literal notranslate"><span class="pre">.close()</span></code> method, altering its behavior to instead
<a class="reference internal" href="../glossary.html#term-release"><span class="xref std std-term">release</span></a> the proxied connection back to the connection pool.</p>
<p>Upon release to the pool, whether the connection stays “opened” and
pooled in the Python process, versus actually closed out and removed
from the Python process, is based on the pool implementation in use and
its configuration and current state.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.dbapi_connection">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">dbapi_connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><span class="pre">DBAPIConnection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.dbapi_connection" title="Link to this definition">¶</a></dt>
<dd><p>A reference to the actual DBAPI connection being tracked.</p>
<p>This is a <span class="target" id="index-6"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a>-compliant object that for traditional sync-style
dialects is provided by the third-party
DBAPI implementation in use.  For asyncio dialects, the implementation
is typically an adapter object provided by the SQLAlchemy dialect
itself; the underlying asyncio object is available via the
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="sqlalchemy.pool.ManagesConnection.driver_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a> attribute.</p>
<p>SQLAlchemy’s interface for the DBAPI connection is based on the
<a class="reference internal" href="internals.html#sqlalchemy.engine.interfaces.DBAPIConnection" title="sqlalchemy.engine.interfaces.DBAPIConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">DBAPIConnection</span></code></a> protocol object</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection" title="sqlalchemy.pool.ManagesConnection.driver_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a></p>
<p><a class="reference internal" href="../faq/connections.html#faq-dbapi-connection"><span class="std std-ref">使用引擎时如何获取原始 DBAPI 连接？</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.detach">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.detach" title="Link to this definition">¶</a></dt>
<dd><p>Separate this connection from its Pool.</p>
<p>This means that the connection will no longer be returned to the
pool when closed, and will instead be literally closed.  The
associated <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> is de-associated from this
DBAPI connection.</p>
<p>Note that any overall connection limiting constraints imposed by a
Pool implementation may be violated after a detach, as the detached
connection is removed from the pool’s knowledge and control.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.driver_connection">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">driver_connection</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.driver_connection" title="Link to this definition">¶</a></dt>
<dd><p>The “driver level” connection object as used by the Python
DBAPI or database driver.</p>
<p>For traditional <span class="target" id="index-7"></span><a class="pep reference external" href="https://peps.python.org/pep-0249/"><strong>PEP 249</strong></a> DBAPI implementations, this object will
be the same object as that of
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a>.   For an asyncio database
driver, this will be the ultimate “connection” object used by that
driver, such as the <code class="docutils literal notranslate"><span class="pre">asyncpg.Connection</span></code> object which will not have
standard pep-249 methods.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4.24 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection" title="sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a></p>
<p><a class="reference internal" href="../faq/connections.html#faq-dbapi-connection"><span class="std std-ref">使用引擎时如何获取原始 DBAPI 连接？</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.info">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.info" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code> <em>attribute of</em> <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a></p>
</div>
<p>Info dictionary associated with the underlying DBAPI connection
referred to by this <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a> instance, allowing
user-defined data to be associated with the connection.</p>
<p>The data in this dictionary is persistent for the lifespan
of the DBAPI connection itself, including across pool checkins
and checkouts.  When the connection is invalidated
and replaced with a new one, this dictionary is cleared.</p>
<p>For a <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> instance that’s not associated
with a <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>, such as if it were detached, the
attribute returns a dictionary that is local to that
<a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>. Therefore the
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a> attribute will always provide a Python
dictionary.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.record_info" title="sqlalchemy.pool.ManagesConnection.record_info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.record_info</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.invalidate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">invalidate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseException</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.invalidate" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">ManagesConnection.invalidate()</span></code> <em>method of</em> <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a></p>
</div>
<p>Mark the managed connection as invalidated.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.pool.PoolProxiedConnection.invalidate.params.e"></span><strong>e</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.invalidate.params.e">¶</a> – an exception object indicating a reason for the invalidation.</p></li>
<li><p><span class="target" id="sqlalchemy.pool.PoolProxiedConnection.invalidate.params.soft"></span><strong>soft</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.invalidate.params.soft">¶</a> – if True, the connection isn’t closed; instead, this
connection will be recycled on next checkout.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#pool-connection-invalidation"><span class="std std-ref">更多关于失效的信息</span></a></p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.is_detached">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">is_detached</span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.is_detached" title="Link to this definition">¶</a></dt>
<dd><p>Return True if this <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> is detached
from its pool.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.is_valid">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">is_valid</span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.is_valid" title="Link to this definition">¶</a></dt>
<dd><p>Return True if this <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> still refers
to an active DBAPI connection.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.pool.PoolProxiedConnection.record_info">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool.PoolProxiedConnection.</span></code></a><span class="sig-name descname"><span class="pre">record_info</span></span><a class="headerlink" href="#sqlalchemy.pool.PoolProxiedConnection.record_info" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.record_info</span></code> <em>attribute of</em> <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.base.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a></p>
</div>
<p>Persistent info dictionary associated with this
<a class="reference internal" href="#sqlalchemy.pool.ManagesConnection" title="sqlalchemy.pool.ManagesConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a>.</p>
<p>Unlike the <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a> dictionary, the lifespan
of this dictionary is that of the <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>
which owns it; therefore this dictionary will persist across
reconnects and connection invalidation for a particular entry
in the connection pool.</p>
<p>For a <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> instance that’s not associated
with a <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a>, such as if it were detached, the
attribute returns None. Contrast to the <a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a>
dictionary which is never None.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info" title="sqlalchemy.pool.ManagesConnection.info"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a></p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool._ConnectionFairy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">_ConnectionFairy</span></span><a class="headerlink" href="#sqlalchemy.pool._ConnectionFairy" title="Link to this definition">¶</a></dt>
<dd><p>Proxies a DBAPI connection and provides return-on-dereference
support.</p>
<p>This is an internal object used by the <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> implementation
to provide context management to a DBAPI connection delivered by
that <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>.   The public facing interface for this class
is described by the <a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a> class.  See that
class for public API details.</p>
<p>The name “fairy” is inspired by the fact that the
<a class="reference internal" href="#sqlalchemy.pool._ConnectionFairy" title="sqlalchemy.pool._ConnectionFairy"><code class="xref py py-class docutils literal notranslate"><span class="pre">_ConnectionFairy</span></code></a> object’s lifespan is transitory, as it lasts
only for the length of a specific DBAPI connection being checked out from
the pool, and additionally that as a transparent proxy, it is mostly
invisible.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool._ConnectionFairy</span></code> (<a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.base.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.PoolProxiedConnection</span></code></a>)</p>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.pool._ConnectionRecord">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.pool.</span></span><span class="sig-name descname"><span class="pre">_ConnectionRecord</span></span><a class="headerlink" href="#sqlalchemy.pool._ConnectionRecord" title="Link to this definition">¶</a></dt>
<dd><p>Maintains a position in a connection pool which references a pooled
connection.</p>
<p>This is an internal object used by the <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a> implementation
to provide context management to a DBAPI connection maintained by
that <a class="reference internal" href="#sqlalchemy.pool.Pool" title="sqlalchemy.pool.Pool"><code class="xref py py-class docutils literal notranslate"><span class="pre">Pool</span></code></a>.   The public facing interface for this class
is described by the <a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a> class.  See that
class for public API details.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection" title="sqlalchemy.pool.PoolProxiedConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <code class="docutils literal notranslate"><span class="pre">sqlalchemy.pool._ConnectionRecord</span></code> (<a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry" title="sqlalchemy.pool.base.ConnectionPoolEntry"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.pool.base.ConnectionPoolEntry</span></code></a>)</p>
</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="events.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">核心事件</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="connections.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">使用Engines和Connection</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../copyright.html">Copyright</a> &#169; 2007-2025, the SQLAlchemy authors and contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 04/05/2025 04:00:26</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">连接池</a><ul>
<li><a class="reference internal" href="#id2">连接池配置</a></li>
<li><a class="reference internal" href="#pool-switching">切换池实现</a></li>
<li><a class="reference internal" href="#id4">使用自定义连接函数</a></li>
<li><a class="reference internal" href="#id5">构建池</a></li>
<li><a class="reference internal" href="#pool-reset-on-return">返回时重置</a><ul>
<li><a class="reference internal" href="#id7">禁用非事务性连接的返回时重置</a></li>
<li><a class="reference internal" href="#id8">自定义返回时重置方案</a></li>
<li><a class="reference internal" href="#id9">记录返回时重置事件</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">池事件</a></li>
<li><a class="reference internal" href="#pool-disconnects">处理断开连接</a><ul>
<li><a class="reference internal" href="#pool-disconnects-pessimistic">断开连接处理 - 悲观</a><ul>
<li><a class="reference internal" href="#ping">自定义/旧式悲观 Ping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13">断开连接处理 - 乐观</a><ul>
<li><a class="reference internal" href="#pool-setting-recycle">设置池回收</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pool-connection-invalidation">更多关于失效的信息</a></li>
<li><a class="reference internal" href="#pool-new-disconnect-codes">支持断开连接场景的新数据库错误代码</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fifo-lifo">使用 FIFO 与 LIFO</a></li>
<li><a class="reference internal" href="#os-fork">使用具有多处理或 os.fork() 的连接池</a></li>
<li><a class="reference internal" href="#id17">直接使用池实例</a></li>
<li><a class="reference internal" href="#api">API 文档 - 可用的池实现</a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.Pool"><code class="docutils literal notranslate"><span class="pre">Pool</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.Pool.__init__"><code class="docutils literal notranslate"><span class="pre">Pool.__init__()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.Pool.connect"><code class="docutils literal notranslate"><span class="pre">Pool.connect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.Pool.dispose"><code class="docutils literal notranslate"><span class="pre">Pool.dispose()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.Pool.recreate"><code class="docutils literal notranslate"><span class="pre">Pool.recreate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.Pool.status"><code class="docutils literal notranslate"><span class="pre">Pool.status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.QueuePool"><code class="docutils literal notranslate"><span class="pre">QueuePool</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.QueuePool.__init__"><code class="docutils literal notranslate"><span class="pre">QueuePool.__init__()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.QueuePool.dispose"><code class="docutils literal notranslate"><span class="pre">QueuePool.dispose()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.QueuePool.recreate"><code class="docutils literal notranslate"><span class="pre">QueuePool.recreate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.QueuePool.status"><code class="docutils literal notranslate"><span class="pre">QueuePool.status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.AsyncAdaptedQueuePool"><code class="docutils literal notranslate"><span class="pre">AsyncAdaptedQueuePool</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool"><code class="docutils literal notranslate"><span class="pre">SingletonThreadPool</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.connect"><code class="docutils literal notranslate"><span class="pre">SingletonThreadPool.connect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.dispose"><code class="docutils literal notranslate"><span class="pre">SingletonThreadPool.dispose()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.recreate"><code class="docutils literal notranslate"><span class="pre">SingletonThreadPool.recreate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.SingletonThreadPool.status"><code class="docutils literal notranslate"><span class="pre">SingletonThreadPool.status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.AssertionPool"><code class="docutils literal notranslate"><span class="pre">AssertionPool</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.AssertionPool.dispose"><code class="docutils literal notranslate"><span class="pre">AssertionPool.dispose()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.AssertionPool.recreate"><code class="docutils literal notranslate"><span class="pre">AssertionPool.recreate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.AssertionPool.status"><code class="docutils literal notranslate"><span class="pre">AssertionPool.status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.NullPool"><code class="docutils literal notranslate"><span class="pre">NullPool</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.NullPool.dispose"><code class="docutils literal notranslate"><span class="pre">NullPool.dispose()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.NullPool.recreate"><code class="docutils literal notranslate"><span class="pre">NullPool.recreate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.NullPool.status"><code class="docutils literal notranslate"><span class="pre">NullPool.status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.StaticPool"><code class="docutils literal notranslate"><span class="pre">StaticPool</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.StaticPool.dispose"><code class="docutils literal notranslate"><span class="pre">StaticPool.dispose()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.StaticPool.recreate"><code class="docutils literal notranslate"><span class="pre">StaticPool.recreate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.StaticPool.status"><code class="docutils literal notranslate"><span class="pre">StaticPool.status()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection"><code class="docutils literal notranslate"><span class="pre">ManagesConnection</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.dbapi_connection"><code class="docutils literal notranslate"><span class="pre">ManagesConnection.dbapi_connection</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.driver_connection"><code class="docutils literal notranslate"><span class="pre">ManagesConnection.driver_connection</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.info"><code class="docutils literal notranslate"><span class="pre">ManagesConnection.info</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.invalidate"><code class="docutils literal notranslate"><span class="pre">ManagesConnection.invalidate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ManagesConnection.record_info"><code class="docutils literal notranslate"><span class="pre">ManagesConnection.record_info</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.close"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.close()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.dbapi_connection"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.dbapi_connection</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.driver_connection"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.driver_connection</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.in_use"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.in_use</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.info"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.info</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.invalidate"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.invalidate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.ConnectionPoolEntry.record_info"><code class="docutils literal notranslate"><span class="pre">ConnectionPoolEntry.record_info</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.close"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.close()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.dbapi_connection"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.dbapi_connection</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.detach"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.detach()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.driver_connection"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.driver_connection</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.info"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.info</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.invalidate"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.invalidate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.is_detached"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.is_detached</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.is_valid"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.is_valid</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool.PoolProxiedConnection.record_info"><code class="docutils literal notranslate"><span class="pre">PoolProxiedConnection.record_info</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sqlalchemy.pool._ConnectionFairy"><code class="docutils literal notranslate"><span class="pre">_ConnectionFairy</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.pool._ConnectionRecord"><code class="docutils literal notranslate"><span class="pre">_ConnectionRecord</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=2d0eb83f"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=2f3e6152"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    </body>
</html>