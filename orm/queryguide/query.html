<!doctype html>
<html class="no-js" lang="zh-CN" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="索引" href="../../genindex.html" /><link rel="search" title="搜索" href="../../search.html" /><link rel="copyright" title="版权所有" href="../../copyright.html" /><link rel="next" title="使用会话" href="../session.html" /><link rel="prev" title="用于查询的 ORM API 功能" href="api.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.08.06 -->
        <title>旧式查询 API - SQLAlchemy 2.1 Documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/changelog.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx_paramlinks.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/docs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">SQLAlchemy 2.1 Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">SQLAlchemy 2.1 Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="搜索" name="q" aria-label="搜索">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">概述</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorial/index.html">SQLAlchemy 统一教程</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of SQLAlchemy 统一教程</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/engine.html">建立连接 - Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/dbapi_transactions.html">使用事务和DBAPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/metadata.html">使用数据库元数据</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorial/data.html">处理数据</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of 处理数据</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/data_insert.html">使用 INSERT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/data_select.html">使用 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/data_update.html">使用 UPDATE 和 DELETE 语句</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/orm_data_manipulation.html">使用 ORM 进行数据操作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/orm_related_objects.html">使用 ORM 相关对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/further_reading.html">进一步阅读</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">SQLAlchemy ORM</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of SQLAlchemy ORM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html">ORM 快速入门</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../mapper_config.html">ORM 映射类配置</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of ORM 映射类配置</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../mapping_styles.html">ORM 映射类概述</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../declarative_mapping.html">使用声明式映射类</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of 使用声明式映射类</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../declarative_styles.html">声明式映射风格</a></li>
<li class="toctree-l4"><a class="reference internal" href="../declarative_tables.html">声明式的表配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../declarative_config.html">使用声明式映射器配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../declarative_mixins.html">使用 Mixins 组合映射层次结构</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dataclasses.html">与dataclass和attrs的集成</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mapped_sql_expr.html">SQL 表达式作为映射属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mapped_attributes.html">更改Attribute的行为</a></li>
<li class="toctree-l3"><a class="reference internal" href="../composites.html">复合列类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../inheritance.html">映射类继承层次结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../nonstandard_mappings.html">非传统映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="../versioning.html">配置版本计数器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mapping_api.html">类映射 API</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../scalar_mapping.html">映射 SQL 表达式</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of 映射 SQL 表达式</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../mapping_columns.html">映射表格列</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../relationships.html">关系配置</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of 关系配置</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../basic_relationships.html">基本关系模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../self_referential.html">邻接表关系</a></li>
<li class="toctree-l3"><a class="reference internal" href="../join_conditions.html">配置关系连接方式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../large_collections.html">使用大型集合</a></li>
<li class="toctree-l3"><a class="reference internal" href="../collection_api.html">集合自定义和 API 详细信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../relationship_persistence.html">特殊关系的持久化模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../backref.html">使用旧版“backref”关系参数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../relationship_api.html">关系 API</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">ORM 查询指南</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of ORM 查询指南</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="select.html">为 ORM 映射类编写 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="inheritance.html">为继承映射编写 SELECT 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="dml.html">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="columns.html">列加载选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="relationships.html">关系加载技术</a></li>
<li class="toctree-l3"><a class="reference internal" href="api.html">用于查询的 ORM API 功能</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">旧式查询 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../session.html">使用会话</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of 使用会话</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../session_basics.html">会话基础知识</a></li>
<li class="toctree-l3"><a class="reference internal" href="../session_state_management.html">状态管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cascades.html">级联</a></li>
<li class="toctree-l3"><a class="reference internal" href="../session_transaction.html">事务和连接管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../persistence_techniques.html">附加持久性技术</a></li>
<li class="toctree-l3"><a class="reference internal" href="../contextual.html">上下文/线程本地会话</a></li>
<li class="toctree-l3"><a class="reference internal" href="../session_events.html">使用事件跟踪查询、对象和会话更改</a></li>
<li class="toctree-l3"><a class="reference internal" href="../session_api.html">会话 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../extending.html">事件和内部</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of 事件和内部</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../events.html">ORM 事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../internals.html">ORM 内部</a></li>
<li class="toctree-l3"><a class="reference internal" href="../exceptions.html">ORM 异常</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../extensions/index.html">ORM 扩展</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of ORM 扩展</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../extensions/asyncio.html">异步 I/O (asyncio)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/associationproxy.html">关联代理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/automap.html">自动映射</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/baked.html">烘焙查询</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/declarative/index.html">声明式扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/mutable.html">突变追踪</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/orderinglist.html">排序列表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/horizontal_shard.html">水平分片</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/hybrid.html">混合属性</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/indexable.html">Indexable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../extensions/instrumentation.html">替代类检测</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples.html">核心和 ORM 示例</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../core/index.html">SQLAlchemy Core</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of SQLAlchemy Core</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/expression_api.html">SQL 语句和表达式 API</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of SQL 语句和表达式 API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/sqlelement.html">列元素和表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/operators.html">操作符参考</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/selectable.html">SELECT 和相关构造</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/dml.html">插入,更新,删除</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/functions.html">SQL 和 范型函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/compiler.html">自定义 SQL 构造和编译扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/serializer.html">表达式序列化器扩展</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/foundation.html">SQL 表达式语言基础构造</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/visitors.html">访问者和遍历实用程序</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/schema.html">Schema 定义语言</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of Schema 定义语言</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/metadata.html">使用元数据描述数据库</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/reflection.html">反映数据库对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/defaults.html">列 INSERT/UPDATE 默认值</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/constraints.html">定义约束和索引</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/ddl.html">自定义 DDL</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/types.html">SQL 数据类型对象</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of SQL 数据类型对象</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/type_basics.html">类型层次结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/custom_types.html">自定义类型</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/type_api.html">基本类型 API</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/engines_connections.html">Engine和Connection的使用</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Engine和Connection的使用</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/engines.html">Engine 配置</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/connections.html">使用Engines和Connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/pooling.html">连接池</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/events.html">核心事件</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/api_basics.html">Core API 基础</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Core API 基础</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/event.html">事件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/inspection.html">运行时审查 API</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/exceptions.html">Core 异常</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/internals.html">Core 内部</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../dialects/index.html">Dialects</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Dialects</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../dialects/postgresql.html">PostgreSQL</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dialects/mysql.html">MySQL 和 MariaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dialects/sqlite.html">SQLite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dialects/oracle.html">Oracle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dialects/mssql.html">Microsoft SQL Server</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../faq/index.html">常见问题</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of 常见问题</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../faq/installation.html">安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/connections.html">连接 / 引擎</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/metadata_schema.html">元数据 / Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/sqlexpressions.html">SQL 表达式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/ormconfiguration.html">ORM 配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/performance.html">性能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/sessions.html">会话 / 查询</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../faq/thirdparty.html">第三方包集成问题</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../errors.html">错误消息</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../changelog/index.html">变更和迁移</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of 变更和迁移</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_21.html">SQLAlchemy 2.1 有什么新功能？</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_21.html">2.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_20.html">2.0 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_14.html">1.4 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_13.html">1.3 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_12.html">1.2 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_11.html">1.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_10.html">1.0 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_09.html">0.9 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_08.html">0.8 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_07.html">0.7 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_06.html">0.6 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_05.html">0.5 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_04.html">0.4 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_03.html">0.3 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_02.html">0.2 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/changelog_01.html">0.1 Changelog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_20.html">SQLAlchemy 2.0 - Major Migration Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/whatsnew_20.html">What’s New in SQLAlchemy 2.0?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_14.html">What’s New in SQLAlchemy 1.4?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_13.html">What’s New in SQLAlchemy 1.3?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_12.html">What’s New in SQLAlchemy 1.2?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_11.html">What’s New in SQLAlchemy 1.1?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_10.html">What’s New in SQLAlchemy 1.0?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_09.html">What’s New in SQLAlchemy 0.9?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_08.html">What’s New in SQLAlchemy 0.8?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_07.html">What’s New in SQLAlchemy 0.7?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_06.html">What’s New in SQLAlchemy 0.6?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_05.html">What’s new in SQLAlchemy 0.5?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../changelog/migration_04.html">What’s new in SQLAlchemy 0.4?</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <aside class="topic">
<p class="topic-title">ORM Querying Guide</p>
<p>This page is part of the <a class="reference internal" href="index.html"><span class="doc">ORM 查询指南</span></a>.</p>
<p>Previous: <a class="reference internal" href="api.html"><span class="doc">用于查询的 ORM API 功能</span></a></p>
</aside>
<section id="api">
<span id="query-api-toplevel"></span><h1>旧式查询 API<a class="headerlink" href="#api" title="Link to this heading">¶</a></h1>
<p>Legacy Query API</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">中文</label><div class="tab-content docutils container">
<div class="admonition-api admonition">
<p class="admonition-title">关于遗留查询 API</p>
<p>本页包含用于 <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> 构造的 Python 生成文档，多年来，这是使用 SQLAlchemy ORM 时的唯一 SQL 接口。从 2.0 版本开始，一种全新的工作方式成为了标准方法，同样的 <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> 构造在 Core 和 ORM 中都能很好地工作，提供了一致的查询构建接口。</p>
<p>对于基于 2.0 API 之前的 SQLAlchemy ORM 构建的任何应用程序，<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> API 通常代表应用程序中绝大多数的数据库访问代码，因此 <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> API 的大多数内容 <strong>不会从 SQLAlchemy 中移除</strong> 。<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> 对象在后台执行时现在会将自身转换为 2.0 风格的 <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> 对象，因此现在只是一个非常薄的适配器 API。</p>
<p>有关将基于 <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> 的应用程序迁移到 2.0 风格的指南，请参阅 <a class="reference internal" href="../../changelog/migration_20.html#migration-20-query-usage"><span class="std std-ref">2.0 Migration - ORM Usage</span></a>。</p>
<p>有关 2.0 风格的 ORM 对象 SQL 编写简介，请参阅 <a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy 统一教程</span></a>。2.0 风格查询的其他参考资料见 <a class="reference internal" href="index.html#queryguide-toplevel"><span class="std std-ref">ORM 查询指南</span></a>。</p>
</div>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">英文</label><div class="tab-content docutils container">
<div class="admonition-about-the-legacy-query-api admonition">
<p class="admonition-title">About the Legacy Query API</p>
<p>This page contains the Python generated documentation for the
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> construct, which for many years was the sole SQL
interface when working with the SQLAlchemy ORM.  As of version 2.0, an all
new way of working is now the standard approach, where the same
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> construct that works for Core works just as well for the
ORM, providing a consistent interface for building queries.</p>
<p>For any application that is built on the SQLAlchemy ORM prior to the
2.0 API, the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> API will usually represents the vast
majority of database access code within an application, and as such the
majority of the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> API is
<strong>not being removed from SQLAlchemy</strong>.  The <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object
behind the scenes now translates itself into a 2.0 style <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a>
object when the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object is executed, so it now is
just a very thin adapter API.</p>
<p>For a guide to migrating an application based on <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
to 2.0 style, see <a class="reference internal" href="../../changelog/migration_20.html#migration-20-query-usage"><span class="std std-ref">2.0 Migration - ORM Usage</span></a>.</p>
<p>For an introduction to writing SQL for ORM objects in the 2.0 style,
start with the <a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy 统一教程</span></a>.  Additional reference for 2.0 style
querying is at <a class="reference internal" href="index.html#queryguide-toplevel"><span class="std std-ref">ORM 查询指南</span></a>.</p>
</div>
</div>
</div>
<section id="id1">
<h2>查询对象<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>The Query Object</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">中文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> 是通过给定的 <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> 使用 <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a> 方法生成的:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(SomeMappedClass)</span></pre></div>
</div>
<p>以下是 <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> 对象的完整接口。</p>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">英文</label><div class="tab-content docutils container">
<p><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> is produced in terms of a given <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>, using the <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a> method:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(SomeMappedClass)</span></pre></div>
</div>
<p>Following is the full interface for the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object.</p>
</div>
</div>
<div class="table-wrapper longtable docutils container">
<table class="longtable docutils align-default">
<thead>
<tr class="row-odd"><th class="head">Object Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="autosummary-name"><p><a class="reference internal" href="#sqlalchemy.orm.Query"><span class="sig-name descname">Query</span></a></p></td>
<td><p>ORM-level SQL construction object.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sqlalchemy.orm.</span></span><span class="sig-name descname"><span class="pre">Query</span></span><a class="headerlink" href="#sqlalchemy.orm.Query" title="Link to this definition">¶</a></dt>
<dd><p>ORM-level SQL construction object.</p>
<div class="admonition legacy">
<p class="admonition-title">Legacy Feature</p>
<p>The ORM <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object is a legacy construct
as of SQLAlchemy 2.0.   See the notes at the top of
<a class="reference internal" href="#query-api-toplevel"><span class="std std-ref">旧式查询 API</span></a> for an overview, including links to migration
documentation.</p>
</div>
<p><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> objects are normally initially generated using the
<a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a> method of <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>, and in
less common cases by instantiating the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> directly and
associating with a <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> using the
<a class="reference internal" href="#sqlalchemy.orm.Query.with_session" title="sqlalchemy.orm.Query.with_session"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_session()</span></code></a>
method.</p>
<div class="class-members docutils container">
<p><strong>Members</strong></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.__init__"><span class="sig-name descname">__init__()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.add_column"><span class="sig-name descname">add_column()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.add_columns"><span class="sig-name descname">add_columns()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.add_entity"><span class="sig-name descname">add_entity()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.all"><span class="sig-name descname">all()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.apply_labels"><span class="sig-name descname">apply_labels()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.as_scalar"><span class="sig-name descname">as_scalar()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.autoflush"><span class="sig-name descname">autoflush()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.column_descriptions"><span class="sig-name descname">column_descriptions</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.correlate"><span class="sig-name descname">correlate()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.count"><span class="sig-name descname">count()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.cte"><span class="sig-name descname">cte()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.delete"><span class="sig-name descname">delete()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.distinct"><span class="sig-name descname">distinct()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.enable_assertions"><span class="sig-name descname">enable_assertions()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.enable_eagerloads"><span class="sig-name descname">enable_eagerloads()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.except_"><span class="sig-name descname">except_()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.except_all"><span class="sig-name descname">except_all()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.execution_options"><span class="sig-name descname">execution_options()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.exists"><span class="sig-name descname">exists()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.ext"><span class="sig-name descname">ext()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.filter"><span class="sig-name descname">filter()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.filter_by"><span class="sig-name descname">filter_by()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.first"><span class="sig-name descname">first()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.from_statement"><span class="sig-name descname">from_statement()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.get"><span class="sig-name descname">get()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.get_children"><span class="sig-name descname">get_children()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.get_execution_options"><span class="sig-name descname">get_execution_options()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.get_label_style"><span class="sig-name descname">get_label_style</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.group_by"><span class="sig-name descname">group_by()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.having"><span class="sig-name descname">having()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.instances"><span class="sig-name descname">instances()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.intersect"><span class="sig-name descname">intersect()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.intersect_all"><span class="sig-name descname">intersect_all()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.is_single_entity"><span class="sig-name descname">is_single_entity</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.join"><span class="sig-name descname">join()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.label"><span class="sig-name descname">label()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.lazy_loaded_from"><span class="sig-name descname">lazy_loaded_from</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.limit"><span class="sig-name descname">limit()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.merge_result"><span class="sig-name descname">merge_result()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.offset"><span class="sig-name descname">offset()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.one"><span class="sig-name descname">one()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.one_or_none"><span class="sig-name descname">one_or_none()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.only_return_tuples"><span class="sig-name descname">only_return_tuples()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.options"><span class="sig-name descname">options()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.order_by"><span class="sig-name descname">order_by()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.outerjoin"><span class="sig-name descname">outerjoin()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.params"><span class="sig-name descname">params()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing"><span class="sig-name descname">populate_existing()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.prefix_with"><span class="sig-name descname">prefix_with()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.reset_joinpoint"><span class="sig-name descname">reset_joinpoint()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.scalar"><span class="sig-name descname">scalar()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.scalar_subquery"><span class="sig-name descname">scalar_subquery()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.select_from"><span class="sig-name descname">select_from()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.selectable"><span class="sig-name descname">selectable</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.set_label_style"><span class="sig-name descname">set_label_style()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.slice"><span class="sig-name descname">slice()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.statement"><span class="sig-name descname">statement</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.subquery"><span class="sig-name descname">subquery()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.suffix_with"><span class="sig-name descname">suffix_with()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.tuples"><span class="sig-name descname">tuples()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.union"><span class="sig-name descname">union()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.union_all"><span class="sig-name descname">union_all()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.update"><span class="sig-name descname">update()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.value"><span class="sig-name descname">value()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.values"><span class="sig-name descname">values()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.where"><span class="sig-name descname">where()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.whereclause"><span class="sig-name descname">whereclause</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_entities"><span class="sig-name descname">with_entities()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_for_update"><span class="sig-name descname">with_for_update()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_hint"><span class="sig-name descname">with_hint()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_labels"><span class="sig-name descname">with_labels()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_parent"><span class="sig-name descname">with_parent()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_session"><span class="sig-name descname">with_session()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_statement_hint"><span class="sig-name descname">with_statement_hint()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.with_transformation"><span class="sig-name descname">with_transformation()</span></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.yield_per"><span class="sig-name descname">yield_per()</span></a></p>
</div>
<div class="class-bases docutils container">
<p><strong>Class signature</strong></p>
<p>class <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query</span></code></a> (<code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression._SelectFromElements</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.annotation.SupportsCloneAnnotations</span></code>, <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasPrefixes" title="sqlalchemy.sql.expression.HasPrefixes"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.HasPrefixes</span></code></a>, <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasSuffixes" title="sqlalchemy.sql.expression.HasSuffixes"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.HasSuffixes</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.HasHints</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.event.registry.EventTarget</span></code>, <a class="reference internal" href="../../core/internals.html#sqlalchemy.log.Identified" title="sqlalchemy.log.Identified"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.log.Identified</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.Generative</span></code>, <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Executable" title="sqlalchemy.sql.expression.Executable"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.expression.Executable</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Generic</span></code>)</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.__init__">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnsClauseArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">_ColumnsClauseArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><span class="pre">Session</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.Query.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> directly.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = Query([User, Address], session=some_session)</span></pre></div>
</div>
<p>The above is equivalent to:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = some_session.query(User, Address)</span></pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.params.entities"></span><strong>entities</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.params.entities">¶</a> – a sequence of entities and/or SQL expressions.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.params.session"></span><strong>session</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.params.session">¶</a> – a <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> with which the
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
will be associated.   Optional; a <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
can be associated
with a <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> generatively via the
<a class="reference internal" href="#sqlalchemy.orm.Query.with_session" title="sqlalchemy.orm.Query.with_session"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_session()</span></code></a> method as well.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.with_session" title="sqlalchemy.orm.Query.with_session"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_session()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.add_column">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">add_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><span class="pre">Query</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.add_column" title="Link to this definition">¶</a></dt>
<dd><p>Add a column expression to the list of result columns to be
returned.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 1.4 版本弃用: </span><a class="reference internal" href="#sqlalchemy.orm.Query.add_column" title="sqlalchemy.orm.Query.add_column"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.add_column()</span></code></a> is deprecated and will be removed in a future release.  Please use <a class="reference internal" href="#sqlalchemy.orm.Query.add_columns" title="sqlalchemy.orm.Query.add_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.add_columns()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.add_columns">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">add_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><span class="pre">Query</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.add_columns" title="Link to this definition">¶</a></dt>
<dd><p>Add one or more column expressions to the list
of result columns to be returned.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.add_columns" title="sqlalchemy.sql.expression.Select.add_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.add_columns()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.add_entity">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">add_entity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_EntityType</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><span class="pre">Alias</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Subquery" title="sqlalchemy.sql.expression.Subquery"><span class="pre">Subquery</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><span class="pre">Query</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.add_entity" title="Link to this definition">¶</a></dt>
<dd><p>add a mapped entity to the list of result columns
to be returned.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.add_columns" title="sqlalchemy.sql.expression.Select.add_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.add_columns()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.all">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">_T</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.all" title="Link to this definition">¶</a></dt>
<dd><p>Return the results represented by this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
as a list.</p>
<p>This results in an execution of the underlying SQL statement.</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>The <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object,
when asked to return either
a sequence or iterator that consists of full ORM-mapped entities,
will <strong>deduplicate entries based on primary key</strong>.  See the FAQ for
more details.</p>
<blockquote>
<div><div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../faq/sessions.html#faq-query-deduplicating"><span class="std std-ref">我的查询没有返回与 query.count() 告诉我的相同数量的对象 - 为什么？</span></a></p>
</div>
</div></blockquote>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.all" title="sqlalchemy.engine.Result.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.all()</span></code></a> - v2 comparable method.</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.scalars" title="sqlalchemy.engine.Result.scalars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.scalars()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.apply_labels">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">apply_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.apply_labels" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.with_labels" title="sqlalchemy.orm.Query.with_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_labels()</span></code></a> and <a class="reference internal" href="#sqlalchemy.orm.Query.apply_labels" title="sqlalchemy.orm.Query.apply_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.apply_labels()</span></code></a> method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. Use set_label_style(LABEL_STYLE_TABLENAME_PLUS_COL) instead. (Background on SQLAlchemy 2.0 at: <a class="reference internal" href="../../changelog/migration_20.html#migration-20-toplevel"><span class="std std-ref">SQLAlchemy 2.0 - Major Migration Guide</span></a>)</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.as_scalar">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">as_scalar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.ScalarSelect" title="sqlalchemy.sql.expression.ScalarSelect"><span class="pre">ScalarSelect</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.as_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, converted to a scalar subquery.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 1.4 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.as_scalar" title="sqlalchemy.orm.Query.as_scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.as_scalar()</span></code></a> method is deprecated and will be removed in a future release.  Please refer to <a class="reference internal" href="#sqlalchemy.orm.Query.scalar_subquery" title="sqlalchemy.orm.Query.scalar_subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.scalar_subquery()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.autoflush">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">autoflush</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.autoflush" title="Link to this definition">¶</a></dt>
<dd><p>Return a Query with a specific ‘autoflush’ setting.</p>
<p>As of SQLAlchemy 1.4, the <a class="reference internal" href="#sqlalchemy.orm.Query.autoflush" title="sqlalchemy.orm.Query.autoflush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.autoflush()</span></code></a> method
is equivalent to using the <code class="docutils literal notranslate"><span class="pre">autoflush</span></code> execution option at the
ORM level. See the section <a class="reference internal" href="api.html#orm-queryguide-autoflush"><span class="std std-ref">自动刷新</span></a> for
further background on this option.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.column_descriptions">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">column_descriptions</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.column_descriptions" title="Link to this definition">¶</a></dt>
<dd><p>Return metadata about the columns which would be
returned by this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p>Format is a list of dictionaries:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">user_alias = aliased(User, name=&quot;user2&quot;)</span>
<span class="go">q = sess.query(User, User.id, user_alias)</span>

<span class="go"># this expression:</span>
<span class="go">q.column_descriptions</span>

<span class="go"># would return:</span>
<span class="go">[</span>
<span class="go">    {</span>
<span class="go">        &quot;name&quot;: &quot;User&quot;,</span>
<span class="go">        &quot;type&quot;: User,</span>
<span class="go">        &quot;aliased&quot;: False,</span>
<span class="go">        &quot;expr&quot;: User,</span>
<span class="go">        &quot;entity&quot;: User,</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;name&quot;: &quot;id&quot;,</span>
<span class="go">        &quot;type&quot;: Integer(),</span>
<span class="go">        &quot;aliased&quot;: False,</span>
<span class="go">        &quot;expr&quot;: User.id,</span>
<span class="go">        &quot;entity&quot;: User,</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">        &quot;name&quot;: &quot;user2&quot;,</span>
<span class="go">        &quot;type&quot;: User,</span>
<span class="go">        &quot;aliased&quot;: True,</span>
<span class="go">        &quot;expr&quot;: user_alias,</span>
<span class="go">        &quot;entity&quot;: user_alias,</span>
<span class="go">    },</span>
<span class="go">]</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p>This API is available using <a class="reference internal" href="../../glossary.html#term-2.0-style"><span class="xref std std-term">2.0 style</span></a> queries as well,
documented at:</p>
<ul class="simple">
<li><p><a class="reference internal" href="api.html#queryguide-inspection"><span class="std std-ref">检查启用 ORM 的 SELECT 和 DML 语句中的实体和列</span></a></p></li>
<li><p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.column_descriptions" title="sqlalchemy.sql.expression.Select.column_descriptions"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Select.column_descriptions</span></code></a></p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.correlate">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">correlate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">fromclauses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">FromClauseRole</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Inspectable</span><span class="p"><span class="pre">[</span></span><span class="pre">_HasClauseElement</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_HasClauseElement</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.correlate" title="Link to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> construct which will correlate the given
FROM clauses to that of an enclosing <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> or
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a>.</p>
<p>The method here accepts mapped classes, <a class="reference internal" href="api.html#sqlalchemy.orm.aliased" title="sqlalchemy.orm.aliased"><code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code></a> constructs,
and <a class="reference internal" href="../mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> constructs as arguments, which are resolved
into expression constructs, in addition to appropriate expression
constructs.</p>
<p>The correlation arguments are ultimately passed to
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.correlate" title="sqlalchemy.sql.expression.Select.correlate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.correlate()</span></code></a>
after coercion to expression constructs.</p>
<p>The correlation arguments take effect in such cases
as when <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.from_self()</span></code> is used, or when
a subquery as returned by <a class="reference internal" href="#sqlalchemy.orm.Query.subquery" title="sqlalchemy.orm.Query.subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.subquery()</span></code></a> is
embedded in another <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> construct.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.correlate" title="sqlalchemy.sql.expression.Select.correlate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.correlate()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.count">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.count" title="Link to this definition">¶</a></dt>
<dd><p>Return a count of rows this the SQL formed by this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
would return.</p>
<p>This generates the SQL for this Query as follows:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">count</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">count_1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">&lt;</span><span class="n">rest</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">follows</span><span class="p">...</span><span class="o">&gt;</span>
<span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span></pre></div>
</div>
<p>The above SQL returns a single row, which is the aggregate value
of the count function; the <a class="reference internal" href="#sqlalchemy.orm.Query.count" title="sqlalchemy.orm.Query.count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.count()</span></code></a>
method then returns
that single integer value.</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>It is important to note that the value returned by
count() is <strong>not the same as the number of ORM objects that this
Query would return from a method such as the .all() method</strong>.
The <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object,
when asked to return full entities,
will <strong>deduplicate entries based on primary key</strong>, meaning if the
same primary key value would appear in the results more than once,
only one object of that primary key would be present.  This does
not apply to a query that is against individual columns.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../faq/sessions.html#faq-query-deduplicating"><span class="std std-ref">我的查询没有返回与 query.count() 告诉我的相同数量的对象 - 为什么？</span></a></p>
</div>
</div>
<p>For fine grained control over specific columns to count, to skip the
usage of a subquery or otherwise control of the FROM clause, or to use
other aggregate functions, use <a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.func" title="sqlalchemy.sql.expression.func"><code class="xref py py-attr docutils literal notranslate"><span class="pre">expression.func</span></code></a>
expressions in conjunction with <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a>, i.e.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">from sqlalchemy import func</span>

<span class="go"># count User records, without</span>
<span class="go"># using a subquery.</span>
<span class="go">session.query(func.count(User.id))</span>

<span class="go"># return count of user &quot;id&quot; grouped</span>
<span class="go"># by &quot;name&quot;</span>
<span class="go">session.query(func.count(User.id)).group_by(User.name)</span>

<span class="go">from sqlalchemy import distinct</span>

<span class="go"># count distinct &quot;name&quot; values</span>
<span class="go">session.query(func.count(distinct(User.name)))</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../changelog/migration_20.html#migration-20-query-usage"><span class="std std-ref">2.0 Migration - ORM Usage</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.cte">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">cte</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nesting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.CTE" title="sqlalchemy.sql.expression.CTE"><span class="pre">CTE</span></a></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.cte" title="Link to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> represented as a common table expression (CTE).</p>
<p>Parameters and usage are the same as those of the
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.SelectBase.cte" title="sqlalchemy.sql.expression.SelectBase.cte"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SelectBase.cte()</span></code></a> method; see that method for
further details.</p>
<p>Here is the <a class="reference external" href="https://www.postgresql.org/docs/current/static/queries-with.html">PostgreSQL WITH
RECURSIVE example</a>.
Note that, in this example, the <code class="docutils literal notranslate"><span class="pre">included_parts</span></code> cte and the
<code class="docutils literal notranslate"><span class="pre">incl_alias</span></code> alias of it are Core selectables, which
means the columns are accessed via the <code class="docutils literal notranslate"><span class="pre">.c.</span></code> attribute.  The
<code class="docutils literal notranslate"><span class="pre">parts_alias</span></code> object is an <a class="reference internal" href="api.html#sqlalchemy.orm.aliased" title="sqlalchemy.orm.aliased"><code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code></a> instance of the
<code class="docutils literal notranslate"><span class="pre">Part</span></code> entity, so column-mapped attributes are available
directly:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">from sqlalchemy.orm import aliased</span>


<span class="go">class Part(Base):</span>
<span class="go">    __tablename__ = &quot;part&quot;</span>
<span class="go">    part = Column(String, primary_key=True)</span>
<span class="go">    sub_part = Column(String, primary_key=True)</span>
<span class="go">    quantity = Column(Integer)</span>


<span class="go">included_parts = (</span>
<span class="go">    session.query(Part.sub_part, Part.part, Part.quantity)</span>
<span class="go">    .filter(Part.part == &quot;our part&quot;)</span>
<span class="go">    .cte(name=&quot;included_parts&quot;, recursive=True)</span>
<span class="go">)</span>

<span class="go">incl_alias = aliased(included_parts, name=&quot;pr&quot;)</span>
<span class="go">parts_alias = aliased(Part, name=&quot;p&quot;)</span>
<span class="go">included_parts = included_parts.union_all(</span>
<span class="go">    session.query(</span>
<span class="go">        parts_alias.sub_part, parts_alias.part, parts_alias.quantity</span>
<span class="go">    ).filter(parts_alias.part == incl_alias.c.sub_part)</span>
<span class="go">)</span>

<span class="go">q = session.query(</span>
<span class="go">    included_parts.c.sub_part,</span>
<span class="go">    func.sum(included_parts.c.quantity).label(&quot;total_quantity&quot;),</span>
<span class="go">).group_by(included_parts.c.sub_part)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.cte" title="sqlalchemy.sql.expression.Select.cte"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.cte()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.delete">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">synchronize_session</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SynchronizeSessionArgument</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.delete" title="Link to this definition">¶</a></dt>
<dd><p>Perform a DELETE with an arbitrary WHERE clause.</p>
<p>Deletes rows matched by this query from the database.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">sess.query(User).filter(User.age == 25).delete(synchronize_session=False)</span>

<span class="go">sess.query(User).filter(User.age == 25).delete(</span>
<span class="go">    synchronize_session=&quot;evaluate&quot;</span>
<span class="go">)</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>See the section <a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</span></a> for important
caveats and warnings, including limitations when using bulk UPDATE
and DELETE with mapper inheritance configurations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.delete.params.synchronize_session"></span><strong>synchronize_session</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.delete.params.synchronize_session">¶</a> – chooses the strategy to update the
attributes on objects in the session.   See the section
<a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</span></a> for a discussion of these
strategies.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.delete.params.delete_args"></span><strong>delete_args</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.delete.params.delete_args">¶</a> – <p>Optional dictionary, if present will be passed
to the underlying <a class="reference internal" href="../../core/dml.html#sqlalchemy.sql.expression.delete" title="sqlalchemy.sql.expression.delete"><code class="xref py py-func docutils literal notranslate"><span class="pre">delete()</span></code></a> construct as the <code class="docutils literal notranslate"><span class="pre">**kw</span></code>
for the object.  May be used to pass dialect-specific arguments such
as <code class="docutils literal notranslate"><span class="pre">mysql_limit</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0.37 版本加入.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>the count of rows matched as returned by the database’s
“row count” feature.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.distinct">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">distinct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">expr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.distinct" title="Link to this definition">¶</a></dt>
<dd><p>Apply a <code class="docutils literal notranslate"><span class="pre">DISTINCT</span></code> to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The ORM-level <a class="reference internal" href="#sqlalchemy.orm.Query.distinct" title="sqlalchemy.orm.Query.distinct"><code class="xref py py-meth docutils literal notranslate"><span class="pre">distinct()</span></code></a> call includes logic that will
automatically add columns from the ORDER BY of the query to the
columns clause of the SELECT statement, to satisfy the common need
of the database backend that ORDER BY columns be part of the SELECT
list when DISTINCT is used.   These columns <em>are not</em> added to the
list of columns actually fetched by the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>,
however,
so would not affect results. The columns are passed through when
using the <a class="reference internal" href="#sqlalchemy.orm.Query.statement" title="sqlalchemy.orm.Query.statement"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code></a> accessor, however.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>This logic is deprecated and will be removed
in SQLAlchemy 2.0.     See <a class="reference internal" href="../../changelog/migration_20.html#migration-20-query-distinct"><span class="std std-ref">Using DISTINCT with additional columns, but only select the entity</span></a>
for a description of this use case in 2.0.</p>
</div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.distinct" title="sqlalchemy.sql.expression.Select.distinct"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.distinct()</span></code></a> - v2 equivalent method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.orm.Query.distinct.params.*expr"></span><strong>*expr</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.distinct.params.*expr">¶</a> – <p>optional column expressions.  When present,
the PostgreSQL dialect will render a <code class="docutils literal notranslate"><span class="pre">DISTINCT</span> <span class="pre">ON</span> <span class="pre">(&lt;expressions&gt;)</span></code>
construct.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.1 版本弃用: </span>Passing expressions to
<a class="reference internal" href="#sqlalchemy.orm.Query.distinct" title="sqlalchemy.orm.Query.distinct"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.distinct()</span></code></a> is deprecated, use
<a class="reference internal" href="../../dialects/postgresql.html#sqlalchemy.dialects.postgresql.distinct_on" title="sqlalchemy.dialects.postgresql.distinct_on"><code class="xref py py-func docutils literal notranslate"><span class="pre">distinct_on()</span></code></a> instead.</p>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.enable_assertions">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">enable_assertions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.enable_assertions" title="Link to this definition">¶</a></dt>
<dd><p>Control whether assertions are generated.</p>
<p>When set to False, the returned Query will
not assert its state before certain operations,
including that LIMIT/OFFSET has not been applied
when filter() is called, no criterion exists
when get() is called, and no “from_statement()”
exists when filter()/order_by()/group_by() etc.
is called.  This more permissive mode is used by
custom Query subclasses to specify criterion or
other modifiers outside of the usual usage patterns.</p>
<p>Care should be taken to ensure that the usage
pattern is even possible.  A statement applied
by from_statement() will override any criterion
set by filter() or order_by(), for example.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.enable_eagerloads">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">enable_eagerloads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.enable_eagerloads" title="Link to this definition">¶</a></dt>
<dd><p>Control whether or not eager joins and subqueries are
rendered.</p>
<p>When set to False, the returned Query will not render
eager joins regardless of <a class="reference internal" href="relationships.html#sqlalchemy.orm.joinedload" title="sqlalchemy.orm.joinedload"><code class="xref py py-func docutils literal notranslate"><span class="pre">joinedload()</span></code></a>,
<a class="reference internal" href="relationships.html#sqlalchemy.orm.subqueryload" title="sqlalchemy.orm.subqueryload"><code class="xref py py-func docutils literal notranslate"><span class="pre">subqueryload()</span></code></a> options
or mapper-level <code class="docutils literal notranslate"><span class="pre">lazy='joined'</span></code>/<code class="docutils literal notranslate"><span class="pre">lazy='subquery'</span></code>
configurations.</p>
<p>This is used primarily when nesting the Query’s
statement into a subquery or other
selectable, or when using <a class="reference internal" href="#sqlalchemy.orm.Query.yield_per" title="sqlalchemy.orm.Query.yield_per"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.yield_per()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.except_">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">except_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.except_" title="Link to this definition">¶</a></dt>
<dd><p>Produce an EXCEPT of this Query against one or more queries.</p>
<p>Works the same way as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.union()</span></code>. See
that method for usage examples.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.except_" title="sqlalchemy.sql.expression.Select.except_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.except_()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.except_all">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">except_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.except_all" title="Link to this definition">¶</a></dt>
<dd><p>Produce an EXCEPT ALL of this Query against one or more queries.</p>
<p>Works the same way as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.union()</span></code>. See
that method for usage examples.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.except_all" title="sqlalchemy.sql.expression.Select.except_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.except_all()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.execution_options">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">execution_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.execution_options" title="Link to this definition">¶</a></dt>
<dd><p>Set non-SQL options which take effect during execution.</p>
<p>Options allowed here include all of those accepted by
<a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Connection.execution_options" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Connection.execution_options()</span></code></a>, as well as a series
of ORM specific options:</p>
<p><code class="docutils literal notranslate"><span class="pre">populate_existing=True</span></code> - equivalent to using
<a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing" title="sqlalchemy.orm.Query.populate_existing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.populate_existing()</span></code></a></p>
<p><code class="docutils literal notranslate"><span class="pre">autoflush=True|False</span></code> - equivalent to using
<a class="reference internal" href="#sqlalchemy.orm.Query.autoflush" title="sqlalchemy.orm.Query.autoflush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.autoflush()</span></code></a></p>
<p><code class="docutils literal notranslate"><span class="pre">yield_per=&lt;value&gt;</span></code> - equivalent to using
<a class="reference internal" href="#sqlalchemy.orm.Query.yield_per" title="sqlalchemy.orm.Query.yield_per"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.yield_per()</span></code></a></p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">stream_results</span></code> execution option is enabled
automatically if the <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.yield_per()</span></code>
method or execution option is used.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入: </span>- added ORM options to
<a class="reference internal" href="#sqlalchemy.orm.Query.execution_options" title="sqlalchemy.orm.Query.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.execution_options()</span></code></a></p>
</div>
<p>The execution options may also be specified on a per execution basis
when using <a class="reference internal" href="../../glossary.html#term-2.0-style"><span class="xref std std-term">2.0 style</span></a> queries via the
<a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.params.execution_options" title="sqlalchemy.orm.Session"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Session.execution_options</span></code></a> parameter.</p>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>The
<a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Connection.execution_options.params.stream_results" title="sqlalchemy.engine.Connection.execution_options"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Connection.execution_options.stream_results</span></code></a>
parameter should not be used at the level of individual ORM
statement executions, as the <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> will not track
objects from different schema translate maps within a single
session.  For multiple schema translate maps within the scope of a
single <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>, see <a class="reference internal" href="../examples.html#examples-sharding"><span class="std std-ref">水平分片</span></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/connections.html#engine-stream-results"><span class="std std-ref">使用服务器端游标（又称流结果）</span></a></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.get_execution_options" title="sqlalchemy.orm.Query.get_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get_execution_options()</span></code></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.execution_options" title="sqlalchemy.sql.expression.Select.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.execution_options()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.exists">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">exists</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Exists" title="sqlalchemy.sql.selectable.Exists"><span class="pre">Exists</span></a></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.exists" title="Link to this definition">¶</a></dt>
<dd><p>A convenience method that turns a query into an EXISTS subquery
of the form EXISTS (SELECT 1 FROM … WHERE …).</p>
<p>e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(User).filter(User.name == &quot;fred&quot;)</span>
<span class="go">session.query(q.exists())</span></pre></div>
</div>
<p>Producing SQL similar to:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">:</span><span class="n">name_1</span>
<span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">anon_1</span></pre></div>
</div>
<p>The EXISTS construct is usually used in the WHERE clause:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">session.query(User.id).filter(q.exists()).scalar()</span></pre></div>
</div>
<p>Note that some databases such as SQL Server don’t allow an
EXISTS expression to be present in the columns clause of a
SELECT.    To select a simple boolean value based on the exists
as a WHERE, use <a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.literal" title="sqlalchemy.sql.expression.literal"><code class="xref py py-func docutils literal notranslate"><span class="pre">literal()</span></code></a>:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">from sqlalchemy import literal</span>

<span class="go">session.query(literal(True)).filter(q.exists()).scalar()</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.exists" title="sqlalchemy.sql.expression.Select.exists"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.exists()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.ext">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">ext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/compiler.html#sqlalchemy.sql.SyntaxExtension" title="sqlalchemy.sql.SyntaxExtension"><span class="pre">SyntaxExtension</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.ext" title="Link to this definition">¶</a></dt>
<dd><p>Applies a SQL syntax extension to this statement.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../examples.html#examples-syntax-extensions"><span class="std std-ref">Extending Statements like SELECT, INSERT, etc</span></a></p>
<p><a class="reference internal" href="../../dialects/mysql.html#sqlalchemy.dialects.mysql.limit" title="sqlalchemy.dialects.mysql.limit"><code class="xref py py-func docutils literal notranslate"><span class="pre">limit()</span></code></a> - DML LIMIT for MySQL</p>
<p><a class="reference internal" href="../../dialects/postgresql.html#sqlalchemy.dialects.postgresql.distinct_on" title="sqlalchemy.dialects.postgresql.distinct_on"><code class="xref py py-func docutils literal notranslate"><span class="pre">distinct_on()</span></code></a> - DISTINCT ON for PostgreSQL</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 2.1 版本加入.</span></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.filter">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.filter" title="Link to this definition">¶</a></dt>
<dd><p>Apply the given filtering criterion to a copy
of this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, using SQL expressions.</p>
<p>e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">session.query(MyClass).filter(MyClass.name == &quot;some name&quot;)</span></pre></div>
</div>
<p>Multiple criteria may be specified as comma separated; the effect
is that they will be joined together using the <a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code></a>
function:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">session.query(MyClass).filter(MyClass.name == &quot;some name&quot;, MyClass.id &gt; 5)</span></pre></div>
</div>
<p>The criterion is any SQL expression object applicable to the
WHERE clause of a select.   String expressions are coerced
into SQL expression constructs via the <a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a>
construct.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.filter_by" title="sqlalchemy.orm.Query.filter_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter_by()</span></code></a> - filter on keyword expressions.</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.where" title="sqlalchemy.sql.expression.Select.where"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.where()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.filter_by">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">filter_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.filter_by" title="Link to this definition">¶</a></dt>
<dd><p>Apply the given filtering criterion to a copy
of this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, using keyword expressions.</p>
<p>e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">session.query(MyClass).filter_by(name=&quot;some name&quot;)</span></pre></div>
</div>
<p>Multiple criteria may be specified as comma separated; the effect
is that they will be joined together using the <a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.and_" title="sqlalchemy.sql.expression.and_"><code class="xref py py-func docutils literal notranslate"><span class="pre">and_()</span></code></a>
function:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">session.query(MyClass).filter_by(name=&quot;some name&quot;, id=5)</span></pre></div>
</div>
<p>The keyword expressions are extracted from the primary
entity of the query, or the last entity that was the
target of a call to <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.filter" title="sqlalchemy.orm.Query.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code></a> - filter on SQL expressions.</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.filter_by" title="sqlalchemy.sql.expression.Select.filter_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.filter_by()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.first">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">first</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_T</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.first" title="Link to this definition">¶</a></dt>
<dd><p>Return the first result of this <code class="docutils literal notranslate"><span class="pre">Query</span></code> or
None if the result doesn’t contain any row.</p>
<p>first() applies a limit of one within the generated SQL, so that
only one primary entity row is generated on the server side
(note this may consist of multiple result rows if join-loaded
collections are present).</p>
<p>Calling <a class="reference internal" href="#sqlalchemy.orm.Query.first" title="sqlalchemy.orm.Query.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></a>
results in an execution of the underlying
query.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.one" title="sqlalchemy.orm.Query.one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.one_or_none" title="sqlalchemy.orm.Query.one_or_none"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></a></p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.first" title="sqlalchemy.engine.Result.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.first()</span></code></a> - v2 comparable method.</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.scalars" title="sqlalchemy.engine.Result.scalars"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.scalars()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.from_statement">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">from_statement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">statement</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExecutableReturnsRows</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.from_statement" title="Link to this definition">¶</a></dt>
<dd><p>Execute the given SELECT statement and return results.</p>
<p>This method bypasses all internal statement compilation, and the
statement is executed without modification.</p>
<p>The statement is typically either a <a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.text" title="sqlalchemy.sql.expression.text"><code class="xref py py-func docutils literal notranslate"><span class="pre">text()</span></code></a>
or <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> construct, and should return the set
of columns
appropriate to the entity class represented by this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.from_statement" title="sqlalchemy.sql.expression.Select.from_statement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.from_statement()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.get">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ident</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_PKIdentityArgument</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.get" title="Link to this definition">¶</a></dt>
<dd><p>Return an instance based on the given primary key identifier,
or <code class="docutils literal notranslate"><span class="pre">None</span></code> if not found.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.get" title="sqlalchemy.orm.Query.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get()</span></code></a> method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is now available as <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.get" title="sqlalchemy.orm.Session.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.get()</span></code></a> (Background on SQLAlchemy 2.0 at: <a class="reference internal" href="../../changelog/migration_20.html#migration-20-toplevel"><span class="std std-ref">SQLAlchemy 2.0 - Major Migration Guide</span></a>)</p>
</div>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">my_user = session.query(User).get(5)</span>

<span class="go">some_object = session.query(VersionedFoo).get((5, 10))</span>

<span class="go">some_object = session.query(VersionedFoo).get({&quot;id&quot;: 5, &quot;version_id&quot;: 10})</span></pre></div>
</div>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.get" title="sqlalchemy.orm.Query.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get()</span></code></a> is special in that it provides direct
access to the identity map of the owning <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.
If the given primary key identifier is present
in the local identity map, the object is returned
directly from this collection and no SQL is emitted,
unless the object has been marked fully expired.
If not present,
a SELECT is performed in order to locate the object.</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.get" title="sqlalchemy.orm.Query.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get()</span></code></a> also will perform a check if
the object is present in the identity map and
marked as expired - a SELECT
is emitted to refresh the object as well as to
ensure that the row is still present.
If not, <a class="reference internal" href="../exceptions.html#sqlalchemy.orm.exc.ObjectDeletedError" title="sqlalchemy.orm.exc.ObjectDeletedError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectDeletedError</span></code></a> is raised.</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.get" title="sqlalchemy.orm.Query.get"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.get()</span></code></a> is only used to return a single
mapped instance, not multiple instances or
individual column constructs, and strictly
on a single primary key value.  The originating
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> must be constructed in this way,
i.e. against a single mapped entity,
with no additional filtering criterion.  Loading
options via <a class="reference internal" href="#sqlalchemy.orm.Query.options" title="sqlalchemy.orm.Query.options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.options()</span></code></a> may be applied
however, and will be used if the object is not
yet locally present.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.orm.Query.get.params.ident"></span><strong>ident</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.get.params.ident">¶</a> – <p>A scalar, tuple, or dictionary representing the
primary key.  For a composite (e.g. multiple column) primary key,
a tuple or dictionary should be passed.</p>
<p>For a single-column primary key, the scalar calling form is typically
the most expedient.  If the primary key of a row is the value “5”,
the call looks like:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">my_object = query.get(5)</span></pre></div>
</div>
<p>The tuple form contains primary key values typically in
the order in which they correspond to the mapped
<a class="reference internal" href="../../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>
object’s primary key columns, or if the
<a class="reference internal" href="../mapping_api.html#sqlalchemy.orm.Mapper.params.primary_key" title="sqlalchemy.orm.Mapper"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Mapper.primary_key</span></code></a> configuration parameter were
used, in
the order used for that parameter. For example, if the primary key
of a row is represented by the integer
digits “5, 10” the call would look like:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">my_object = query.get((5, 10))</span></pre></div>
</div>
<p>The dictionary form should include as keys the mapped attribute names
corresponding to each element of the primary key.  If the mapped class
has the attributes <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">version_id</span></code> as the attributes which
store the object’s primary key value, the call would look like:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">my_object = query.get({&quot;id&quot;: 5, &quot;version_id&quot;: 10})</span></pre></div>
</div>
</p>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>The object instance, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.get_children">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">get_children</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omit_attrs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">HasTraverseInternals</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.get_children" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">HasTraverseInternals.get_children()</span></code> <em>method of</em> <code class="xref py py-class docutils literal notranslate"><span class="pre">HasTraverseInternals</span></code></p>
</div>
<p>Return immediate child <code class="xref py py-class docutils literal notranslate"><span class="pre">HasTraverseInternals</span></code>
elements of this <code class="xref py py-class docutils literal notranslate"><span class="pre">HasTraverseInternals</span></code>.</p>
<p>This is used for visit traversal.</p>
<p>**kw may contain flags that change the collection that is
returned, for example to return a subset of items in order to
cut down on larger traversals, or to return child items from a
different context (such as schema-level collections instead of
clause-level).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.get_execution_options">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">get_execution_options</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_ImmutableExecuteOptions</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.get_execution_options" title="Link to this definition">¶</a></dt>
<dd><p>Get the non-SQL options which will take effect during execution.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.execution_options" title="sqlalchemy.orm.Query.execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.execution_options()</span></code></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.get_execution_options" title="sqlalchemy.sql.expression.Select.get_execution_options"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.get_execution_options()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.get_label_style">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">get_label_style</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.get_label_style" title="Link to this definition">¶</a></dt>
<dd><p>Retrieve the current label style.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.get_label_style" title="sqlalchemy.sql.expression.Select.get_label_style"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.get_label_style()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.group_by">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">group_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_Query__first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NoArg.NO_ARG</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_ColumnExpressionOrStrLabelArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">_NoArg.NO_ARG</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">clauses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionOrStrLabelArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.group_by" title="Link to this definition">¶</a></dt>
<dd><p>Apply one or more GROUP BY criterion to the query and return
the newly resulting <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p>All existing GROUP BY settings can be suppressed by
passing <code class="docutils literal notranslate"><span class="pre">None</span></code> - this will suppress any GROUP BY configured
on mappers as well.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p>These sections describe GROUP BY in terms of <a class="reference internal" href="../../glossary.html#term-2.0-style"><span class="xref std std-term">2.0 style</span></a>
invocation but apply to <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> as well:</p>
<p><a class="reference internal" href="../../tutorial/data_select.html#tutorial-group-by-w-aggregates"><span class="std std-ref">使用 GROUP BY / HAVING 的聚合函数</span></a> - in the
<a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy 统一教程</span></a></p>
<p><a class="reference internal" href="../../tutorial/data_select.html#tutorial-order-by-label"><span class="std std-ref">按标签排序或分组</span></a> - in the <a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy 统一教程</span></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.group_by" title="sqlalchemy.sql.expression.Select.group_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.group_by()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.having">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">having</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">having</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.having" title="Link to this definition">¶</a></dt>
<dd><p>Apply a HAVING criterion to the query and return the
newly resulting <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.having" title="sqlalchemy.orm.Query.having"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.having()</span></code></a> is used in conjunction with
<a class="reference internal" href="#sqlalchemy.orm.Query.group_by" title="sqlalchemy.orm.Query.group_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.group_by()</span></code></a>.</p>
<p>HAVING criterion makes it possible to use filters on aggregate
functions like COUNT, SUM, AVG, MAX, and MIN, eg.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = (</span>
<span class="go">    session.query(User.id)</span>
<span class="go">    .join(User.addresses)</span>
<span class="go">    .group_by(User.id)</span>
<span class="go">    .having(func.count(Address.id) &gt; 2)</span>
<span class="go">)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.having" title="sqlalchemy.sql.expression.Select.having"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.having()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.instances">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result_proxy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.CursorResult" title="sqlalchemy.engine.CursorResult"><span class="pre">CursorResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../internals.html#sqlalchemy.orm.QueryContext" title="sqlalchemy.orm.QueryContext"><span class="pre">QueryContext</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.instances" title="Link to this definition">¶</a></dt>
<dd><p>Return an ORM result given a <a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.CursorResult" title="sqlalchemy.engine.CursorResult"><code class="xref py py-class docutils literal notranslate"><span class="pre">CursorResult</span></code></a> and
<a class="reference internal" href="../internals.html#sqlalchemy.orm.QueryContext" title="sqlalchemy.orm.QueryContext"><code class="xref py py-class docutils literal notranslate"><span class="pre">QueryContext</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.instances" title="sqlalchemy.orm.Query.instances"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.instances()</span></code></a> method is deprecated and will be removed in a future release. Use the Select.from_statement() method or aliased() construct in conjunction with Session.execute() instead.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.intersect">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">intersect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.intersect" title="Link to this definition">¶</a></dt>
<dd><p>Produce an INTERSECT of this Query against one or more queries.</p>
<p>Works the same way as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.union()</span></code>. See
that method for usage examples.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.intersect" title="sqlalchemy.sql.expression.Select.intersect"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.intersect()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.intersect_all">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">intersect_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.intersect_all" title="Link to this definition">¶</a></dt>
<dd><p>Produce an INTERSECT ALL of this Query against one or more queries.</p>
<p>Works the same way as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.union()</span></code>. See
that method for usage examples.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.intersect_all" title="sqlalchemy.sql.expression.Select.intersect_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.intersect_all()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.is_single_entity">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">is_single_entity</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.is_single_entity" title="Link to this definition">¶</a></dt>
<dd><p>Indicates if this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
returns tuples or single entities.</p>
<p>Returns True if this query returns a single entity for each instance
in its result list, and False if this query returns a tuple of entities
for each result.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.only_return_tuples" title="sqlalchemy.orm.Query.only_return_tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.only_return_tuples()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.join">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_JoinTargetArgument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onclause</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_OnClauseArgument</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isouter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.join" title="Link to this definition">¶</a></dt>
<dd><p>Create a SQL JOIN against this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
object’s criterion
and apply generatively, returning the newly resulting
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p><strong>Simple Relationship Joins</strong></p>
<p>Consider a mapping between two classes <code class="docutils literal notranslate"><span class="pre">User</span></code> and <code class="docutils literal notranslate"><span class="pre">Address</span></code>,
with a relationship <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> representing a collection
of <code class="docutils literal notranslate"><span class="pre">Address</span></code> objects associated with each <code class="docutils literal notranslate"><span class="pre">User</span></code>.   The most
common usage of <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>
is to create a JOIN along this
relationship, using the <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> attribute as an indicator
for how this should occur:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(User).join(User.addresses)</span></pre></div>
</div>
<p>Where above, the call to <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> along
<code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> will result in SQL approximately equivalent to:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">name</span>
<span class="k">FROM</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">.</span><span class="n">user_id</span></pre></div>
</div>
<p>In the above example we refer to <code class="docutils literal notranslate"><span class="pre">User.addresses</span></code> as passed to
<a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> as the “on clause”, that is, it indicates
how the “ON” portion of the JOIN should be constructed.</p>
<p>To construct a chain of joins, multiple <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>
calls may be used.  The relationship-bound attribute implies both
the left and right side of the join at once:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = (</span>
<span class="go">    session.query(User)</span>
<span class="go">    .join(User.orders)</span>
<span class="go">    .join(Order.items)</span>
<span class="go">    .join(Item.keywords)</span>
<span class="go">)</span></pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>as seen in the above example, <strong>the order in which each
call to the join() method occurs is important</strong>.    Query would not,
for example, know how to join correctly if we were to specify
<code class="docutils literal notranslate"><span class="pre">User</span></code>, then <code class="docutils literal notranslate"><span class="pre">Item</span></code>, then <code class="docutils literal notranslate"><span class="pre">Order</span></code>, in our chain of joins; in
such a case, depending on the arguments passed, it may raise an
error that it doesn’t know how to join, or it may produce invalid
SQL in which case the database will raise an error. In correct
practice, the
<a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> method is invoked in such a way that lines
up with how we would want the JOIN clauses in SQL to be
rendered, and each call should represent a clear link from what
precedes it.</p>
</div>
<p><strong>Joins to a Target Entity or Selectable</strong></p>
<p>A second form of <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> allows any mapped entity or
core selectable construct as a target.   In this usage,
<a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> will attempt to create a JOIN along the
natural foreign key relationship between two entities:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(User).join(Address)</span></pre></div>
</div>
<p>In the above calling form, <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> is called upon to
create the “on clause” automatically for us.  This calling form will
ultimately raise an error if either there are no foreign keys between
the two entities, or if there are multiple foreign key linkages between
the target entity and the entity or entities already present on the
left side such that creating a join requires more information.  Note
that when indicating a join to a target without any ON clause, ORM
configured relationships are not taken into account.</p>
<p><strong>Joins to a Target with an ON Clause</strong></p>
<p>The third calling form allows both the target entity as well
as the ON clause to be passed explicitly.    A example that includes
a SQL expression as the ON clause is as follows:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(User).join(Address, User.id == Address.user_id)</span></pre></div>
</div>
<p>The above form may also use a relationship-bound attribute as the
ON clause as well:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(User).join(Address, User.addresses)</span></pre></div>
</div>
<p>The above syntax can be useful for the case where we wish
to join to an alias of a particular target entity.  If we wanted
to join to <code class="docutils literal notranslate"><span class="pre">Address</span></code> twice, it could be achieved using two
aliases set up using the <a class="reference internal" href="api.html#sqlalchemy.orm.aliased" title="sqlalchemy.orm.aliased"><code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code></a> function:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">a1 = aliased(Address)</span>
<span class="go">a2 = aliased(Address)</span>

<span class="go">q = (</span>
<span class="go">    session.query(User)</span>
<span class="go">    .join(a1, User.addresses)</span>
<span class="go">    .join(a2, User.addresses)</span>
<span class="go">    .filter(a1.email_address == &quot;ed@foo.com&quot;)</span>
<span class="go">    .filter(a2.email_address == &quot;ed@bar.com&quot;)</span>
<span class="go">)</span></pre></div>
</div>
<p>The relationship-bound calling form can also specify a target entity
using the <a class="reference internal" href="../internals.html#sqlalchemy.orm.PropComparator.of_type" title="sqlalchemy.orm.PropComparator.of_type"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PropComparator.of_type()</span></code></a> method; a query
equivalent to the one above would be:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">a1 = aliased(Address)</span>
<span class="go">a2 = aliased(Address)</span>

<span class="go">q = (</span>
<span class="go">    session.query(User)</span>
<span class="go">    .join(User.addresses.of_type(a1))</span>
<span class="go">    .join(User.addresses.of_type(a2))</span>
<span class="go">    .filter(a1.email_address == &quot;ed@foo.com&quot;)</span>
<span class="go">    .filter(a2.email_address == &quot;ed@bar.com&quot;)</span>
<span class="go">)</span></pre></div>
</div>
<p><strong>Augmenting Built-in ON Clauses</strong></p>
<p>As a substitute for providing a full custom ON condition for an
existing relationship, the <a class="reference internal" href="../internals.html#sqlalchemy.orm.PropComparator.and_" title="sqlalchemy.orm.PropComparator.and_"><code class="xref py py-meth docutils literal notranslate"><span class="pre">PropComparator.and_()</span></code></a> function
may be applied to a relationship attribute to augment additional
criteria into the ON clause; the additional criteria will be combined
with the default criteria using AND:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(User).join(</span>
<span class="go">    User.addresses.and_(Address.email_address != &quot;foo@bar.com&quot;)</span>
<span class="go">)</span></pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入.</span></p>
</div>
<p><strong>Joining to Tables and Subqueries</strong></p>
<p>The target of a join may also be any table or SELECT statement,
which may be related to a target entity or not.   Use the
appropriate <code class="docutils literal notranslate"><span class="pre">.subquery()</span></code> method in order to make a subquery
out of a query:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">subq = (</span>
<span class="go">    session.query(Address)</span>
<span class="go">    .filter(Address.email_address == &quot;ed@foo.com&quot;)</span>
<span class="go">    .subquery()</span>
<span class="go">)</span>


<span class="go">q = session.query(User).join(subq, User.id == subq.c.user_id)</span></pre></div>
</div>
<p>Joining to a subquery in terms of a specific relationship and/or
target entity may be achieved by linking the subquery to the
entity using <a class="reference internal" href="api.html#sqlalchemy.orm.aliased" title="sqlalchemy.orm.aliased"><code class="xref py py-func docutils literal notranslate"><span class="pre">aliased()</span></code></a>:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">subq = (</span>
<span class="go">    session.query(Address)</span>
<span class="go">    .filter(Address.email_address == &quot;ed@foo.com&quot;)</span>
<span class="go">    .subquery()</span>
<span class="go">)</span>

<span class="go">address_subq = aliased(Address, subq)</span>

<span class="go">q = session.query(User).join(User.addresses.of_type(address_subq))</span></pre></div>
</div>
<p><strong>Controlling what to Join From</strong></p>
<p>In cases where the left side of the current state of
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> is not in line with what we want to join from,
the <a class="reference internal" href="#sqlalchemy.orm.Query.select_from" title="sqlalchemy.orm.Query.select_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code></a> method may be used:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = (</span>
<span class="go">    session.query(Address)</span>
<span class="go">    .select_from(User)</span>
<span class="go">    .join(User.addresses)</span>
<span class="go">    .filter(User.name == &quot;ed&quot;)</span>
<span class="go">)</span></pre></div>
</div>
<p>Which will produce SQL similar to:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">address</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">user</span>
<span class="w">    </span><span class="k">JOIN</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">:</span><span class="n">name_1</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.join" title="sqlalchemy.sql.expression.Select.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.join()</span></code></a> - v2 equivalent method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.join.params.*props"></span><strong>*props</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.join.params.*props">¶</a> – Incoming arguments for <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>,
the props collection in modern use should be considered to be a  one
or two argument form, either as a single “target” entity or ORM
attribute-bound relationship, or as a target entity plus an “on
clause” which  may be a SQL expression or ORM attribute-bound
relationship.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.join.params.isouter"></span><strong>isouter=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.join.params.isouter">¶</a> – If True, the join used will be a left outer join,
just as if the <a class="reference internal" href="#sqlalchemy.orm.Query.outerjoin" title="sqlalchemy.orm.Query.outerjoin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.outerjoin()</span></code></a> method were called.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.join.params.full"></span><strong>full=False</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.join.params.full">¶</a> – render FULL OUTER JOIN; implies <code class="docutils literal notranslate"><span class="pre">isouter</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.label">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/sqlelement.html#sqlalchemy.sql.expression.Label" title="sqlalchemy.sql.expression.Label"><span class="pre">Label</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.label" title="Link to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, converted
to a scalar subquery with a label of the given name.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.label" title="sqlalchemy.sql.expression.Select.label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.label()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.lazy_loaded_from">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">lazy_loaded_from</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.lazy_loaded_from" title="Link to this definition">¶</a></dt>
<dd><p>An <a class="reference internal" href="../internals.html#sqlalchemy.orm.InstanceState" title="sqlalchemy.orm.InstanceState"><code class="xref py py-class docutils literal notranslate"><span class="pre">InstanceState</span></code></a> that is using this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
for a lazy load operation.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 1.4 版本弃用: </span>This attribute should be viewed via the
<a class="reference internal" href="../session_api.html#sqlalchemy.orm.ORMExecuteState.lazy_loaded_from" title="sqlalchemy.orm.ORMExecuteState.lazy_loaded_from"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ORMExecuteState.lazy_loaded_from</span></code></a> attribute, within
the context of the <a class="reference internal" href="../events.html#sqlalchemy.orm.SessionEvents.do_orm_execute" title="sqlalchemy.orm.SessionEvents.do_orm_execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SessionEvents.do_orm_execute()</span></code></a>
event.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../session_api.html#sqlalchemy.orm.ORMExecuteState.lazy_loaded_from" title="sqlalchemy.orm.ORMExecuteState.lazy_loaded_from"><code class="xref py py-attr docutils literal notranslate"><span class="pre">ORMExecuteState.lazy_loaded_from</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.limit">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_LimitOffsetType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.limit" title="Link to this definition">¶</a></dt>
<dd><p>Apply a <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code> to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.limit" title="sqlalchemy.sql.expression.Select.limit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.limit()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.merge_result">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">merge_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.FrozenResult" title="sqlalchemy.engine.FrozenResult"><span class="pre">FrozenResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../core/defaults.html#sqlalchemy.schema.Sequence" title="sqlalchemy.schema.Sequence"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.FrozenResult" title="sqlalchemy.engine.FrozenResult"><span class="pre">FrozenResult</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.merge_result" title="Link to this definition">¶</a></dt>
<dd><p>Merge a result into this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object’s Session.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.merge_result" title="sqlalchemy.orm.Query.merge_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.merge_result()</span></code></a> method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. The method is superseded by the <a class="reference internal" href="../internals.html#sqlalchemy.orm.merge_frozen_result" title="sqlalchemy.orm.merge_frozen_result"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_frozen_result()</span></code></a> function. (Background on SQLAlchemy 2.0 at: <a class="reference internal" href="../../changelog/migration_20.html#migration-20-toplevel"><span class="std std-ref">SQLAlchemy 2.0 - Major Migration Guide</span></a>)</p>
</div>
<p>Given an iterator returned by a <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
of the same structure
as this one, return an identical iterator of results, with all mapped
instances merged into the session using <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.merge" title="sqlalchemy.orm.Session.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code></a>. This
is an optimized method which will merge all mapped instances,
preserving the structure of the result rows and unmapped columns with
less method overhead than that of calling <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.merge" title="sqlalchemy.orm.Session.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code></a>
explicitly for each value.</p>
<p>The structure of the results is determined based on the column list of
this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> - if these do not correspond,
unchecked errors
will occur.</p>
<p>The ‘load’ argument is the same as that of <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.merge" title="sqlalchemy.orm.Session.merge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.merge()</span></code></a>.</p>
<p>For an example of how <a class="reference internal" href="#sqlalchemy.orm.Query.merge_result" title="sqlalchemy.orm.Query.merge_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.merge_result()</span></code></a> is used, see
the source code for the example <a class="reference internal" href="../examples.html#examples-caching"><span class="std std-ref">Dogpile 缓存</span></a>, where
<a class="reference internal" href="#sqlalchemy.orm.Query.merge_result" title="sqlalchemy.orm.Query.merge_result"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.merge_result()</span></code></a> is used to efficiently restore state
from a cache back into a target <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.offset">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">offset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_LimitOffsetType</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.offset" title="Link to this definition">¶</a></dt>
<dd><p>Apply an <code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> to the query and return the newly resulting
<code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.offset" title="sqlalchemy.sql.expression.Select.offset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.offset()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.one">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_T</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.one" title="Link to this definition">¶</a></dt>
<dd><p>Return exactly one result or raise an exception.</p>
<p>Raises <code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.exc.NoResultFound</span></code> if the query selects
no rows.  Raises <code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.exc.MultipleResultsFound</span></code>
if multiple object identities are returned, or if multiple
rows are returned for a query that returns only scalar values
as opposed to full identity-mapped entities.</p>
<p>Calling <a class="reference internal" href="#sqlalchemy.orm.Query.one" title="sqlalchemy.orm.Query.one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">one()</span></code></a> results in an execution of the underlying query.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.first" title="sqlalchemy.orm.Query.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.one_or_none" title="sqlalchemy.orm.Query.one_or_none"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></a></p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.one" title="sqlalchemy.engine.Result.one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.one()</span></code></a> - v2 comparable method.</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.scalar_one" title="sqlalchemy.engine.Result.scalar_one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.scalar_one()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.one_or_none">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">one_or_none</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_T</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.one_or_none" title="Link to this definition">¶</a></dt>
<dd><p>Return at most one result or raise an exception.</p>
<p>Returns <code class="docutils literal notranslate"><span class="pre">None</span></code> if the query selects
no rows.  Raises <code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.exc.MultipleResultsFound</span></code>
if multiple object identities are returned, or if multiple
rows are returned for a query that returns only scalar values
as opposed to full identity-mapped entities.</p>
<p>Calling <a class="reference internal" href="#sqlalchemy.orm.Query.one_or_none" title="sqlalchemy.orm.Query.one_or_none"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></a>
results in an execution of the
underlying query.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.first" title="sqlalchemy.orm.Query.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.one" title="sqlalchemy.orm.Query.one"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.one()</span></code></a></p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.one_or_none" title="sqlalchemy.engine.Result.one_or_none"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.one_or_none()</span></code></a> - v2 comparable method.</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.scalar_one_or_none" title="sqlalchemy.engine.Result.scalar_one_or_none"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.scalar_one_or_none()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.only_return_tuples">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">only_return_tuples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.only_return_tuples" title="Link to this definition">¶</a></dt>
<dd><p>When set to True, the query results will always be a
<a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Row" title="sqlalchemy.engine.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> object.</p>
<p>This can change a query that normally returns a single entity
as a scalar to return a <a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Row" title="sqlalchemy.engine.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> result in all cases.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.tuples" title="sqlalchemy.orm.Query.tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.tuples()</span></code></a> - returns tuples, but also at the typing
level will type results as <code class="docutils literal notranslate"><span class="pre">Tuple</span></code>.</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.is_single_entity" title="sqlalchemy.orm.Query.is_single_entity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.is_single_entity()</span></code></a></p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.tuples" title="sqlalchemy.engine.Result.tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.tuples()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.options">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ExecutableOption</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.options" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object,
applying the given list of
mapper options.</p>
<p>Most supplied options regard changing how column- and
relationship-mapped attributes are loaded.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="columns.html#loading-columns"><span class="std std-ref">列加载选项</span></a></p>
<p><a class="reference internal" href="relationships.html#relationship-loader-options"><span class="std std-ref">使用加载器选项进行关系加载</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.order_by">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">order_by</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_Query__first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">False</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NoArg.NO_ARG</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_ColumnExpressionOrStrLabelArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">_NoArg.NO_ARG</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">clauses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionOrStrLabelArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.order_by" title="Link to this definition">¶</a></dt>
<dd><p>Apply one or more ORDER BY criteria to the query and return
the newly resulting <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p>e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = session.query(Entity).order_by(Entity.id, Entity.name)</span></pre></div>
</div>
<p>Calling this method multiple times is equivalent to calling it once
with all the clauses concatenated. All existing ORDER BY criteria may
be cancelled by passing <code class="docutils literal notranslate"><span class="pre">None</span></code> by itself.  New ORDER BY criteria may
then be added by invoking <a class="reference internal" href="#sqlalchemy.orm.Query.order_by" title="sqlalchemy.orm.Query.order_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.order_by()</span></code></a> again, e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go"># will erase all ORDER BY and ORDER BY new_col alone</span>
<span class="go">q = q.order_by(None).order_by(new_col)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p>These sections describe ORDER BY in terms of <a class="reference internal" href="../../glossary.html#term-2.0-style"><span class="xref std std-term">2.0 style</span></a>
invocation but apply to <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> as well:</p>
<p><a class="reference internal" href="../../tutorial/data_select.html#tutorial-order-by"><span class="std std-ref">ORDER BY</span></a> - in the <a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy 统一教程</span></a></p>
<p><a class="reference internal" href="../../tutorial/data_select.html#tutorial-order-by-label"><span class="std std-ref">按标签排序或分组</span></a> - in the <a class="reference internal" href="../../tutorial/index.html#unified-tutorial"><span class="std std-ref">SQLAlchemy 统一教程</span></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.order_by" title="sqlalchemy.sql.expression.Select.order_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.order_by()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.outerjoin">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">outerjoin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_JoinTargetArgument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onclause</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_OnClauseArgument</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.outerjoin" title="Link to this definition">¶</a></dt>
<dd><p>Create a left outer join against this <code class="docutils literal notranslate"><span class="pre">Query</span></code> object’s criterion
and apply generatively, returning the newly resulting <code class="docutils literal notranslate"><span class="pre">Query</span></code>.</p>
<p>Usage is the same as the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.outerjoin" title="sqlalchemy.sql.expression.Select.outerjoin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.outerjoin()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.params">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">_Query__params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">/</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.params" title="Link to this definition">¶</a></dt>
<dd><p>Add values for bind parameters which may have been
specified in filter().</p>
<p>Parameters may be specified using **kwargs, or optionally a single
dictionary as the first positional argument. The reason for both is
that **kwargs is convenient, however some parameter dictionaries
contain unicode keys in which case **kwargs cannot be used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.populate_existing">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">populate_existing</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.populate_existing" title="Link to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
that will expire and refresh all instances
as they are loaded, or reused from the current <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.</p>
<p>As of SQLAlchemy 1.4, the <a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing" title="sqlalchemy.orm.Query.populate_existing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.populate_existing()</span></code></a> method
is equivalent to using the <code class="docutils literal notranslate"><span class="pre">populate_existing</span></code> execution option at
the ORM level. See the section <a class="reference internal" href="api.html#orm-queryguide-populate-existing"><span class="std std-ref">填充现有</span></a>
for further background on this option.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.prefix_with">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">prefix_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">prefixes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_TextCoercedExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dialect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'*'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.prefix_with" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasPrefixes.prefix_with" title="sqlalchemy.sql.expression.HasPrefixes.prefix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasPrefixes.prefix_with()</span></code></a> <em>method of</em> <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasPrefixes" title="sqlalchemy.sql.expression.HasPrefixes"><code class="xref py py-class docutils literal notranslate"><span class="pre">HasPrefixes</span></code></a></p>
</div>
<p>Add one or more expressions following the statement keyword, i.e.
SELECT, INSERT, UPDATE, or DELETE. Generative.</p>
<p>This is used to support backend-specific prefix keywords such as those
provided by MySQL.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">stmt = table.insert().prefix_with(&quot;LOW_PRIORITY&quot;, dialect=&quot;mysql&quot;)</span>

<span class="go"># MySQL 5.7 optimizer hints</span>
<span class="go">stmt = select(table).prefix_with(&quot;/*+ BKA(t1) */&quot;, dialect=&quot;mysql&quot;)</span></pre></div>
</div>
<p>Multiple prefixes can be specified by multiple calls
to <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasPrefixes.prefix_with" title="sqlalchemy.sql.expression.HasPrefixes.prefix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasPrefixes.prefix_with()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.prefix_with.params.*prefixes"></span><strong>*prefixes</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.prefix_with.params.*prefixes">¶</a> – textual or <a class="reference internal" href="../../core/foundation.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
construct which
will be rendered following the INSERT, UPDATE, or DELETE
keyword.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.prefix_with.params.dialect"></span><strong>dialect</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.prefix_with.params.dialect">¶</a> – optional string dialect name which will
limit rendering of this prefix to only that dialect.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.reset_joinpoint">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">reset_joinpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.reset_joinpoint" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, where the “join point” has
been reset back to the base FROM entities of the query.</p>
<p>This method is usually used in conjunction with the
<code class="docutils literal notranslate"><span class="pre">aliased=True</span></code> feature of the <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>
method.  See the example in <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> for how
this is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.scalar">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">scalar</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.scalar" title="Link to this definition">¶</a></dt>
<dd><p>Return the first element of the first result or None
if no rows present.  If multiple rows are returned,
raises MultipleResultsFound.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">&lt;Item&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">Item</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">Item</span><span class="o">.</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">Parent</span><span class="o">.</span><span class="n">id</span><span class="p">))</span><span class="o">.</span><span class="n">scalar</span><span class="p">()</span>
<span class="go">20</span></pre></div>
</div>
<p>This results in an execution of the underlying query.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.scalar" title="sqlalchemy.engine.Result.scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.scalar()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.scalar_subquery">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">scalar_subquery</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.ScalarSelect" title="sqlalchemy.sql.expression.ScalarSelect"><span class="pre">ScalarSelect</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.scalar_subquery" title="Link to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, converted to a scalar subquery.</p>
<p>Analogous to
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.SelectBase.scalar_subquery" title="sqlalchemy.sql.expression.SelectBase.scalar_subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SelectBase.scalar_subquery()</span></code></a>.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 1.4 版本发生变更: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.scalar_subquery" title="sqlalchemy.orm.Query.scalar_subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.scalar_subquery()</span></code></a>
method replaces the <a class="reference internal" href="#sqlalchemy.orm.Query.as_scalar" title="sqlalchemy.orm.Query.as_scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.as_scalar()</span></code></a> method.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.scalar_subquery" title="sqlalchemy.sql.expression.Select.scalar_subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.scalar_subquery()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.select_from">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">select_from</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">from_obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">FromClauseRole</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Inspectable</span><span class="p"><span class="pre">[</span></span><span class="pre">_HasClauseElement</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_HasClauseElement</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.select_from" title="Link to this definition">¶</a></dt>
<dd><p>Set the FROM clause of this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> explicitly.</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.select_from" title="sqlalchemy.orm.Query.select_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_from()</span></code></a> is often used in conjunction with
<a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a> in order to control which entity is selected
from on the “left” side of the join.</p>
<p>The entity or selectable object here effectively replaces the
“left edge” of any calls to <a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a>, when no
joinpoint is otherwise established - usually, the default “join
point” is the leftmost entity in the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object’s
list of entities to be selected.</p>
<p>A typical example:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = (</span>
<span class="go">    session.query(Address)</span>
<span class="go">    .select_from(User)</span>
<span class="go">    .join(User.addresses)</span>
<span class="go">    .filter(User.name == &quot;ed&quot;)</span>
<span class="go">)</span></pre></div>
</div>
<p>Which produces SQL equivalent to:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">address</span><span class="p">.</span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">user</span>
<span class="k">JOIN</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">address</span><span class="p">.</span><span class="n">user_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="k">user</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">:</span><span class="n">name_1</span></pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="target" id="sqlalchemy.orm.Query.select_from.params.*from_obj"></span><strong>*from_obj</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.select_from.params.*from_obj">¶</a> – collection of one or more entities to apply
to the FROM clause.  Entities can be mapped classes,
<a class="reference internal" href="api.html#sqlalchemy.orm.util.AliasedClass" title="sqlalchemy.orm.util.AliasedClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">AliasedClass</span></code></a> objects, <a class="reference internal" href="../mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> objects
as well as core <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.FromClause" title="sqlalchemy.sql.expression.FromClause"><code class="xref py py-class docutils literal notranslate"><span class="pre">FromClause</span></code></a> elements like subqueries.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.join" title="sqlalchemy.orm.Query.join"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.join()</span></code></a></p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.select_entity_from()</span></code></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.select_from" title="sqlalchemy.sql.expression.Select.select_from"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.select_from()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.selectable">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">selectable</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.selectable" title="Link to this definition">¶</a></dt>
<dd><p>Return the <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select" title="sqlalchemy.sql.expression.Select"><code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code></a> object emitted by this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p>Used for <a class="reference internal" href="../../core/inspection.html#sqlalchemy.inspect" title="sqlalchemy.inspect"><code class="xref py py-func docutils literal notranslate"><span class="pre">inspect()</span></code></a> compatibility, this is equivalent to:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">query.enable_eagerloads(False).with_labels().statement</span></pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.set_label_style">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">set_label_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.SelectLabelStyle" title="sqlalchemy.sql.selectable.SelectLabelStyle"><span class="pre">SelectLabelStyle</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.set_label_style" title="Link to this definition">¶</a></dt>
<dd><p>Apply column labels to the return value of Query.statement.</p>
<p>Indicates that this Query’s <cite>statement</cite> accessor should return
a SELECT statement that applies labels to all columns in the
form &lt;tablename&gt;_&lt;columnname&gt;; this is commonly used to
disambiguate columns from multiple tables which have the same
name.</p>
<p>When the <cite>Query</cite> actually issues SQL to load rows, it always
uses column labeling.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The <a class="reference internal" href="#sqlalchemy.orm.Query.set_label_style" title="sqlalchemy.orm.Query.set_label_style"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.set_label_style()</span></code></a> method <em>only</em> applies
the output of <a class="reference internal" href="#sqlalchemy.orm.Query.statement" title="sqlalchemy.orm.Query.statement"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code></a>, and <em>not</em> to any of
the result-row invoking systems of <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> itself,
e.g.
<a class="reference internal" href="#sqlalchemy.orm.Query.first" title="sqlalchemy.orm.Query.first"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.first()</span></code></a>, <a class="reference internal" href="#sqlalchemy.orm.Query.all" title="sqlalchemy.orm.Query.all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.all()</span></code></a>, etc.
To execute
a query using <a class="reference internal" href="#sqlalchemy.orm.Query.set_label_style" title="sqlalchemy.orm.Query.set_label_style"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.set_label_style()</span></code></a>, invoke the
<a class="reference internal" href="#sqlalchemy.orm.Query.statement" title="sqlalchemy.orm.Query.statement"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Query.statement</span></code></a> using <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.execute" title="sqlalchemy.orm.Session.execute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.execute()</span></code></a>:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">result = session.execute(</span>
<span class="go">    query.set_label_style(LABEL_STYLE_TABLENAME_PLUS_COL).statement</span>
<span class="go">)</span></pre></div>
</div>
</div>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.set_label_style" title="sqlalchemy.sql.expression.Select.set_label_style"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.set_label_style()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.slice">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.slice" title="Link to this definition">¶</a></dt>
<dd><p>Computes the “slice” of the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> represented by
the given indices and returns the resulting <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<p>The start and stop indices behave like the argument to Python’s
built-in <code class="xref py py-func docutils literal notranslate"><span class="pre">range()</span></code> function. This method provides an
alternative to using <code class="docutils literal notranslate"><span class="pre">LIMIT</span></code>/<code class="docutils literal notranslate"><span class="pre">OFFSET</span></code> to get a slice of the
query.</p>
<p>For example,</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">session.query(User).order_by(User.id).slice(1, 3)</span></pre></div>
</div>
<p>renders as</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">users_id</span><span class="p">,</span>
<span class="w">       </span><span class="n">users</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">users_name</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">id</span>
<span class="k">LIMIT</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">OFFSET</span><span class="w"> </span><span class="o">?</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.limit" title="sqlalchemy.orm.Query.limit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.limit()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.offset" title="sqlalchemy.orm.Query.offset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.offset()</span></code></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.slice" title="sqlalchemy.sql.expression.Select.slice"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.slice()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.statement">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">statement</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.statement" title="Link to this definition">¶</a></dt>
<dd><p>The full SELECT statement represented by this Query.</p>
<p>The statement by default will not have disambiguating labels
applied to the construct unless with_labels(True) is called
first.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.subquery">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">subquery</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Subquery" title="sqlalchemy.sql.expression.Subquery"><span class="pre">Subquery</span></a></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.subquery" title="Link to this definition">¶</a></dt>
<dd><p>Return the full SELECT statement represented by
this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>, embedded within an
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal notranslate"><span class="pre">Alias</span></code></a>.</p>
<p>Eager JOIN generation within the query is disabled.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.subquery" title="sqlalchemy.sql.expression.Select.subquery"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.subquery()</span></code></a> - v2 comparable method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.subquery.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.subquery.params.name">¶</a> – string name to be assigned as the alias;
this is passed through to <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.FromClause.alias" title="sqlalchemy.sql.expression.FromClause.alias"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FromClause.alias()</span></code></a>.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a name will be deterministically generated
at compile time.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.subquery.params.with_labels"></span><strong>with_labels</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.subquery.params.with_labels">¶</a> – if True, <a class="reference internal" href="#sqlalchemy.orm.Query.with_labels" title="sqlalchemy.orm.Query.with_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">with_labels()</span></code></a> will be called
on the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> first to apply table-qualified labels
to all columns.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.subquery.params.reduce_columns"></span><strong>reduce_columns</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.subquery.params.reduce_columns">¶</a> – if True,
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.reduce_columns" title="sqlalchemy.sql.expression.Select.reduce_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.reduce_columns()</span></code></a> will
be called on the resulting <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.select" title="sqlalchemy.sql.expression.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> construct,
to remove same-named columns where one also refers to the other
via foreign key or WHERE clause equivalence.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.suffix_with">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">suffix_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">suffixes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_TextCoercedExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dialect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'*'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.suffix_with" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasSuffixes.suffix_with" title="sqlalchemy.sql.expression.HasSuffixes.suffix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasSuffixes.suffix_with()</span></code></a> <em>method of</em> <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasSuffixes" title="sqlalchemy.sql.expression.HasSuffixes"><code class="xref py py-class docutils literal notranslate"><span class="pre">HasSuffixes</span></code></a></p>
</div>
<p>Add one or more expressions following the statement as a whole.</p>
<p>This is used to support backend-specific suffix keywords on
certain constructs.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">stmt = (</span>
<span class="go">    select(col1, col2)</span>
<span class="go">    .cte()</span>
<span class="go">    .suffix_with(</span>
<span class="go">        &quot;cycle empno set y_cycle to 1 default 0&quot;, dialect=&quot;oracle&quot;</span>
<span class="go">    )</span>
<span class="go">)</span></pre></div>
</div>
<p>Multiple suffixes can be specified by multiple calls
to <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.HasSuffixes.suffix_with" title="sqlalchemy.sql.expression.HasSuffixes.suffix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HasSuffixes.suffix_with()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.suffix_with.params.*suffixes"></span><strong>*suffixes</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.suffix_with.params.*suffixes">¶</a> – textual or <a class="reference internal" href="../../core/foundation.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
construct which
will be rendered following the target clause.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.suffix_with.params.dialect"></span><strong>dialect</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.suffix_with.params.dialect">¶</a> – Optional string dialect name which will
limit rendering of this suffix to only that dialect.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.tuples">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">tuples</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.tuples" title="Link to this definition">¶</a></dt>
<dd><p>return a tuple-typed form of this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.1.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.tuples" title="sqlalchemy.orm.Query.tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.tuples()</span></code></a> method is deprecated, <a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Row" title="sqlalchemy.engine.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> now behaves like a tuple and can unpack types directly.</p>
</div>
<p>This method invokes the <a class="reference internal" href="#sqlalchemy.orm.Query.only_return_tuples" title="sqlalchemy.orm.Query.only_return_tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.only_return_tuples()</span></code></a>
method with a value of <code class="docutils literal notranslate"><span class="pre">True</span></code>, which by itself ensures that this
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> will always return <a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Row" title="sqlalchemy.engine.Row"><code class="xref py py-class docutils literal notranslate"><span class="pre">Row</span></code></a> objects, even
if the query is made against a single entity.  It then also
at the typing level will return a “typed” query, if possible,
that will type result rows as <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> objects with typed
elements.</p>
<p>This method can be compared to the <a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.tuples" title="sqlalchemy.engine.Result.tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.tuples()</span></code></a> method,
which returns “self”, but from a typing perspective returns an object
that will yield typed <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> objects for results.   Typing
takes effect only if this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object is a typed
query object already.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 2.0 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../changelog/migration_21.html#change-10635"><span class="std std-ref">Row 现在直接表示单个列类型，无需 Tuple</span></a> - describes a migration path from this
workaround for SQLAlchemy 2.1.</p>
<p><a class="reference internal" href="../../core/connections.html#sqlalchemy.engine.Result.tuples" title="sqlalchemy.engine.Result.tuples"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Result.tuples()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.union">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.union" title="Link to this definition">¶</a></dt>
<dd><p>Produce a UNION of this Query against one or more queries.</p>
<p>e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q1 = sess.query(SomeClass).filter(SomeClass.foo == &quot;bar&quot;)</span>
<span class="go">q2 = sess.query(SomeClass).filter(SomeClass.bar == &quot;foo&quot;)</span>

<span class="go">q3 = q1.union(q2)</span></pre></div>
</div>
<p>The method accepts multiple Query objects so as to control
the level of nesting.  A series of <code class="docutils literal notranslate"><span class="pre">union()</span></code> calls such as:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">x.union(y).union(z).all()</span></pre></div>
</div>
<p>will nest on each <code class="docutils literal notranslate"><span class="pre">union()</span></code>, and produces:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="k">UNION</span>
<span class="w">                </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Z</span><span class="p">)</span></pre></div>
</div>
<p>Whereas:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">x.union(y, z).all()</span></pre></div>
</div>
<p>produces:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="k">UNION</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="k">UNION</span>
<span class="w">                </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Z</span><span class="p">)</span></pre></div>
</div>
<p>Note that many database backends do not allow ORDER BY to
be rendered on a query called within UNION, EXCEPT, etc.
To disable all ORDER BY clauses including those configured
on mappers, issue <code class="docutils literal notranslate"><span class="pre">query.order_by(None)</span></code> - the resulting
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object will not render ORDER BY within
its SELECT statement.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.union" title="sqlalchemy.sql.expression.Select.union"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.union()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.union_all">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">union_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.union_all" title="Link to this definition">¶</a></dt>
<dd><p>Produce a UNION ALL of this Query against one or more queries.</p>
<p>Works the same way as <code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.union()</span></code>. See
that method for usage examples.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.union_all" title="sqlalchemy.sql.expression.Select.union_all"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.union_all()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.update">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">_DMLColumnArgument</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synchronize_session</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SynchronizeSessionArgument</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.update" title="Link to this definition">¶</a></dt>
<dd><p>Perform an UPDATE with an arbitrary WHERE clause.</p>
<p>Updates rows matched by this query in the database.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">sess.query(User).filter(User.age == 25).update(</span>
<span class="go">    {User.age: User.age - 10}, synchronize_session=False</span>
<span class="go">)</span>

<span class="go">sess.query(User).filter(User.age == 25).update(</span>
<span class="go">    {&quot;age&quot;: User.age - 10}, synchronize_session=&quot;evaluate&quot;</span>
<span class="go">)</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>See the section <a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</span></a> for important
caveats and warnings, including limitations when using arbitrary
UPDATE and DELETE with mapper inheritance configurations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.update.params.values"></span><strong>values</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.update.params.values">¶</a> – a dictionary with attributes names, or alternatively
mapped attributes or SQL expressions, as keys, and literal
values or sql expressions as values.   If <a class="reference internal" href="../../tutorial/data_update.html#tutorial-parameter-ordered-updates"><span class="std std-ref">parameter-ordered
mode</span></a> is desired, the values can
be passed as a list of 2-tuples; this requires that the
<a class="reference internal" href="../../core/dml.html#sqlalchemy.sql.expression.update.params.preserve_parameter_order" title="sqlalchemy.sql.expression.update"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">update.preserve_parameter_order</span></code></a>
flag is passed to the <a class="reference internal" href="#sqlalchemy.orm.Query.update.params.update_args" title="sqlalchemy.orm.Query.update"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">Query.update.update_args</span></code></a> dictionary
as well.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.update.params.synchronize_session"></span><strong>synchronize_session</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.update.params.synchronize_session">¶</a> – chooses the strategy to update the
attributes on objects in the session.   See the section
<a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</span></a> for a discussion of these
strategies.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.update.params.update_args"></span><strong>update_args</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.update.params.update_args">¶</a> – Optional dictionary, if present will be passed
to the underlying <a class="reference internal" href="../../core/dml.html#sqlalchemy.sql.expression.update" title="sqlalchemy.sql.expression.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> construct as the <code class="docutils literal notranslate"><span class="pre">**kw</span></code>
for the object.  May be used to pass dialect-specific arguments such
as <code class="docutils literal notranslate"><span class="pre">mysql_limit</span></code>, as well as other special arguments such as
<a class="reference internal" href="../../core/dml.html#sqlalchemy.sql.expression.update.params.preserve_parameter_order" title="sqlalchemy.sql.expression.update"><code class="xref py py-paramref docutils literal notranslate"><span class="pre">update.preserve_parameter_order</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">返回<span class="colon">:</span></dt>
<dd class="field-even"><p>the count of rows matched as returned by the database’s
“row count” feature.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="dml.html#orm-expression-update-delete"><span class="std std-ref">启用 ORM 的 INSERT、UPDATE 和 DELETE 语句</span></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.value">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.value" title="Link to this definition">¶</a></dt>
<dd><p>Return a scalar result corresponding to the given
column expression.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 1.4 版本弃用: </span><a class="reference internal" href="#sqlalchemy.orm.Query.value" title="sqlalchemy.orm.Query.value"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.value()</span></code></a> is deprecated and will be removed in a future release.  Please use <a class="reference internal" href="#sqlalchemy.orm.Query.with_entities" title="sqlalchemy.orm.Query.with_entities"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_entities()</span></code></a> in combination with <a class="reference internal" href="#sqlalchemy.orm.Query.scalar" title="sqlalchemy.orm.Query.scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.scalar()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.values">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnsClauseArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.values" title="Link to this definition">¶</a></dt>
<dd><p>Return an iterator yielding result tuples corresponding
to the given list of columns</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 1.4 版本弃用: </span><a class="reference internal" href="#sqlalchemy.orm.Query.values" title="sqlalchemy.orm.Query.values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.values()</span></code></a> is deprecated and will be removed in a future release.  Please use <a class="reference internal" href="#sqlalchemy.orm.Query.with_entities" title="sqlalchemy.orm.Query.with_entities"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_entities()</span></code></a></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.where">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnExpressionArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.where" title="Link to this definition">¶</a></dt>
<dd><p>A synonym for <a class="reference internal" href="#sqlalchemy.orm.Query.filter" title="sqlalchemy.orm.Query.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code></a>.</p>
<div class="versionadded">
<p><span class="versionmodified added">在 1.4 版本加入.</span></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.where" title="sqlalchemy.sql.expression.Select.where"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.where()</span></code></a> - v2 equivalent method.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.whereclause">
<em class="property"><span class="pre">attribute</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">whereclause</span></span><a class="headerlink" href="#sqlalchemy.orm.Query.whereclause" title="Link to this definition">¶</a></dt>
<dd><p>A readonly attribute which returns the current WHERE criterion for
this Query.</p>
<p>This returned value is a SQL expression construct, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no
criterion has been established.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.whereclause" title="sqlalchemy.sql.expression.Select.whereclause"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Select.whereclause</span></code></a> - v2 equivalent property.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_entities">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_entities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">entities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ColumnsClauseArgument</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">_Query__kw</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><span class="pre">Query</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_entities" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
replacing the SELECT list with the
given entities.</p>
<p>e.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go"># Users, filtered on some arbitrary criterion</span>
<span class="go"># and then ordered by related email address</span>
<span class="go">q = (</span>
<span class="go">    session.query(User)</span>
<span class="go">    .join(User.address)</span>
<span class="go">    .filter(User.name.like(&quot;%ed%&quot;))</span>
<span class="go">    .order_by(Address.email)</span>
<span class="go">)</span>

<span class="go"># given *only* User.id==5, Address.email, and &#39;q&#39;, what</span>
<span class="go"># would the *next* User in the result be ?</span>
<span class="go">subq = (</span>
<span class="go">    q.with_entities(Address.email)</span>
<span class="go">    .order_by(None)</span>
<span class="go">    .filter(User.id == 5)</span>
<span class="go">    .subquery()</span>
<span class="go">)</span>
<span class="go">q = q.join((subq, subq.c.email &lt; Address.email)).limit(1)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_only_columns" title="sqlalchemy.sql.expression.Select.with_only_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_only_columns()</span></code></a> - v2 comparable method.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_for_update">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_for_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nowait</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">of</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ForUpdateOfArgument</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_locked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_share</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_for_update" title="Link to this definition">¶</a></dt>
<dd><p>return a new <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
with the specified options for the
<code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code> clause.</p>
<p>The behavior of this method is identical to that of
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.GenerativeSelect.with_for_update" title="sqlalchemy.sql.expression.GenerativeSelect.with_for_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GenerativeSelect.with_for_update()</span></code></a>.
When called with no arguments,
the resulting <code class="docutils literal notranslate"><span class="pre">SELECT</span></code> statement will have a <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span></code> clause
appended.  When additional arguments are specified, backend-specific
options such as <code class="docutils literal notranslate"><span class="pre">FOR</span> <span class="pre">UPDATE</span> <span class="pre">NOWAIT</span></code> or <code class="docutils literal notranslate"><span class="pre">LOCK</span> <span class="pre">IN</span> <span class="pre">SHARE</span> <span class="pre">MODE</span></code>
can take effect.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">q = (</span>
<span class="go">    sess.query(User)</span>
<span class="go">    .populate_existing()</span>
<span class="go">    .with_for_update(nowait=True, of=User)</span>
<span class="go">)</span></pre></div>
</div>
<p>The above query on a PostgreSQL backend will render like:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">users</span><span class="p">.</span><span class="n">id</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">users_id</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="k">FOR</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">OF</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="n">NOWAIT</span></pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">with_for_update</span></code> in the context of eager loading
relationships is not officially supported or recommended by
SQLAlchemy and may not work with certain queries on various
database backends.  When <code class="docutils literal notranslate"><span class="pre">with_for_update</span></code> is successfully used
with a query that involves <a class="reference internal" href="relationships.html#sqlalchemy.orm.joinedload" title="sqlalchemy.orm.joinedload"><code class="xref py py-func docutils literal notranslate"><span class="pre">joinedload()</span></code></a>, SQLAlchemy will
attempt to emit SQL that locks all involved tables.</p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>It is generally a good idea to combine the use of the
<a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing" title="sqlalchemy.orm.Query.populate_existing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.populate_existing()</span></code></a> method when using the
<a class="reference internal" href="#sqlalchemy.orm.Query.with_for_update" title="sqlalchemy.orm.Query.with_for_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_for_update()</span></code></a> method.   The purpose of
<a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing" title="sqlalchemy.orm.Query.populate_existing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.populate_existing()</span></code></a> is to force all the data read
from the SELECT to be populated into the ORM objects returned,
even if these objects are already in the <a class="reference internal" href="../../glossary.html#term-identity-map"><span class="xref std std-term">identity map</span></a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.GenerativeSelect.with_for_update" title="sqlalchemy.sql.expression.GenerativeSelect.with_for_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GenerativeSelect.with_for_update()</span></code></a>
- Core level method with
full argument and behavioral description.</p>
<p><a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing" title="sqlalchemy.orm.Query.populate_existing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.populate_existing()</span></code></a> - overwrites attributes of
objects already loaded in the identity map.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_hint">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_hint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selectable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_FromClauseArgument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dialect_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'*'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_hint" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">HasHints.with_hint()</span></code> <em>method of</em> <code class="xref py py-class docutils literal notranslate"><span class="pre">HasHints</span></code></p>
</div>
<p>Add an indexing or other executional context hint for the given
selectable to this <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select" title="sqlalchemy.sql.expression.Select"><code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code></a> or other selectable
object.</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p>The <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_hint" title="sqlalchemy.sql.expression.Select.with_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_hint()</span></code></a> method adds hints that are
<strong>specific to a single table</strong> to a statement, in a location that
is <strong>dialect-specific</strong>.  To add generic optimizer hints to the
<strong>beginning</strong> of a statement ahead of the SELECT keyword such as
for MySQL or Oracle Database, use the
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.prefix_with" title="sqlalchemy.sql.expression.Select.prefix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.prefix_with()</span></code></a> method.  To add optimizer
hints to the <strong>end</strong> of a statement such as for PostgreSQL, use the
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_statement_hint" title="sqlalchemy.sql.expression.Select.with_statement_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_statement_hint()</span></code></a> method.</p>
</div>
<p>The text of the hint is rendered in the appropriate
location for the database backend in use, relative
to the given <a class="reference internal" href="../../core/metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> or <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Alias" title="sqlalchemy.sql.expression.Alias"><code class="xref py py-class docutils literal notranslate"><span class="pre">Alias</span></code></a>
passed as the
<code class="docutils literal notranslate"><span class="pre">selectable</span></code> argument. The dialect implementation
typically uses Python string substitution syntax
with the token <code class="docutils literal notranslate"><span class="pre">%(name)s</span></code> to render the name of
the table or alias. E.g. when using Oracle Database, the
following:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">select(mytable).with_hint(mytable, &quot;index(%(name)s ix_mytable)&quot;)</span></pre></div>
</div>
<p>Would render SQL as:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">select</span><span class="w"> </span><span class="cm">/*+ index(mytable ix_mytable) */</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">mytable</span></pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dialect_name</span></code> option will limit the rendering of a particular
hint to a particular backend. Such as, to add hints for both Oracle
Database and MSSql simultaneously:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">select(mytable).with_hint(</span>
<span class="go">    mytable, &quot;index(%(name)s ix_mytable)&quot;, &quot;oracle&quot;</span>
<span class="go">).with_hint(mytable, &quot;WITH INDEX ix_mytable&quot;, &quot;mssql&quot;)</span></pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_statement_hint" title="sqlalchemy.sql.expression.Select.with_statement_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_statement_hint()</span></code></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.prefix_with" title="sqlalchemy.sql.expression.Select.prefix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.prefix_with()</span></code></a> - generic SELECT prefixing
which also can suit some database-specific HINT syntaxes such as
MySQL or Oracle Database optimizer hints</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_labels">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_labels" title="Link to this definition">¶</a></dt>
<dd><div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.with_labels" title="sqlalchemy.orm.Query.with_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_labels()</span></code></a> and <a class="reference internal" href="#sqlalchemy.orm.Query.apply_labels" title="sqlalchemy.orm.Query.apply_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.apply_labels()</span></code></a> method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. Use set_label_style(LABEL_STYLE_TABLENAME_PLUS_COL) instead. (Background on SQLAlchemy 2.0 at: <a class="reference internal" href="../../changelog/migration_20.html#migration-20-toplevel"><span class="std std-ref">SQLAlchemy 2.0 - Major Migration Guide</span></a>)</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_parent">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_parent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">property</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../internals.html#sqlalchemy.orm.QueryableAttribute" title="sqlalchemy.orm.attributes.QueryableAttribute"><span class="pre">attributes.QueryableAttribute</span></a><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_ExternalEntityType</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_parent" title="Link to this definition">¶</a></dt>
<dd><p>Add filtering criterion that relates the given instance
to a child object or collection, using its attribute state
as well as an established <a class="reference internal" href="../relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a>
configuration.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 2.0 版本弃用: </span>The <a class="reference internal" href="#sqlalchemy.orm.Query.with_parent" title="sqlalchemy.orm.Query.with_parent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.with_parent()</span></code></a> method is considered legacy as of the 1.x series of SQLAlchemy and becomes a legacy construct in 2.0. Use the <a class="reference internal" href="api.html#sqlalchemy.orm.with_parent" title="sqlalchemy.orm.with_parent"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_parent()</span></code></a> standalone construct. (Background on SQLAlchemy 2.0 at: <a class="reference internal" href="../../changelog/migration_20.html#migration-20-toplevel"><span class="std std-ref">SQLAlchemy 2.0 - Major Migration Guide</span></a>)</p>
</div>
<p>The method uses the <a class="reference internal" href="api.html#sqlalchemy.orm.with_parent" title="sqlalchemy.orm.with_parent"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_parent()</span></code></a> function to generate
the clause, the result of which is passed to
<a class="reference internal" href="#sqlalchemy.orm.Query.filter" title="sqlalchemy.orm.Query.filter"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.filter()</span></code></a>.</p>
<p>Parameters are the same as <a class="reference internal" href="api.html#sqlalchemy.orm.with_parent" title="sqlalchemy.orm.with_parent"><code class="xref py py-func docutils literal notranslate"><span class="pre">with_parent()</span></code></a>, with the exception
that the given property can be None, in which case a search is
performed against this <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object’s target mapper.</p>
<dl class="field-list simple">
<dt class="field-odd">参数<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.orm.Query.with_parent.params.instance"></span><strong>instance</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.with_parent.params.instance">¶</a> – An instance which has some <a class="reference internal" href="../relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a>.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.with_parent.params.property"></span><strong>property</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.with_parent.params.property">¶</a> – Class bound attribute which indicates
what relationship from the instance should be used to reconcile the
parent/child relationship.</p></li>
<li><p><span class="target" id="sqlalchemy.orm.Query.with_parent.params.from_entity"></span><strong>from_entity</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.orm.Query.with_parent.params.from_entity">¶</a> – Entity in which to consider as the left side.  This defaults to the
“zero” entity of the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> itself.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_session">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">session</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><span class="pre">Session</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_session" title="Link to this definition">¶</a></dt>
<dd><p>Return a <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> that will use the given
<a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.</p>
<p>While the <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
object is normally instantiated using the
<a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session.query" title="sqlalchemy.orm.Session.query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Session.query()</span></code></a> method, it is legal to build the
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
directly without necessarily using a <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>.  Such a
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object, or any <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
already associated
with a different <a class="reference internal" href="../session_api.html#sqlalchemy.orm.Session" title="sqlalchemy.orm.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a>, can produce a new
<a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
object associated with a target session using this method:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">from sqlalchemy.orm import Query</span>

<span class="go">query = Query([MyClass]).filter(MyClass.id == 5)</span>

<span class="go">result = query.with_session(my_session).one()</span></pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_statement_hint">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_statement_hint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dialect_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'*'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_statement_hint" title="Link to this definition">¶</a></dt>
<dd><div class="inherited-member docutils container">
<p><em>inherited from the</em> <code class="xref py py-meth docutils literal notranslate"><span class="pre">HasHints.with_statement_hint()</span></code> <em>method of</em> <code class="xref py py-class docutils literal notranslate"><span class="pre">HasHints</span></code></p>
</div>
<p>Add a statement hint to this <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select" title="sqlalchemy.sql.expression.Select"><code class="xref py py-class docutils literal notranslate"><span class="pre">Select</span></code></a> or
other selectable object.</p>
<div class="admonition tip">
<p class="admonition-title">小技巧</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_statement_hint" title="sqlalchemy.sql.expression.Select.with_statement_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_statement_hint()</span></code></a> generally adds hints
<strong>at the trailing end</strong> of a SELECT statement.  To place
dialect-specific hints such as optimizer hints at the <strong>front</strong> of
the SELECT statement after the SELECT keyword, use the
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.prefix_with" title="sqlalchemy.sql.expression.Select.prefix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.prefix_with()</span></code></a> method for an open-ended
space, or for table-specific hints the
<a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_hint" title="sqlalchemy.sql.expression.Select.with_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_hint()</span></code></a> may be used, which places
hints in a dialect-specific location.</p>
</div>
<p>This method is similar to <a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_hint" title="sqlalchemy.sql.expression.Select.with_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_hint()</span></code></a> except
that it does not require an individual table, and instead applies to
the statement as a whole.</p>
<p>Hints here are specific to the backend database and may include
directives such as isolation levels, file directives, fetch directives,
etc.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.with_hint" title="sqlalchemy.sql.expression.Select.with_hint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.with_hint()</span></code></a></p>
<p><a class="reference internal" href="../../core/selectable.html#sqlalchemy.sql.expression.Select.prefix_with" title="sqlalchemy.sql.expression.Select.prefix_with"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Select.prefix_with()</span></code></a> - generic SELECT prefixing
which also can suit some database-specific HINT syntaxes such as
MySQL or Oracle Database optimizer hints</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.with_transformation">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">with_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.query.Query"><span class="pre">Query</span></a></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.with_transformation" title="Link to this definition">¶</a></dt>
<dd><p>Return a new <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a> object transformed by
the given function.</p>
<p>E.g.:</p>
<div class="highlight-pycon+sql notranslate"><div class="highlight"><pre><span></span><span class="go">def filter_something(criterion):</span>
<span class="go">    def transform(q):</span>
<span class="go">        return q.filter(criterion)</span>

<span class="go">    return transform</span>


<span class="go">q = q.with_transformation(filter_something(x == 5))</span></pre></div>
</div>
<p>This allows ad-hoc recipes to be created for <a class="reference internal" href="#sqlalchemy.orm.Query" title="sqlalchemy.orm.Query"><code class="xref py py-class docutils literal notranslate"><span class="pre">Query</span></code></a>
objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sqlalchemy.orm.Query.yield_per">
<em class="property"><span class="pre">method</span> </em><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.Query.</span></code></a><span class="sig-name descname"><span class="pre">yield_per</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="headerlink" href="#sqlalchemy.orm.Query.yield_per" title="Link to this definition">¶</a></dt>
<dd><p>Yield only <code class="docutils literal notranslate"><span class="pre">count</span></code> rows at a time.</p>
<p>The purpose of this method is when fetching very large result sets
(&gt; 10K rows), to batch results in sub-collections and yield them
out partially, so that the Python interpreter doesn’t need to declare
very large areas of memory which is both time consuming and leads
to excessive memory use.   The performance from fetching hundreds of
thousands of rows can often double when a suitable yield-per setting
(e.g. approximately 1000) is used, even with DBAPIs that buffer
rows (which are most).</p>
<p>As of SQLAlchemy 1.4, the <a class="reference internal" href="#sqlalchemy.orm.Query.yield_per" title="sqlalchemy.orm.Query.yield_per"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Query.yield_per()</span></code></a> method is
equivalent to using the <code class="docutils literal notranslate"><span class="pre">yield_per</span></code> execution option at the ORM
level. See the section <a class="reference internal" href="api.html#orm-queryguide-yield-per"><span class="std std-ref">使用 Yield Per 获取大量结果集</span></a> for further
background on this option.</p>
<div class="admonition seealso">
<p class="admonition-title">参见</p>
<p><a class="reference internal" href="api.html#orm-queryguide-yield-per"><span class="std std-ref">使用 Yield Per 获取大量结果集</span></a></p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="orm">
<h2>ORM 特定的查询构造<a class="headerlink" href="#orm" title="Link to this heading">¶</a></h2>
<p>ORM-Specific Query Constructs</p>
<div class="tab-set docutils container">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">中文</label><div class="tab-content docutils container">
<p>本节已移至 <a class="reference internal" href="api.html#queryguide-additional"><span class="std std-ref">其他 ORM API 构造</span></a>。</p>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">英文</label><div class="tab-content docutils container">
<p>This section has moved to <a class="reference internal" href="api.html#queryguide-additional"><span class="std std-ref">其他 ORM API 构造</span></a>.</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../session.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">使用会话</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="api.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">用于查询的 ORM API 功能</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                <a href="../../copyright.html">Copyright</a> &#169; 2007-2025, the SQLAlchemy authors and contributors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on 04/05/2025 04:00:26</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">旧式查询 API</a><ul>
<li><a class="reference internal" href="#id1">查询对象</a><ul>
<li><a class="reference internal" href="#sqlalchemy.orm.Query"><code class="docutils literal notranslate"><span class="pre">Query</span></code></a><ul>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.__init__"><code class="docutils literal notranslate"><span class="pre">Query.__init__()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.add_column"><code class="docutils literal notranslate"><span class="pre">Query.add_column()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.add_columns"><code class="docutils literal notranslate"><span class="pre">Query.add_columns()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.add_entity"><code class="docutils literal notranslate"><span class="pre">Query.add_entity()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.all"><code class="docutils literal notranslate"><span class="pre">Query.all()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.apply_labels"><code class="docutils literal notranslate"><span class="pre">Query.apply_labels()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.as_scalar"><code class="docutils literal notranslate"><span class="pre">Query.as_scalar()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.autoflush"><code class="docutils literal notranslate"><span class="pre">Query.autoflush()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.column_descriptions"><code class="docutils literal notranslate"><span class="pre">Query.column_descriptions</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.correlate"><code class="docutils literal notranslate"><span class="pre">Query.correlate()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.count"><code class="docutils literal notranslate"><span class="pre">Query.count()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.cte"><code class="docutils literal notranslate"><span class="pre">Query.cte()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.delete"><code class="docutils literal notranslate"><span class="pre">Query.delete()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.distinct"><code class="docutils literal notranslate"><span class="pre">Query.distinct()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.enable_assertions"><code class="docutils literal notranslate"><span class="pre">Query.enable_assertions()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.enable_eagerloads"><code class="docutils literal notranslate"><span class="pre">Query.enable_eagerloads()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.except_"><code class="docutils literal notranslate"><span class="pre">Query.except_()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.except_all"><code class="docutils literal notranslate"><span class="pre">Query.except_all()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.execution_options"><code class="docutils literal notranslate"><span class="pre">Query.execution_options()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.exists"><code class="docutils literal notranslate"><span class="pre">Query.exists()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.ext"><code class="docutils literal notranslate"><span class="pre">Query.ext()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.filter"><code class="docutils literal notranslate"><span class="pre">Query.filter()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.filter_by"><code class="docutils literal notranslate"><span class="pre">Query.filter_by()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.first"><code class="docutils literal notranslate"><span class="pre">Query.first()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.from_statement"><code class="docutils literal notranslate"><span class="pre">Query.from_statement()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.get"><code class="docutils literal notranslate"><span class="pre">Query.get()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.get_children"><code class="docutils literal notranslate"><span class="pre">Query.get_children()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.get_execution_options"><code class="docutils literal notranslate"><span class="pre">Query.get_execution_options()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.get_label_style"><code class="docutils literal notranslate"><span class="pre">Query.get_label_style</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.group_by"><code class="docutils literal notranslate"><span class="pre">Query.group_by()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.having"><code class="docutils literal notranslate"><span class="pre">Query.having()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.instances"><code class="docutils literal notranslate"><span class="pre">Query.instances()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.intersect"><code class="docutils literal notranslate"><span class="pre">Query.intersect()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.intersect_all"><code class="docutils literal notranslate"><span class="pre">Query.intersect_all()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.is_single_entity"><code class="docutils literal notranslate"><span class="pre">Query.is_single_entity</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.join"><code class="docutils literal notranslate"><span class="pre">Query.join()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.label"><code class="docutils literal notranslate"><span class="pre">Query.label()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.lazy_loaded_from"><code class="docutils literal notranslate"><span class="pre">Query.lazy_loaded_from</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.limit"><code class="docutils literal notranslate"><span class="pre">Query.limit()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.merge_result"><code class="docutils literal notranslate"><span class="pre">Query.merge_result()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.offset"><code class="docutils literal notranslate"><span class="pre">Query.offset()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.one"><code class="docutils literal notranslate"><span class="pre">Query.one()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.one_or_none"><code class="docutils literal notranslate"><span class="pre">Query.one_or_none()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.only_return_tuples"><code class="docutils literal notranslate"><span class="pre">Query.only_return_tuples()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.options"><code class="docutils literal notranslate"><span class="pre">Query.options()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.order_by"><code class="docutils literal notranslate"><span class="pre">Query.order_by()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.outerjoin"><code class="docutils literal notranslate"><span class="pre">Query.outerjoin()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.params"><code class="docutils literal notranslate"><span class="pre">Query.params()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.populate_existing"><code class="docutils literal notranslate"><span class="pre">Query.populate_existing()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.prefix_with"><code class="docutils literal notranslate"><span class="pre">Query.prefix_with()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.reset_joinpoint"><code class="docutils literal notranslate"><span class="pre">Query.reset_joinpoint()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.scalar"><code class="docutils literal notranslate"><span class="pre">Query.scalar()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.scalar_subquery"><code class="docutils literal notranslate"><span class="pre">Query.scalar_subquery()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.select_from"><code class="docutils literal notranslate"><span class="pre">Query.select_from()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.selectable"><code class="docutils literal notranslate"><span class="pre">Query.selectable</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.set_label_style"><code class="docutils literal notranslate"><span class="pre">Query.set_label_style()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.slice"><code class="docutils literal notranslate"><span class="pre">Query.slice()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.statement"><code class="docutils literal notranslate"><span class="pre">Query.statement</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.subquery"><code class="docutils literal notranslate"><span class="pre">Query.subquery()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.suffix_with"><code class="docutils literal notranslate"><span class="pre">Query.suffix_with()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.tuples"><code class="docutils literal notranslate"><span class="pre">Query.tuples()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.union"><code class="docutils literal notranslate"><span class="pre">Query.union()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.union_all"><code class="docutils literal notranslate"><span class="pre">Query.union_all()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.update"><code class="docutils literal notranslate"><span class="pre">Query.update()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.value"><code class="docutils literal notranslate"><span class="pre">Query.value()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.values"><code class="docutils literal notranslate"><span class="pre">Query.values()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.where"><code class="docutils literal notranslate"><span class="pre">Query.where()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.whereclause"><code class="docutils literal notranslate"><span class="pre">Query.whereclause</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_entities"><code class="docutils literal notranslate"><span class="pre">Query.with_entities()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_for_update"><code class="docutils literal notranslate"><span class="pre">Query.with_for_update()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_hint"><code class="docutils literal notranslate"><span class="pre">Query.with_hint()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_labels"><code class="docutils literal notranslate"><span class="pre">Query.with_labels()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_parent"><code class="docutils literal notranslate"><span class="pre">Query.with_parent()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_session"><code class="docutils literal notranslate"><span class="pre">Query.with_session()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_statement_hint"><code class="docutils literal notranslate"><span class="pre">Query.with_statement_hint()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.with_transformation"><code class="docutils literal notranslate"><span class="pre">Query.with_transformation()</span></code></a></li>
<li><a class="reference internal" href="#sqlalchemy.orm.Query.yield_per"><code class="docutils literal notranslate"><span class="pre">Query.yield_per()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#orm">ORM 特定的查询构造</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=2d0eb83f"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/tabs.js?v=3ee01567"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=2f3e6152"></script>
    <script src="../../_static/translations.js?v=beaddf03"></script>
    </body>
</html>